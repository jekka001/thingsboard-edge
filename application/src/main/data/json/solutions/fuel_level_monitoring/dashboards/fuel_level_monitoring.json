{
  "title": "Fuel Level Monitoring",
  "image": null,
  "mobileHide": false,
  "mobileOrder": null,
  "configuration": {
    "description": "",
    "widgets": {
      "a4855683-5408-a263-eaac-67a08f7e3776": {
        "isSystemType": true,
        "bundleAlias": "cards",
        "typeAlias": "entities_table",
        "type": "latest",
        "title": "New widget",
        "image": null,
        "description": null,
        "sizeX": 7.5,
        "sizeY": 6.5,
        "config": {
          "timewindow": {
            "displayValue": "",
            "selectedTab": 0,
            "realtime": {
              "realtimeType": 1,
              "interval": 1000,
              "timewindowMs": 60000,
              "quickInterval": "CURRENT_DAY"
            },
            "history": {
              "historyType": 0,
              "interval": 1000,
              "timewindowMs": 60000,
              "fixedTimewindow": {
                "startTimeMs": 1682001930247,
                "endTimeMs": 1682088330247
              },
              "quickInterval": "CURRENT_DAY"
            },
            "aggregation": {
              "type": "NONE",
              "limit": 200
            }
          },
          "showTitle": true,
          "backgroundColor": "rgb(255, 255, 255)",
          "color": "rgba(0, 0, 0, 0.87)",
          "padding": "8px",
          "settings": {
            "entitiesTitle": "Tanks",
            "enableSearch": true,
            "enableSelectColumnDisplay": false,
            "enableStickyHeader": true,
            "enableStickyAction": true,
            "reserveSpaceForHiddenAction": "true",
            "displayEntityName": true,
            "entityNameColumnTitle": "Serial number",
            "displayEntityLabel": false,
            "displayEntityType": false,
            "displayPagination": false,
            "defaultSortOrder": "entityName",
            "useRowStyleFunction": false
          },
          "title": "Tanks",
          "dropShadow": true,
          "enableFullscreen": true,
          "titleStyle": {
            "fontSize": "16px",
            "fontWeight": 500,
            "padding": "5px 10px 5px 10px",
            "color": "#29313C",
            "letterSpacing": "0.25px"
          },
          "useDashboardTimewindow": false,
          "showLegend": false,
          "datasources": [
            {
              "type": "entity",
              "name": null,
              "entityAliasId": "e1a32425-259b-f9d4-7380-b40d12a71238",
              "filterId": "f7766c99-0996-844e-84bc-ac5923e173a2",
              "dataKeys": [
                {
                  "name": "fuelLevel",
                  "type": "timeseries",
                  "label": "Remaining, %",
                  "color": "#4caf50",
                  "settings": {
                    "columnWidth": "35%",
                    "useCellStyleFunction": false,
                    "useCellContentFunction": true,
                    "cellContentFunction": "if (value || value === 0) {\n    const tankCapacity = entity.tankCapacity;\n    let fontWeight = '400';\n    let background = '234, 235, 255, 1';\n    let progress = '183, 185, 248 , 1';\n    let textColor = '';\n    \n    if (entity.isLowFuel) {\n        background = '209, 39, 48, 0.06';\n        progress = '209, 39, 48, 1';\n        fontWeight = '500';\n        textColor = '#D12730';\n    }\n    \n    const calculatedValue = (value * tankCapacity) / 100;\n    const percent = value + '%';\n    const valueText = `${parseFloat(value).toFixed(0)}% (${parseFloat(calculatedValue).toFixed(0)}L)`;\n    \nreturn '<div style=\"display: flex; justify-content: space-between; align-items: center; margin-right: 10%; min-width: 90px;\">' + \n           '<span style=\"padding: 4px; font-weight: ' + fontWeight +';color: ' + textColor + ';\">' + valueText + '</span>' + \n           '<div style=\"width: 100%; max-width: 100px; height: 16px; background: linear-gradient(to right, rgba(' + progress + ') ' + percent + ', rgba(' + background + ') '+ percent + '); border-radius: 5.21053px;\">' + \n           '</div>' + \n        '</div>';\n} else {\n    return 'N/A';\n}",
                    "defaultColumnVisibility": "visible",
                    "columnSelectionToDisplay": "enabled",
                    "columnExportOption": "onlyVisible"
                  },
                  "_hash": 0.689094356280995,
                  "aggregationType": "NONE",
                  "units": null,
                  "decimals": null,
                  "funcBody": null,
                  "usePostProcessing": null,
                  "postFuncBody": null
                },
                {
                  "name": "tankCapacity",
                  "type": "attribute",
                  "label": "tankCapacity",
                  "color": "#f44336",
                  "settings": {
                    "columnWidth": "0px",
                    "useCellStyleFunction": false,
                    "useCellContentFunction": false,
                    "defaultColumnVisibility": "hidden",
                    "columnSelectionToDisplay": "enabled",
                    "columnExportOption": "onlyVisible"
                  },
                  "_hash": 0.017204183322520272,
                  "aggregationType": null,
                  "units": null,
                  "decimals": null,
                  "funcBody": null,
                  "usePostProcessing": null,
                  "postFuncBody": null
                },
                {
                  "name": "temperature",
                  "type": "timeseries",
                  "label": "Temperature",
                  "color": "#ffc107",
                  "settings": {
                    "columnWidth": "0px",
                    "useCellStyleFunction": true,
                    "cellStyleFunction": "const showCriticalValue =  entity.isLowTemperature || entity.isHighTemperature;\n\nreturn {\n  \"color\": showCriticalValue ? \"#D12730\" : \"#4B535B\",\n  \"font-weight\": showCriticalValue ? 500 : 400\n};",
                    "useCellContentFunction": true,
                    "cellContentFunction": "return value ? (parseFloat(value).toFixed(0) + 'Â°C') : '-';",
                    "defaultColumnVisibility": "visible",
                    "columnSelectionToDisplay": "enabled",
                    "columnExportOption": "onlyVisible"
                  },
                  "_hash": 0.6772146342894461,
                  "aggregationType": "NONE",
                  "units": null,
                  "decimals": null,
                  "funcBody": null,
                  "usePostProcessing": null,
                  "postFuncBody": null
                },
                {
                  "name": "battery",
                  "type": "timeseries",
                  "label": "Battery",
                  "color": "#607d8b",
                  "settings": {
                    "columnWidth": "0px",
                    "useCellStyleFunction": true,
                    "cellStyleFunction": "const showCriticalValue = entity.isLowBattery;\n\nreturn {\n  \"color\": showCriticalValue ? \"#D12730\" : \"#4B535B\",\n  \"font-weight\": showCriticalValue ? 500 : 400\n};",
                    "useCellContentFunction": true,
                    "cellContentFunction": "return value ? (parseFloat(value).toFixed(0) + '%') : '-';",
                    "defaultColumnVisibility": "visible",
                    "columnSelectionToDisplay": "enabled",
                    "columnExportOption": "onlyVisible"
                  },
                  "_hash": 0.5377119931465908,
                  "aggregationType": "NONE",
                  "units": null,
                  "decimals": null,
                  "funcBody": null,
                  "usePostProcessing": null,
                  "postFuncBody": null
                },
                {
                  "name": "active",
                  "type": "attribute",
                  "label": "Connection",
                  "color": "#9c27b0",
                  "settings": {
                    "columnWidth": "0px",
                    "useCellStyleFunction": false,
                    "useCellContentFunction": true,
                    "cellContentFunction": "const isActive = value === 'true';\nconst status = isActive ? 'Online' : 'Offline';\nconst color = isActive ? '#3AA94D' : '#C42F37';\nconst bgColor = isActive ? 'rgba(58, 169, 77, 0.08)' : 'rgba(196, 47, 55, 0.08)';\nreturn '<div style=\"width:fit-content;padding:4px 8px;border-radius:8px;line-height:20px;font-size:14px;font-weight:500;letter-spacing:0.25px;color:'+ color +';background-color:'+ bgColor +'\">' +\n            status + '</div>';",
                    "defaultColumnVisibility": "visible",
                    "columnSelectionToDisplay": "enabled",
                    "columnExportOption": "onlyVisible"
                  },
                  "_hash": 0.34130030295256675,
                  "aggregationType": null,
                  "units": null,
                  "decimals": null,
                  "funcBody": null,
                  "usePostProcessing": null,
                  "postFuncBody": null
                },
                {
                  "name": "latitude",
                  "type": "attribute",
                  "label": "latitude",
                  "color": "#ffeb3b",
                  "settings": {
                    "columnWidth": "0px",
                    "useCellStyleFunction": false,
                    "useCellContentFunction": false,
                    "defaultColumnVisibility": "hidden",
                    "columnSelectionToDisplay": "enabled",
                    "columnExportOption": "onlyVisible"
                  },
                  "_hash": 0.39894611371985067,
                  "aggregationType": null,
                  "units": null,
                  "decimals": null,
                  "funcBody": null,
                  "usePostProcessing": null,
                  "postFuncBody": null
                },
                {
                  "name": "longitude",
                  "type": "attribute",
                  "label": "longitude",
                  "color": "#03a9f4",
                  "settings": {
                    "columnWidth": "0px",
                    "useCellStyleFunction": false,
                    "useCellContentFunction": false,
                    "defaultColumnVisibility": "hidden",
                    "columnSelectionToDisplay": "enabled",
                    "columnExportOption": "onlyVisible"
                  },
                  "_hash": 0.35546972629067364,
                  "aggregationType": null,
                  "units": null,
                  "decimals": null,
                  "funcBody": null,
                  "usePostProcessing": null,
                  "postFuncBody": null
                },
                {
                  "name": "isHighTemperature",
                  "type": "attribute",
                  "label": "isHighTemperature",
                  "color": "#3f51b5",
                  "settings": {
                    "columnWidth": "0px",
                    "useCellStyleFunction": false,
                    "useCellContentFunction": false,
                    "defaultColumnVisibility": "hidden",
                    "columnSelectionToDisplay": "enabled",
                    "columnExportOption": "onlyVisible"
                  },
                  "_hash": 0.5060142184026628,
                  "aggregationType": null,
                  "units": null,
                  "decimals": null,
                  "funcBody": null,
                  "usePostProcessing": true,
                  "postFuncBody": "return value === \"true\";"
                },
                {
                  "name": "isLowBattery",
                  "type": "attribute",
                  "label": "isLowBattery",
                  "color": "#e91e63",
                  "settings": {
                    "columnWidth": "0px",
                    "useCellStyleFunction": false,
                    "useCellContentFunction": false,
                    "defaultColumnVisibility": "hidden",
                    "columnSelectionToDisplay": "enabled",
                    "columnExportOption": "onlyVisible"
                  },
                  "_hash": 0.5803713210269223,
                  "aggregationType": null,
                  "units": null,
                  "decimals": null,
                  "funcBody": null,
                  "usePostProcessing": true,
                  "postFuncBody": "return value === \"true\";"
                },
                {
                  "name": "isLowFuel",
                  "type": "attribute",
                  "label": "isLowFuel",
                  "color": "#ffeb3b",
                  "settings": {
                    "columnWidth": "0px",
                    "useCellStyleFunction": false,
                    "useCellContentFunction": false,
                    "defaultColumnVisibility": "hidden",
                    "columnSelectionToDisplay": "enabled",
                    "columnExportOption": "onlyVisible"
                  },
                  "_hash": 0.9172594810977519,
                  "aggregationType": null,
                  "units": null,
                  "decimals": null,
                  "funcBody": null,
                  "usePostProcessing": true,
                  "postFuncBody": "return value === \"true\";"
                },
                {
                  "name": "isLowTemperature",
                  "type": "attribute",
                  "label": "isLowTemperature",
                  "color": "#03a9f4",
                  "settings": {
                    "columnWidth": "0px",
                    "useCellStyleFunction": false,
                    "useCellContentFunction": false,
                    "defaultColumnVisibility": "hidden",
                    "columnSelectionToDisplay": "enabled",
                    "columnExportOption": "onlyVisible"
                  },
                  "_hash": 0.6070750492046233,
                  "aggregationType": null,
                  "units": null,
                  "decimals": null,
                  "funcBody": null,
                  "usePostProcessing": true,
                  "postFuncBody": "return value === \"true\";"
                }
              ],
              "alarmFilterConfig": {
                "statusList": [
                  "ACTIVE"
                ]
              }
            }
          ],
          "displayTimewindow": true,
          "actions": {
            "rowClick": [
              {
                "name": "Navigate to details",
                "icon": "more_horiz",
                "useShowWidgetActionFunction": null,
                "showWidgetActionFunction": "return true;",
                "type": "openDashboardState",
                "targetDashboardStateId": "tank-details",
                "setEntityId": true,
                "stateEntityParamName": null,
                "openRightLayout": false,
                "openInSeparateDialog": false,
                "openInPopover": false,
                "id": "82c51569-2059-fb38-d519-faaa3a8950ca"
              }
            ],
            "actionCellButton": [
              {
                "name": "Edit tank sensor",
                "icon": "edit",
                "useShowWidgetActionFunction": null,
                "showWidgetActionFunction": "return true;",
                "type": "customPretty",
                "customHtml": "\n<form #editEntityForm=\"ngForm\" [formGroup]=\"editEntityFormGroup\"\n      (ngSubmit)=\"save()\"  class=\"edit-entity-form\">\n    <mat-toolbar fxLayout=\"row\" style=\"background-color: transparent; border-bottom: solid 1px #0000001f;\">\n        <h2>Edit sensor {{entityName}}</h2>\n        <span fxFlex></span>\n        <button mat-icon-button (click)=\"cancel()\" type=\"button\">\n            <mat-icon class=\"material-icons\">close</mat-icon>\n        </button>\n    </mat-toolbar>\n    <mat-progress-bar color=\"warn\" mode=\"indeterminate\" *ngIf=\"isLoading$ | async\">\n    </mat-progress-bar>\n    <div style=\"height: 4px;\" *ngIf=\"!(isLoading$ | async)\"></div>\n    <div mat-dialog-content>\n        <mat-stepper [(selectedIndex)]=\"currentStep\" #stepper animationDuration=\"1000\">\n            <mat-step [stepControl]=\"editEntityFormGroup.get('general')\">\n                <ng-template matStepLabel>General Info</ng-template>\n                <div fxFlex fxLayout=\"row\" fxLayout.xs=\"column\"  fxLayoutGap.xs=\"0\" fxLayoutAlign=\"space-between\" style=\"margin-top: 30px;\" fxLayoutGap=\"8px\">\n                    <label class=\"section-label\">General Info</label>\n                    <div style=\"width: 100%;\" formGroupName=\"general\" fxLayout=\"column\">\n                        <mat-form-field fxFlex class=\"mat-block\">\n                            <mat-label>Serial number</mat-label>\n                            <input matInput formControlName=\"entityName\" required>\n                            <mat-error *ngIf=\"editEntityFormGroup.get('general').get('entityName').hasError('required')\">\n                                    Serial number is required.\n                            </mat-error>\n                        </mat-form-field>\n                        <mat-form-field fxFlex class=\"mat-block\">\n                            <mat-label>Sensor label</mat-label>\n                            <input matInput formControlName=\"entityLabel\" required>\n                            <mat-error *ngIf=\"editEntityFormGroup.get('general').get('entityLabel').hasError('required')\">\n                                    Sensor label is required.\n                            </mat-error>\n                        </mat-form-field>\n                    </div>\n                </div>\n                \n                <div fxLayout=\"row\" fxLayoutGap=\"8px\" fxLayoutAlign=\"end center\">\n                    <button mat-button color=\"primary\"\n                            type=\"button\"\n                            [disabled]=\"(isLoading$ | async)\"\n                            (click)=\"cancel()\" cdkFocusInitial>\n                        Cancel\n                    </button>\n                    <button mat-button mat-raised-button color=\"primary\" matStepperNext type=\"button\">Next</button>\n                </div>\n            </mat-step>\n            <mat-step [stepControl]=\"editEntityFormGroup.get('details')\">\n                <ng-template matStepLabel>Tank info</ng-template>\n                <div fxFlex fxLayout=\"column\" fxLayoutGap=\"8px\" formGroupName=\"details\" style=\"margin-top: 30px;\">\n                    <div fxFlex fxLayout=\"row\" fxLayoutGap=\"8px\" fxLayout.xs=\"column\"  fxLayoutGap.xs=\"0\" fxLayoutAlign=\"space-between\">\n                        <label class=\"section-label\">Tank Info</label>\n                        <div style=\"width: 100%;\" fxLayout=\"column\">\n                            <mat-form-field fxFlex class=\"mat-block\">\n                                <mat-label>Liquid Type</mat-label>\n                                <input matInput formControlName=\"liquidType\" required>\n                                <mat-error *ngIf=\"editEntityFormGroup.get('details').get('liquidType').hasError('required')\">\n                                    Liquid type is required.\n                                </mat-error>\n                            </mat-form-field>\n                            <mat-form-field class=\"mat-block\" style=\"min-width: 100px;\">\n                                <mat-label>Tank shape</mat-label>\n                                <mat-select formControlName=\"tankShape\" name=\"tankShape\">\n                                    <mat-option *ngFor=\"let tankShape of tankShapes | keyvalue\" [value]=\"tankShape.value\">\n                                        {{ tankShape.value }}\n                                    </mat-option>\n                                </mat-select>\n                                <mat-error *ngIf=\"editEntityFormGroup.get('details').get('tankShape').hasError('required')\">\n                                    Tank shape is required.\n                                </mat-error>\n                            </mat-form-field>\n                        </div>\n                    </div>\n                    <mat-divider></mat-divider>\n                    <div fxFlex fxLayout=\"row\" class=\"details-section\" fxLayoutGap=\"8px\" fxLayout.xs=\"column\"  fxLayoutGap.xs=\"0\" fxLayoutAlign=\"space-between\">\n                        <label class=\"section-label\">Details</label>\n                        <div style=\"width: 100%; max-width: 490px;\" fxLayout=\"column\">\n                            <div formGroupName=\"sizeMeasure\">\n                                <div *ngIf=\"editEntityFormGroup.get('details').get('tankShape').value === tankShapes.hCylinder\" fxFlex fxLayout=\"row\" fxLayoutGap=\"8px\" fxLayout.xs=\"column\"  fxLayoutGap.xs=\"0\" fxLayoutAlign=\"space-between\">\n                                    <mat-form-field fxFlex class=\"mat-block\">\n                                        <mat-label>Length (cm)</mat-label>\n                                        <input matInput type=\"number\" formControlName=\"length\" required>\n                                        <mat-error *ngIf=\"editEntityFormGroup.get('details').get('sizeMeasure').get('length') && editEntityFormGroup.get('details').get('sizeMeasure').get('length').hasError('required')\">\n                                                Length is required.\n                                        </mat-error>\n                                    </mat-form-field>\n                                    <mat-form-field fxFlex class=\"mat-block\">\n                                        <mat-label>Diameter (cm)</mat-label>\n                                        <input matInput type=\"number\" formControlName=\"diameter\" required>\n                                        <mat-error *ngIf=\"editEntityFormGroup.get('details').get('sizeMeasure').get('diameter') && editEntityFormGroup.get('details').get('sizeMeasure').get('diameter').hasError('required')\">\n                                                Diameter is required.\n                                        </mat-error>\n                                    </mat-form-field>\n                                </div>\n                                <div *ngIf=\"editEntityFormGroup.get('details').get('tankShape').value === tankShapes.vCylinder\" fxFlex fxLayout=\"row\" fxLayoutGap=\"8px\" fxLayout.xs=\"column\"  fxLayoutGap.xs=\"0\" fxLayoutAlign=\"space-between\">\n                                    <mat-form-field fxFlex class=\"mat-block\">\n                                        <mat-label>Height (cm)</mat-label>\n                                        <input matInput type=\"number\" formControlName=\"height\" required>\n                                        <mat-error *ngIf=\"editEntityFormGroup.get('details').get('sizeMeasure').get('height') && editEntityFormGroup.get('details').get('sizeMeasure').get('height').hasError('required')\">\n                                                Height is required.\n                                        </mat-error>\n                                    </mat-form-field>\n                                    <mat-form-field fxFlex class=\"mat-block\">\n                                        <mat-label>Diameter (cm)</mat-label>\n                                        <input matInput type=\"number\" formControlName=\"diameter\" required>\n                                        <mat-error *ngIf=\"editEntityFormGroup.get('details').get('sizeMeasure').get('diameter') && editEntityFormGroup.get('details').get('sizeMeasure').get('diameter').hasError('required')\">\n                                                Diameter is required.\n                                        </mat-error>\n                                    </mat-form-field>\n                                </div>\n                                <div *ngIf=\"editEntityFormGroup.get('details').get('tankShape').value === tankShapes.rectangle\" fxFlex fxLayout=\"row\" fxLayoutGap=\"8px\" fxLayout.xs=\"column\"  fxLayoutGap.xs=\"0\" fxLayoutAlign=\"space-between\">\n                                    <mat-form-field fxFlex class=\"mat-block\">\n                                        <mat-label>Width (cm)</mat-label>\n                                        <input matInput type=\"number\" formControlName=\"width\" required>\n                                        <mat-error *ngIf=\"editEntityFormGroup.get('details').get('sizeMeasure').get('width') && editEntityFormGroup.get('details').get('sizeMeasure').get('width').hasError('required')\">\n                                                Width is required.\n                                        </mat-error>\n                                    </mat-form-field>\n                                    <mat-form-field fxFlex class=\"mat-block\">\n                                        <mat-label>Length (cm)</mat-label>\n                                        <input matInput type=\"number\" formControlName=\"length\" required>\n                                        <mat-error *ngIf=\"editEntityFormGroup.get('details').get('sizeMeasure').get('length') && editEntityFormGroup.get('details').get('sizeMeasure').get('length').hasError('required')\">\n                                                Length is required.\n                                        </mat-error>\n                                    </mat-form-field>\n                                    <mat-form-field fxFlex class=\"mat-block\">\n                                        <mat-label>Height (cm)</mat-label>\n                                        <input matInput type=\"number\" formControlName=\"height\" required>\n                                        <mat-error *ngIf=\"editEntityFormGroup.get('details').get('sizeMeasure').get('height') && editEntityFormGroup.get('details').get('sizeMeasure').get('height').hasError('required')\">\n                                                Height is required.\n                                        </mat-error>\n                                    </mat-form-field>\n                                </div>\n                            </div>\n                            \n                        <mat-form-field fxFlex class=\"mat-block\">\n                            <mat-label>Capacity (Liters)</mat-label>\n                            <input matInput type=\"number\" formControlName=\"tankCapacity\" [readonly]=\"editEntityFormGroup.get('details').get('tankShape').value !== tankShapes.unspecified\" required>\n                            <mat-error *ngIf=\"editEntityFormGroup.get('details').get('tankCapacity').hasError('required')\">\n                                Tank capacity is required.\n                            </mat-error>\n                        </mat-form-field>\n                        </div>\n                    </div>\n                </div>\n                <div fxLayout=\"row\" fxLayoutAlign=\"space-between center\">\n                    <button mat-button color=\"primary\" matStepperPrevious type=\"button\">Back</button>\n                    <div fxLayout=\"row\" fxLayoutGap=\"8px\" fxLayoutAlign=\"end center\">\n                        <!--<button mat-button color=\"primary\"-->\n                        <!--        type=\"button\"-->\n                        <!--        [disabled]=\"(isLoading$ | async)\"-->\n                        <!--        (click)=\"cancel()\" cdkFocusInitial>-->\n                        <!--    Cancel-->\n                        <!--</button>-->\n                        <!--<button mat-button mat-raised-button color=\"primary\" -->\n                        <!--        type=\"submit\"-->\n                        <!--        [disabled]=\"(isLoading$ | async) || editEntityForm.invalid || !editEntityForm.dirty || editEntityForm.pristine\">-->\n                        <!--    Save-->\n                        <!--</button>-->\n                        <button mat-button mat-raised-button\n                                color=\"primary\" matStepperNext\n                                type=\"button\">\n                            Next\n                        </button>\n                    </div>\n                </div>\n            </mat-step>\n            <mat-step [stepControl]=\"editEntityFormGroup.get('location')\">\n                <ng-template matStepLabel>Set location</ng-template>\n                <div fxFlex fxLayout=\"column\" fxLayoutGap=\"16px\" style=\"margin-top: 30px;\">\n                    <section fxLayout=\"column\">\n                        <tb-dashboard-state \n                            style=\"height: 550px; width: 100%;\"\n                            [ctx]=\"widgetContext\"\n                            stateId=\"edit-tank-location\"\n                            [entityId]=\"entityId\">\n                        </tb-dashboard-state>\n                    </section>\n                    <div fxFlex formGroupName=\"location\" fxLayout=\"row\" fxLayoutGap=\"8px\" fxLayout.xs=\"column\"  fxLayoutGap.xs=\"0\" fxLayoutAlign=\"space-between\">\n                        <mat-form-field fxFlex class=\"mat-block\">\n                            <mat-label>Latitude</mat-label>\n                            <input matInput readonly=\"true\" type=\"number\" formControlName=\"latitude\">\n                        </mat-form-field>\n                        <mat-form-field fxFlex class=\"mat-block\">\n                            <mat-label>Longitude</mat-label>\n                            <input matInput readonly=\"true\" type=\"number\" formControlName=\"longitude\">\n                        </mat-form-field>\n                    </div>\n                </div>\n                <div fxLayout=\"row\" fxLayoutAlign=\"space-between center\">\n                    <button mat-button color=\"primary\" matStepperPrevious type=\"button\">Back</button>\n                    <div fxLayout=\"row\" fxLayoutGap=\"8px\" fxLayoutAlign=\"end center\">\n                        <button mat-button color=\"primary\"\n                                type=\"button\"\n                                [disabled]=\"(isLoading$ | async)\"\n                                (click)=\"cancel()\" cdkFocusInitial>\n                            Cancel\n                        </button>\n                        <button mat-button mat-raised-button color=\"primary\" \n                                type=\"submit\"\n                                [disabled]=\"(isLoading$ | async) || editEntityForm.invalid || !editEntityForm.dirty\">\n                            Save\n                        </button>\n                    </div>\n                </div>\n            </mat-step>\n        </mat-stepper> \n    </div>\n</form>",
                "customCss": ".edit-entity-form .mat-mdc-dialog-content {\n    max-height: none !important;\n    padding: 0 !important;\n    width: 750px;\n}\n\n.edit-entity-form .mat-mdc-dialog-content .details-section {\n    margin-top: 22px;\n}\n\n.edit-entity-form .mat-mdc-dialog-content .section-label {\n    font-size: 14px;\n    font-weight: 500;\n    color: rgba(0, 0, 0, 0.76);\n    min-width: 30%; \n    margin-top: 18px;\n}",
                "customFunction": "let $injector = widgetContext.$scope.$injector;\nlet customDialog = $injector.get(widgetContext.servicesMap.get('customDialog'));\nlet entityService = $injector.get(widgetContext.servicesMap.get('entityService'));\nlet assetService = $injector.get(widgetContext.servicesMap.get('assetService'));\nlet deviceService = $injector.get(widgetContext.servicesMap.get('deviceService'));\nlet attributeService = $injector.get(widgetContext.servicesMap.get('attributeService'));\n\nopenEditEntityDialog();\n\nfunction openEditEntityDialog() {\n    customDialog.customDialog(htmlTemplate, EditEntityDialogController).subscribe();\n}\n\nfunction EditEntityDialogController(instance) {\n    let vm = instance;\n    let latitude;\n    let longitude;\n    let initialCoords = {\n        latitude: null,\n        longitude: null\n    };\n    let subscriptions = [];\n\n    vm.widgetContext = widgetContext;\n    vm.currentStep = 0;\n    vm.entityId = entityId;\n    vm.entityName = entityName;\n    vm.entityLabel = entityLabel;\n    vm.entityType = entityId.entityType;\n    vm.tankShapes = {\n        unspecified: \"Unspecified\",\n        hCylinder: \"Horizontal Cylinder\",\n        vCylinder: \"Vertical Cylinder\",\n        rectangle: \"Rectangle\"\n    };\n    \n    vm.attributes = {};\n    vm.entity = {};\n\n    vm.editEntityFormGroup = vm.fb.group({\n        general: vm.fb.group({\n            entityName: ['', [vm.validators.required]],\n            entityLabel: ['', [vm.validators.required]],\n        }),\n        details: vm.fb.group({\n            liquidType: ['', [vm.validators.required]],\n            tankShape: ['', [vm.validators.required]],\n            tankCapacity: [null, [vm.validators.required, vm.validators.min(1)]],\n            sizeMeasure: vm.fb.group({\n            })\n        }),\n        location: vm.fb.group({\n            latitude: [null, []],\n            longitude: [null, []]\n        })\n    });\n    \n    vm.editEntityFormGroup.get('location').get('latitude').disable();\n    vm.editEntityFormGroup.get('location').get('longitude').disable();\n\n    getEntityInfo();\n    \n    subscribeForControlsChanges();\n\n    vm.cancel = function() {\n        const coords = vm.editEntityFormGroup.get('location').value;\n        let obs;\n        if (Number(latitude) !== Number(vm.attributes.latitude) || Number(longitude) !== Number(vm.attributes.longitude) ) {\n            obs = resetCoordinatesAttributes();\n        } else {\n            obs = widgetContext.rxjs.of([]);\n        }\n        \n        obs.subscribe(() => {\n            subscriptions.forEach(sub => sub.unsubscribe());\n            vm.dialogRef.close(null);\n        });\n    };\n    \n    vm.save = function() {\n        vm.editEntityFormGroup.markAsPristine();\n        widgetContext.rxjs.forkJoin([\n            saveAttributes(entityId),\n            saveEntity()\n        ]).subscribe(\n            function () {\n                subscriptions.forEach(sub => sub.unsubscribe());\n                widgetContext.updateAliases();\n                vm.dialogRef.close(null);\n            }\n        );\n    };\n    \n    // vm.getCoordinates = function(key) {\n    //     if (vm.editEntityFormGroup.get('location').value[key]) {\n    //         return vm.editEntityFormGroup.get('location').value[key].toFixed(5);\n    //     }\n    // }\n\n    function getEntityAttributes(attributes) {\n        for (var i = 0; i < attributes.length; i++) {\n            let value = attributes[i].value;\n            if (value) {\n                if (attributes[i].key === 'latitude' || attributes[i].key === 'longitude') {\n                    if (attributes[i].key === 'latitude') {\n                        initialCoords.latitude = value;\n                        latitude = value;\n                    } else {\n                        initialCoords.longitude = value;\n                        longitude = value;\n                    }\n                    value = value.toFixed(5);\n                }\n            }\n            vm.attributes[attributes[i].key] = value;\n        }\n    }\n\n    function getEntityInfo() {\n        widgetContext.rxjs.forkJoin([\n            attributeService.getEntityAttributes(entityId, 'SERVER_SCOPE'),\n            entityService.getEntity(entityId.entityType, entityId.id)\n        ]).subscribe(\n            function (data) {\n                getEntityAttributes(data[0]);\n                vm.entity = data[1];\n                vm.editEntityFormGroup.patchValue({\n                    general: {\n                        entityName: vm.entity.name,\n                        entityLabel: vm.entity.label,\n                    },\n                    details: vm.attributes,\n                    location: vm.attributes\n                }, {emitEvent: false});\n                \n                setSizeMeasureFields(vm.attributes.tankShape);\n                subscribeForLocation();\n            }\n        );\n    }\n    \n    function subscribeForLocation() {\n        const updatedDataCheckup = widgetContext.rxjs.interval(1000);\n        subscriptions.push(\n            updatedDataCheckup.subscribe(() => updateLocationData())\n        );\n    }\n    \n    function subscribeForControlsChanges() {\n        const tankShapeChange = vm.editEntityFormGroup.get('details').get('tankShape').valueChanges.subscribe((value) => {\n            vm.editEntityFormGroup.get('details').get('tankCapacity').setValue(0);\n            setSizeMeasureFields(value);\n        });\n        subscriptions.push(tankShapeChange);\n    }\n    \n    function setSizeMeasureFields(tankShape) {\n        let length = null;\n        let diameter = null;\n        let height = null;\n        let width = null;\n        const sizeMeasureGroup = vm.editEntityFormGroup.get('details').get('sizeMeasure');\n        \n        Object.keys(sizeMeasureGroup.controls).forEach(key => {\n          sizeMeasureGroup.removeControl(key);\n        });\n        \n        switch (tankShape) {\n            // case tankShapes.unspecified:\n            //     break;\n            case vm.tankShapes.hCylinder:\n                if (vm.attributes.sizeMeasure) {\n                    length = vm.attributes.sizeMeasure['length'] ? vm.attributes.sizeMeasure['length'] : null;\n                    diameter = vm.attributes.sizeMeasure['diameter'] ? vm.attributes.sizeMeasure['diameter'] : null;\n                }\n                \n                \n                sizeMeasureGroup.addControl('length', vm.fb.control(length, [vm.validators.required]));\n                sizeMeasureGroup.addControl('diameter', vm.fb.control(diameter, [vm.validators.required]));\n                // vm.editEntityFormGroup.get('details').get('tankCapacity').setValue(0);\n                vm.editEntityFormGroup.get('details').get('tankCapacity').disable();\n                subscribeForHCylinder(sizeMeasureGroup);\n                break;\n                \n            case vm.tankShapes.vCylinder:\n                if (vm.attributes.sizeMeasure) {\n                    height = vm.attributes.sizeMeasure['height'] ? vm.attributes.sizeMeasure['height'] : null;\n                    diameter = vm.attributes.sizeMeasure['diameter'] ? vm.attributes.sizeMeasure['diameter'] : null;\n                }\n                \n                sizeMeasureGroup.addControl('height', vm.fb.control(height, [vm.validators.required]));\n                sizeMeasureGroup.addControl('diameter', vm.fb.control(diameter, [vm.validators.required]));\n                // vm.editEntityFormGroup.get('details').get('tankCapacity').setValue(0);\n                vm.editEntityFormGroup.get('details').get('tankCapacity').disable();\n                subscribeForVCylinder(sizeMeasureGroup);\n                break;\n                \n            case vm.tankShapes.rectangle:\n                if (vm.attributes.sizeMeasure) {\n                    height = vm.attributes.sizeMeasure['height'] ? vm.attributes.sizeMeasure['height'] : null;\n                    length = vm.attributes.sizeMeasure['length'] ? vm.attributes.sizeMeasure['length'] : null;\n                    width = vm.attributes.sizeMeasure['width'] ? vm.attributes.sizeMeasure['width'] : null;\n                }\n                \n                sizeMeasureGroup.addControl('height', vm.fb.control(height, [vm.validators.required]));\n                sizeMeasureGroup.addControl('length', vm.fb.control(length, [vm.validators.required]));\n                sizeMeasureGroup.addControl('width', vm.fb.control(width, [vm.validators.required]));\n                // vm.editEntityFormGroup.get('details').get('tankCapacity').setValue(0);\n                vm.editEntityFormGroup.get('details').get('tankCapacity').disable();\n                subscribeForRectangle(sizeMeasureGroup);\n                break;\n            default: \n                vm.editEntityFormGroup.get('details').get('tankCapacity').enable();\n        }\n    }\n    \n    function subscribeForHCylinder(sizeMeasureGroup) {\n        const tankCapacityControl = vm.editEntityFormGroup.get('details').get('tankCapacity');\n        setTimeout(() => {\n            const lengthChange = sizeMeasureGroup.get('length').valueChanges.subscribe((value) => {\n                const l = value;\n                const d = sizeMeasureGroup.value['diameter'];\n                \n                capacity = (((Math.PI / 4) * Math.pow((d / 2), 2) * l) / 1000).toFixed(0);\n                tankCapacityControl.setValue(capacity);\n            });\n            \n            subscriptions.push(lengthChange);\n            \n            // sizeMeasureGroup.get('length').updateValueAndValidity();\n            \n            const diameterChange = sizeMeasureGroup.get('diameter').valueChanges.subscribe((value) => {\n                const l = sizeMeasureGroup.value['length'];\n                const d = value;\n                \n                capacity = (((Math.PI / 4) * Math.pow((d / 2), 2) * l) / 1000).toFixed(0);\n                tankCapacityControl.setValue(capacity);\n            });\n            \n            subscriptions.push(diameterChange);\n            \n            // sizeMeasureGroup.get('diameter').updateValueAndValidity();\n            \n            // Merge is not working due to unknown obs type\n            // widgetContext.rxjs.merge(\n            //     sizeMeasureGroup.get('length').valueChanges,\n            //     sizeMeasureGroup.get('diameter').valueChanges\n            // ).subscribe(() => {\n            //     const l = sizeMeasureGroup.value['length'];\n            //     const d = sizeMeasureGroup.value['diameter'];\n                \n            //     capacity = ((Math.PI / 4) * Math.pow((d / 2), 2) * l) / 1000;\n            //     tankCapacityControl.setValue(capacity);\n            // });\n        }, 100);\n    }\n    \n    function subscribeForVCylinder(sizeMeasureGroup) {\n        const tankCapacityControl = vm.editEntityFormGroup.get('details').get('tankCapacity');\n        setTimeout(() => {\n            const heightChange = sizeMeasureGroup.get('height').valueChanges.subscribe((value) => {\n                const h = value;\n                const d = sizeMeasureGroup.value['diameter'];\n\n                capacity = ((Math.PI * Math.pow((d / 2), 2) * h) / 1000).toFixed(2);\n                tankCapacityControl.setValue(capacity);\n            });\n            \n            subscriptions.push(heightChange);\n            \n            // sizeMeasureGroup.get('height').updateValueAndValidity();\n            \n            const diameterChange = sizeMeasureGroup.get('diameter').valueChanges.subscribe((value) => {\n                const h = sizeMeasureGroup.value['height'];\n                const d = value;\n\n                capacity = ((Math.PI * Math.pow((d / 2), 2) * h) / 1000).toFixed(2);\n                tankCapacityControl.setValue(capacity);\n            });\n            \n            subscriptions.push(diameterChange);\n            \n            // sizeMeasureGroup.get('diameter').updateValueAndValidity();\n        }, 100)\n    }\n    \n    function subscribeForRectangle(sizeMeasureGroup) {\n        const tankCapacityControl = vm.editEntityFormGroup.get('details').get('tankCapacity');\n        setTimeout(() => {\n            const heightChange = sizeMeasureGroup.get('height').valueChanges.subscribe((value) => {\n                const h = value;\n                const l = sizeMeasureGroup.value['length'];\n                const w = sizeMeasureGroup.value['width'];\n\n                capacity = ((h * l * w) / 1000).toFixed(0);\n                tankCapacityControl.setValue(capacity);\n            });\n            \n            subscriptions.push(heightChange);\n            \n            // sizeMeasureGroup.get('height').updateValueAndValidity();\n            \n            const lengthChange = sizeMeasureGroup.get('length').valueChanges.subscribe((value) => {\n                const h = sizeMeasureGroup.value['height'];\n                const l = value;\n                const w = sizeMeasureGroup.value['width'];\n\n                capacity = ((h * l * w) / 1000).toFixed(0);\n                tankCapacityControl.setValue(capacity);\n            });\n            \n            subscriptions.push(lengthChange);\n            \n            // sizeMeasureGroup.get('length').updateValueAndValidity();\n            \n            const widthChange = sizeMeasureGroup.get('width').valueChanges.subscribe((value) => {\n                const h = sizeMeasureGroup.value['height'];\n                const l = sizeMeasureGroup.value['length'];\n                const w = value;\n\n                capacity = ((h * l * w) / 1000).toFixed(0);\n                tankCapacityControl.setValue(capacity);\n            });\n            \n            subscriptions.push(widthChange);\n            \n            // sizeMeasureGroup.get('width').updateValueAndValidity();\n            \n            // Merge is not working due to unknown obs type\n            // widgetContext.rxjs.merge(\n            //     sizeMeasureGroup.get('height').valueChanges,\n            //     sizeMeasureGroup.get('length').valueChanges,\n            //     sizeMeasureGroup.get('width').valueChanges\n            // ).subscribe(() => {\n            //     const h = sizeMeasureGroup.value['height'];\n            //     const l = sizeMeasureGroup.value['length'];\n            //     const w = sizeMeasureGroup.value['width'];\n\n            //     capacity = (h * l * w) / 1000;\n            //     tankCapacityControl.setValue(capacity);\n            // });\n        }, 100);\n    }\n    \n    function updateLocationData() {\n        const location = vm.editEntityFormGroup.get('location');\n        widgetContext.data.forEach((itr) => { \n            if (entityName === itr.datasource.entityName) {\n                if (itr.dataKey.name === 'latitude') {\n                    \n                    if (latitude !== itr.data[0][1]) {\n                        latitude = itr.data[0][1] ? itr.data[0][1].toFixed(5) : itr.data[0][1];\n                        \n                        location.get('latitude').setValue(latitude);\n                        vm.editEntityFormGroup.markAsDirty();\n                    }\n                    \n                } else if (itr.dataKey.name === 'longitude') {\n                    if (longitude !== itr.data[0][1]) {\n                        longitude = itr.data[0][1] ? itr.data[0][1].toFixed(5) : itr.data[0][1];\n                        \n                        location.get('longitude').setValue(longitude);\n                        vm.editEntityFormGroup.markAsDirty();\n                    }\n                }\n            }\n        })\n    }\n\n    function saveEntity() {\n        const formValues = vm.editEntityFormGroup.value;\n        \n        if (vm.entity.label !== formValues.general.entityLabel ||\n            vm.entity.name !== formValues.general.entityName){\n            vm.entity.label = formValues.general.entityLabel;\n            vm.entity.name = formValues.general.entityName;\n            return deviceService.saveDevice(vm.entity);\n        }\n        \n        return widgetContext.rxjs.of([]);\n    }\n\n    function saveAttributes(entityId) {\n        const details = vm.editEntityFormGroup.get('details').value;\n        \n        let attributesArray = [];\n        \n        for (let key in details) {\n            if (details[key] !== vm.attributes[key]) {\n                attributesArray.push({key: key, value: details[key]});\n            }\n        }\n        \n        if (attributesArray.length > 0) {\n            return attributeService.saveEntityAttributes(entityId, \"SERVER_SCOPE\", attributesArray);\n        }\n        return widgetContext.rxjs.of([]);\n    }\n\n    function resetCoordinatesAttributes() {\n        const coordinatesArray = [\n            {key: 'latitude', value: initialCoords.latitude},\n            {key: 'longitude', value: initialCoords.longitude}\n        ];\n        \n        return attributeService.saveEntityAttributes(entityId, \"SERVER_SCOPE\", coordinatesArray);\n    }\n}",
                "customResources": [],
                "openInSeparateDialog": false,
                "openInPopover": false,
                "id": "17eee034-5ced-8582-9701-39d722b9d886"
              },
              {
                "name": "Delete tank sensor",
                "icon": "delete",
                "useShowWidgetActionFunction": null,
                "showWidgetActionFunction": "return true;",
                "type": "custom",
                "customFunction": "let $injector = widgetContext.$scope.$injector;\nlet dialogs = $injector.get(widgetContext.servicesMap.get('dialogs'));\nlet assetService = $injector.get(widgetContext.servicesMap.get('assetService'));\nlet deviceService = $injector.get(widgetContext.servicesMap.get('deviceService'));\n\nopenDeleteEntityDialog();\n\nfunction openDeleteEntityDialog() {\n    let title = 'Delete sensor' + ' ' +\n                entityName + ' ?';\n    dialogs.confirm(title, '', 'Cancel', 'Delete').subscribe(\n        function(result) {\n            if (result) {\n                deleteEntity();\n            }\n        }\n    );\n}\n\nfunction deleteEntity() {\n    deleteEntityObservable(entityId).subscribe(\n        function success() {\n            widgetContext.updateAliases();\n        },\n        function fail() {\n            showErrorDialog();\n        }\n    );\n}\n\nfunction deleteEntityObservable(entityId) {\n    if (entityId.entityType == \"ASSET\") {\n        return assetService.deleteAsset(entityId.id);\n    } else if (entityId.entityType == \"DEVICE\") {\n        return deviceService.deleteDevice(entityId.id);\n    }\n}\n\nfunction showErrorDialog() {\n    let title = 'Error';\n    let content = 'An error occurred while deleting the entity. Please try again.';\n    dialogs.alert(title, content, 'CLOSE').subscribe(\n        function(result) {}\n    );\n}",
                "openInSeparateDialog": false,
                "openInPopover": false,
                "id": "aa9a6793-6408-0b30-f215-d7f0de152be4"
              }
            ],
            "headerButton": [
              {
                "name": "Add tank sensor",
                "icon": "add",
                "useShowWidgetActionFunction": null,
                "showWidgetActionFunction": "return true;",
                "type": "customPretty",
                "customHtml": "\n<form #editEntityForm=\"ngForm\" [formGroup]=\"editEntityFormGroup\"\n      (ngSubmit)=\"save()\"  class=\"edit-entity-form\">\n    <mat-toolbar fxLayout=\"row\" style=\"background-color: transparent; border-bottom: solid 1px #0000001f;\">\n        <h2>Add sensor</h2>\n        <span fxFlex></span>\n        <button mat-icon-button (click)=\"cancel()\" type=\"button\">\n            <mat-icon class=\"material-icons\">close</mat-icon>\n        </button>\n    </mat-toolbar>\n    <mat-progress-bar color=\"warn\" mode=\"indeterminate\" *ngIf=\"isLoading$ | async\">\n    </mat-progress-bar>\n    <div style=\"height: 4px;\" *ngIf=\"!(isLoading$ | async)\"></div>\n    <div mat-dialog-content>\n        <mat-stepper *ngIf=\"editEntityFormGroup\" #stepper [linear]=\"true\" (selectionChange)=\"onStepChange($event)\" animationDuration=\"1000\">\n            <mat-step [stepControl]=\"editEntityFormGroup.get('general')\">\n                <ng-template matStepLabel>General Info</ng-template>\n                <div fxFlex fxLayout=\"row\" fxLayoutGap=\"8px\" fxLayout.xs=\"column\"  fxLayoutGap.xs=\"0\" fxLayoutAlign=\"space-between\" style=\"margin-top: 30px;\" [formGroup]=\"editEntityFormGroup.get('general')\">\n                    <label class=\"section-label\">General Info</label>\n                    <div style=\"width: 100%;\" fxLayout=\"column\">\n                        <mat-form-field fxFlex class=\"mat-block\">\n                            <mat-label>Serial number</mat-label>\n                            <input matInput formControlName=\"entityName\" required>\n                            <mat-error *ngIf=\"editEntityFormGroup.get('general').get('entityName').hasError('required')\">\n                                    Serial number is required.\n                            </mat-error>\n                        </mat-form-field>\n                        <mat-form-field fxFlex class=\"mat-block\">\n                            <mat-label>Sensor label</mat-label>\n                            <input matInput formControlName=\"entityLabel\" required>\n                            <mat-error *ngIf=\"editEntityFormGroup.get('general').get('entityLabel').hasError('required')\">\n                                    Sensor label is required.\n                            </mat-error>\n                        </mat-form-field>\n                    </div>\n                </div>\n                \n                <div fxLayout=\"row\" fxLayoutGap=\"8px\" fxLayoutAlign=\"end center\">\n                    <button mat-button color=\"primary\"\n                            type=\"button\"\n                            [disabled]=\"(isLoading$ | async)\"\n                            (click)=\"cancel()\" cdkFocusInitial>\n                        Cancel\n                    </button>\n                    <button mat-button mat-raised-button color=\"primary\" matStepperNext type=\"button\">Next</button>\n                </div>\n            </mat-step>\n            <mat-step *ngIf=\"editEntityFormGroup\" [stepControl]=\"editEntityFormGroup.get('details')\" >\n                <ng-template matStepLabel>Tank info</ng-template>\n                <div fxFlex fxLayout=\"column\" fxLayoutGap=\"8px\" [formGroup]=\"editEntityFormGroup.get('details')\" style=\"margin-top: 30px;\">\n                    <div fxFlex fxLayout=\"row\" fxLayoutGap=\"8px\" fxLayout.xs=\"column\"  fxLayoutGap.xs=\"0\" fxLayoutAlign=\"space-between\">\n                        <label class=\"section-label\">Tank Info</label>\n                        <div style=\"width: 100%;\" fxLayout=\"column\">\n                            <mat-form-field fxFlex class=\"mat-block\">\n                                <mat-label>Liquid Type</mat-label>\n                                <input matInput formControlName=\"liquidType\" required>\n                                <mat-error *ngIf=\"editEntityFormGroup.get('details').get('liquidType').hasError('required')\">\n                                    Liquid type is required.\n                                </mat-error>\n                            </mat-form-field>\n                            <mat-form-field class=\"mat-block\" style=\"min-width: 100px;\">\n                                <mat-label>Tank shape</mat-label>\n                                <mat-select formControlName=\"tankShape\" name=\"tankShape\">\n                                    <mat-option *ngFor=\"let tankShape of tankShapes | keyvalue\" [value]=\"tankShape.value\">\n                                        {{ tankShape.value }}\n                                    </mat-option>\n                                </mat-select>\n                                <mat-error *ngIf=\"editEntityFormGroup.get('details').get('tankShape').hasError('required')\">\n                                    Tank shape is required.\n                                </mat-error>\n                            </mat-form-field>\n                        </div>\n                    </div>\n                    <mat-divider></mat-divider>\n                    <div fxFlex fxLayout=\"row\" class=\"details-section\" fxLayoutGap=\"8px\" fxLayout.xs=\"column\"  fxLayoutGap.xs=\"0\" fxLayoutAlign=\"space-between\">\n                        <label class=\"section-label\">Details</label>\n                        <div style=\"width: 100%; max-width: 490px;\" fxLayout=\"column\">\n                            <div formGroupName=\"sizeMeasure\">\n                                <div *ngIf=\"editEntityFormGroup.get('details').get('tankShape').value === tankShapes.hCylinder\" fxFlex fxLayout=\"row\" fxLayoutGap=\"8px\" fxLayout.xs=\"column\"  fxLayoutGap.xs=\"0\" fxLayoutAlign=\"space-between\">\n                                    <mat-form-field fxFlex class=\"mat-block\">\n                                        <mat-label>Length (cm)</mat-label>\n                                        <input matInput type=\"number\" formControlName=\"length\" required>\n                                        <mat-error *ngIf=\"editEntityFormGroup.get('details').get('sizeMeasure').get('length') && editEntityFormGroup.get('details').get('sizeMeasure').get('length').hasError('required')\">\n                                                Length is required.\n                                        </mat-error>\n                                    </mat-form-field>\n                                    <mat-form-field fxFlex class=\"mat-block\">\n                                        <mat-label>Diameter (cm)</mat-label>\n                                        <input matInput type=\"number\" formControlName=\"diameter\" required>\n                                        <mat-error *ngIf=\"editEntityFormGroup.get('details').get('sizeMeasure').get('diameter') && editEntityFormGroup.get('details').get('sizeMeasure').get('diameter').hasError('required')\">\n                                                Diameter is required.\n                                        </mat-error>\n                                    </mat-form-field>\n                                </div>\n                                <div *ngIf=\"editEntityFormGroup.get('details').get('tankShape').value === tankShapes.vCylinder\" fxFlex fxLayout=\"row\" fxLayoutGap=\"8px\" fxLayout.xs=\"column\"  fxLayoutGap.xs=\"0\" fxLayoutAlign=\"space-between\">\n                                    <mat-form-field fxFlex class=\"mat-block\">\n                                        <mat-label>Height (cm)</mat-label>\n                                        <input matInput type=\"number\" formControlName=\"height\" required>\n                                        <mat-error *ngIf=\"editEntityFormGroup.get('details').get('sizeMeasure').get('height') && editEntityFormGroup.get('details').get('sizeMeasure').get('height').hasError('required')\">\n                                                Height is required.\n                                        </mat-error>\n                                    </mat-form-field>\n                                    <mat-form-field fxFlex class=\"mat-block\">\n                                        <mat-label>Diameter (cm)</mat-label>\n                                        <input matInput type=\"number\" formControlName=\"diameter\" required>\n                                        <mat-error *ngIf=\"editEntityFormGroup.get('details').get('sizeMeasure').get('diameter') && editEntityFormGroup.get('details').get('sizeMeasure').get('diameter').hasError('required')\">\n                                                Diameter is required.\n                                        </mat-error>\n                                    </mat-form-field>\n                                </div>\n                                <div *ngIf=\"editEntityFormGroup.get('details').get('tankShape').value === tankShapes.rectangle\" fxFlex fxLayout=\"row\" fxLayoutGap=\"8px\" fxLayout.xs=\"column\"  fxLayoutGap.xs=\"0\" fxLayoutAlign=\"space-between\">\n                                    <mat-form-field fxFlex class=\"mat-block\">\n                                        <mat-label>Width (cm)</mat-label>\n                                        <input matInput type=\"number\" formControlName=\"width\" required>\n                                        <mat-error *ngIf=\"editEntityFormGroup.get('details').get('sizeMeasure').get('width') && editEntityFormGroup.get('details').get('sizeMeasure').get('width').hasError('required')\">\n                                                Width is required.\n                                        </mat-error>\n                                    </mat-form-field>\n                                    <mat-form-field fxFlex class=\"mat-block\">\n                                        <mat-label>Length (cm)</mat-label>\n                                        <input matInput type=\"number\" formControlName=\"length\" required>\n                                        <mat-error *ngIf=\"editEntityFormGroup.get('details').get('sizeMeasure').get('length') && editEntityFormGroup.get('details').get('sizeMeasure').get('length').hasError('required')\">\n                                                Length is required.\n                                        </mat-error>\n                                    </mat-form-field>\n                                    <mat-form-field fxFlex class=\"mat-block\">\n                                        <mat-label>Height (cm)</mat-label>\n                                        <input matInput type=\"number\" formControlName=\"height\" required>\n                                        <mat-error *ngIf=\"editEntityFormGroup.get('details').get('sizeMeasure').get('height') && editEntityFormGroup.get('details').get('sizeMeasure').get('height').hasError('required')\">\n                                                Height is required.\n                                        </mat-error>\n                                    </mat-form-field>\n                                </div>\n                            </div>\n                            <mat-form-field fxFlex class=\"mat-block\">\n                                <mat-label>Capacity (Liters)</mat-label>\n                                <input [readonly]=\"editEntityFormGroup.get('details').get('tankShape').value !== tankShapes.unspecified\" matInput type=\"number\" formControlName=\"tankCapacity\" required>\n                                <mat-error *ngIf=\"editEntityFormGroup.get('details').get('tankCapacity').hasError('required')\">\n                                    Tank capacity is required.\n                                </mat-error>\n                            </mat-form-field>\n                        </div>\n                    </div>\n                </div>\n                <div fxLayout=\"row\" fxLayoutAlign=\"space-between center\">\n                    <button mat-button color=\"primary\" matStepperPrevious type=\"button\">Back</button>\n                    <div fxLayout=\"row\" fxLayoutGap=\"8px\" fxLayoutAlign=\"end center\">\n                        <button mat-button color=\"primary\"\n                                type=\"button\"\n                                [disabled]=\"(isLoading$ | async)\"\n                                (click)=\"cancel()\" cdkFocusInitial>\n                            Cancel\n                        </button>\n                        <button mat-button mat-raised-button\n                                color=\"primary\" matStepperNext type=\"button\">\n                            Next\n                        </button>\n                    </div>\n                </div>\n            </mat-step>\n            <mat-step>\n                <ng-template matStepLabel>Set location (optional)</ng-template>\n                <div fxFlex fxLayout=\"column\" fxLayoutGap=\"16px\" style=\"margin-top: 30px; margin-bottom: 16px;\" [formGroup]=\"editEntityFormGroup.get('location')\">\n                    <section *ngIf=\"!!entityId\">\n                        <tb-dashboard-state \n                            style=\"height: 550px; width: 100%;\"\n                            [ctx]=\"widgetContext\"\n                            stateId=\"edit-tank-location\"\n                            [entityId]=\"entityId\">\n                        </tb-dashboard-state>\n                    </section>\n                    <!--<div fxFlex fxLayout=\"row\" fxLayoutGap=\"8px\" fxLayout.xs=\"column\"  fxLayoutGap.xs=\"0\" fxLayoutAlign=\"space-between\">-->\n                    <!--    <mat-form-field fxFlex class=\"mat-block\">-->\n                    <!--        <mat-label>Latitude</mat-label>-->\n                    <!--        <input matInput type=\"number\" readonly=\"true\" formControlName=\"latitude\">-->\n                    <!--    </mat-form-field>-->\n                    <!--    <mat-form-field fxFlex class=\"mat-block\">-->\n                    <!--        <mat-label>Longitude</mat-label>-->\n                    <!--        <input matInput type=\"number\" readonly=\"true\" formControlName=\"longitude\">-->\n                    <!--    </mat-form-field>-->\n                    <!--</div>-->\n                </div>\n                <div fxLayout=\"row\" fxLayoutAlign=\"space-between center\">\n                    <button mat-button color=\"primary\" matStepperPrevious type=\"button\">Back</button>\n                    <div fxLayout=\"row\" fxLayoutGap=\"8px\" fxLayoutAlign=\"end center\">\n                        <button mat-button color=\"primary\"\n                                type=\"button\"\n                                [disabled]=\"(isLoading$ | async)\"\n                                (click)=\"cancel()\" cdkFocusInitial>\n                            Cancel\n                        </button>\n                        <button mat-button mat-raised-button color=\"primary\" \n                                type=\"submit\"\n                                [disabled]=\"(isLoading$ | async)\">\n                            Save\n                        </button>\n                    </div>\n                </div>\n            </mat-step>\n        </mat-stepper> \n    </div>\n</form>",
                "customCss": ".edit-entity-form .mat-mdc-dialog-content {\n    max-height: none !important;\n    padding: 0 !important;\n    width: 750px;\n}\n\n.edit-entity-form .mat-mdc-dialog-content .details-section {\n    margin-top: 22px;\n}\n\n.edit-entity-form .mat-mdc-dialog-content .section-label {\n    font-size: 14px;\n    font-weight: 500;\n    color: rgba(0, 0, 0, 0.76);\n    min-width: 30%; \n    margin-top: 18px;\n}",
                "customFunction": "let $injector = widgetContext.$scope.$injector;\nlet customDialog = $injector.get(widgetContext.servicesMap.get('customDialog'));\nlet entityService = $injector.get(widgetContext.servicesMap.get('entityService'));\nlet assetService = $injector.get(widgetContext.servicesMap.get('assetService'));\nlet deviceService = $injector.get(widgetContext.servicesMap.get('deviceService'));\nlet attributeService = $injector.get(widgetContext.servicesMap.get('attributeService'));\nlet deviceProfileService = $injector.get(widgetContext.servicesMap.get('deviceProfileService'));\nlet entityGroupService = $injector.get(widgetContext.servicesMap.get('entityGroupService'));\n\nconst pageLink = widgetContext.pageLink(1, 0, \"Tanks\");\nlet groupId;\n\nentityGroupService.getEntityGroups(pageLink, \"DEVICE\").subscribe((value) => {\n    groupId = value.data[0].id;\n    openEditEntityDialog();\n});\n// let deviceProfileId;\n// const pageLink = new widgetContext.pageLink(1, 0, \"Tank\");\n// deviceProfileService.getDeviceProfiles((profiles) => {\n//     deviceProfileId = profiles[0].id;\n// })\n\nfunction openEditEntityDialog() {\n    customDialog.customDialog(htmlTemplate, EditEntityDialogController).subscribe();\n}\n\nfunction EditEntityDialogController(instance) {\n    let vm = instance;\n    let subscriptions = [];\n\n    vm.widgetContext = widgetContext;\n    vm.currentStep = 0;\n    vm.entityId = null;\n    vm.entityName = '';\n    vm.entityLabel = '';\n    \n    vm.tankShapes = {\n        unspecified: \"Unspecified\",\n        hCylinder: \"Horizontal Cylinder\",\n        vCylinder: \"Vertical Cylinder\",\n        rectangle: \"Rectangle\"\n    };\n    \n    vm.attributes = {\n        alarmFilter: \"noAlarms offline\"\n    };\n    vm.entity = {};\n\n    vm.editEntityFormGroup = vm.fb.group({\n        general: vm.fb.group({\n            entityName: ['', [vm.validators.required]],\n            entityLabel: ['', [vm.validators.required]],\n        }),\n        details: vm.fb.group({\n            liquidType: ['', [vm.validators.required]],\n            tankShape: ['', [vm.validators.required]],\n            tankCapacity: ['', [vm.validators.required, vm.validators.min(1)]],\n            sizeMeasure: vm.fb.group({\n            })\n        }),\n        location: vm.fb.group({\n            latitude: [null, []],\n            longitude: [null, []]\n        })\n    });\n    \n    subscribeForControlsChanges();\n    \n    vm.cancel = function() {\n        let obs;\n        if (vm.entityId) {\n            obs = deviceService.deleteDevice(vm.entityId.id);\n        } else {\n            obs = widgetContext.rxjs.of(null);\n        }\n        obs.subscribe(() => {\n            widgetContext.updateAliases();\n            subscriptions.forEach(sub => sub.unsubscribe());\n            vm.dialogRef.close(null);\n        });\n    };\n    \n    vm.save = function(next) {\n        vm.editEntityFormGroup.markAsPristine();\n        let obs;\n        if (!next) {\n            obs = updateEntity();\n        } else {\n            obs = saveEntity();\n        }\n        obs.subscribe(\n            function (data) {\n                if (data) {\n                    vm.entityId = data.id;\n                    vm.entity = data;\n                    vm.entityName = data.name;\n                }\n                \n                const details = vm.editEntityFormGroup.get('details').value;\n                const location = vm.editEntityFormGroup.get('location').value;\n                \n                saveAttributes(vm.entityId).subscribe((data) => {\n                    for (let key in details) {\n                        vm.attributes[key] = details[key];\n                    }\n                    \n                    for (let key in location) {\n                        vm.attributes[key] = location[key];\n                    }\n\n                    if (!next) {\n                        subscriptions.forEach(sub => sub.unsubscribe());\n                        widgetContext.updateAliases();\n                        vm.dialogRef.close(null);\n                    }\n                });\n            }\n        );\n    };\n    \n    vm.onStepChange = function(event) {\n        if (!vm.entityId && event.selectedIndex === 2) {\n            vm.save(true);\n            setTimeout(function() {\n                subscribeForLocation();\n            }, 1000);\n        }\n    }\n    \n    function subscribeForControlsChanges() {\n        const tankShapeChange = vm.editEntityFormGroup.get('details').get('tankShape').valueChanges.subscribe((value) => {\n            vm.editEntityFormGroup.get('details').get('tankCapacity').setValue(0);\n            setSizeMeasureFields(value);\n        });\n        \n        subscriptions.push(tankShapeChange);\n    }\n    \n    function setSizeMeasureFields(tankShape) {\n        let length = null;\n        let diameter = null;\n        let height = null;\n        let width = null;\n        const sizeMeasureGroup = vm.editEntityFormGroup.get('details').get('sizeMeasure');\n        \n        Object.keys(sizeMeasureGroup.controls).forEach(key => {\n          sizeMeasureGroup.removeControl(key);\n        });\n        \n        switch (tankShape) {\n            // case tankShapes.unspecified:\n            //     break;\n            case vm.tankShapes.hCylinder:\n                if (vm.attributes.sizeMeasure) {\n                    length = vm.attributes.sizeMeasure['length'] ? vm.attributes.sizeMeasure['length'] : null;\n                    diameter = vm.attributes.sizeMeasure['diameter'] ? vm.attributes.sizeMeasure['diameter'] : null;\n                }\n                \n                \n                sizeMeasureGroup.addControl('length', vm.fb.control(length, [vm.validators.required]));\n                sizeMeasureGroup.addControl('diameter', vm.fb.control(diameter, [vm.validators.required]));\n                vm.editEntityFormGroup.get('details').get('tankCapacity').disable();\n                subscribeForHCylinder(sizeMeasureGroup);\n                break;\n                \n            case vm.tankShapes.vCylinder:\n                if (vm.attributes.sizeMeasure) {\n                    height = vm.attributes.sizeMeasure['height'] ? vm.attributes.sizeMeasure['height'] : null;\n                    diameter = vm.attributes.sizeMeasure['diameter'] ? vm.attributes.sizeMeasure['diameter'] : null;\n                }\n                \n                sizeMeasureGroup.addControl('height', vm.fb.control(height, [vm.validators.required]));\n                sizeMeasureGroup.addControl('diameter', vm.fb.control(diameter, [vm.validators.required]));\n                vm.editEntityFormGroup.get('details').get('tankCapacity').disable();\n                subscribeForVCylinder(sizeMeasureGroup);\n                break;\n                \n            case vm.tankShapes.rectangle:\n                if (vm.attributes.sizeMeasure) {\n                    height = vm.attributes.sizeMeasure['height'] ? vm.attributes.sizeMeasure['height'] : null;\n                    length = vm.attributes.sizeMeasure['length'] ? vm.attributes.sizeMeasure['length'] : null;\n                    width = vm.attributes.sizeMeasure['width'] ? vm.attributes.sizeMeasure['width'] : null;\n                }\n                \n                sizeMeasureGroup.addControl('height', vm.fb.control(height, [vm.validators.required]));\n                sizeMeasureGroup.addControl('length', vm.fb.control(length, [vm.validators.required]));\n                sizeMeasureGroup.addControl('width', vm.fb.control(width, [vm.validators.required]));\n                vm.editEntityFormGroup.get('details').get('tankCapacity').disable();\n                subscribeForRectangle(sizeMeasureGroup);\n                break;\n            default: \n                vm.editEntityFormGroup.get('details').get('tankCapacity').enable();\n        }\n    }\n    \n    function subscribeForHCylinder(sizeMeasureGroup) {\n        const tankCapacityControl = vm.editEntityFormGroup.get('details').get('tankCapacity');\n        setTimeout(() => {\n            const lengthChange = sizeMeasureGroup.get('length').valueChanges.subscribe((value) => {\n                const l = value;\n                const d = sizeMeasureGroup.value['diameter'];\n                \n                capacity = (((Math.PI / 4) * Math.pow((d / 2), 2) * l) / 1000).toFixed(0);\n                tankCapacityControl.setValue(capacity);\n            });\n            \n            subscriptions.push(lengthChange);\n            \n            // sizeMeasureGroup.get('length').updateValueAndValidity();\n            \n            const diameterChange = sizeMeasureGroup.get('diameter').valueChanges.subscribe((value) => {\n                const l = sizeMeasureGroup.value['length'];\n                const d = value;\n                \n                capacity = (((Math.PI / 4) * Math.pow((d / 2), 2) * l) / 1000).toFixed(0);\n                tankCapacityControl.setValue(capacity);\n            });\n            \n            subscriptions.push(diameterChange);\n            \n            // sizeMeasureGroup.get('diameter').updateValueAndValidity();\n            \n            // Merge is not working due to unknown obs type\n            // widgetContext.rxjs.merge(\n            //     sizeMeasureGroup.get('length').valueChanges,\n            //     sizeMeasureGroup.get('diameter').valueChanges\n            // ).subscribe(() => {\n            //     const l = sizeMeasureGroup.value['length'];\n            //     const d = sizeMeasureGroup.value['diameter'];\n                \n            //     capacity = ((Math.PI / 4) * Math.pow((d / 2), 2) * l) / 1000;\n            //     tankCapacityControl.setValue(capacity);\n            // });\n        }, 100);\n    }\n    \n    function subscribeForVCylinder(sizeMeasureGroup) {\n        const tankCapacityControl = vm.editEntityFormGroup.get('details').get('tankCapacity');\n        setTimeout(() => {\n            const heightChange = sizeMeasureGroup.get('height').valueChanges.subscribe((value) => {\n                const h = value;\n                const d = sizeMeasureGroup.value['diameter'];\n\n                capacity = ((Math.PI * Math.pow((d / 2), 2) * h) / 1000).toFixed(2);\n                tankCapacityControl.setValue(capacity);\n            });\n            \n            subscriptions.push(heightChange);\n            \n            // sizeMeasureGroup.get('height').updateValueAndValidity();\n            \n            const diameterChange = sizeMeasureGroup.get('diameter').valueChanges.subscribe((value) => {\n                const h = sizeMeasureGroup.value['height'];\n                const d = value;\n\n                capacity = ((Math.PI * Math.pow((d / 2), 2) * h) / 1000).toFixed(2);\n                tankCapacityControl.setValue(capacity);\n            });\n            \n            subscriptions.push(diameterChange);\n            \n            // sizeMeasureGroup.get('diameter').updateValueAndValidity();\n        }, 100)\n    }\n    \n    function subscribeForRectangle(sizeMeasureGroup) {\n        const tankCapacityControl = vm.editEntityFormGroup.get('details').get('tankCapacity');\n        setTimeout(() => {\n            const heightChange = sizeMeasureGroup.get('height').valueChanges.subscribe((value) => {\n                const h = value;\n                const l = sizeMeasureGroup.value['length'];\n                const w = sizeMeasureGroup.value['width'];\n\n                capacity = ((h * l * w) / 1000).toFixed(0);\n                tankCapacityControl.setValue(capacity);\n            });\n            \n            subscriptions.push(heightChange);\n            \n            // sizeMeasureGroup.get('height').updateValueAndValidity();\n            \n            const lengthChange = sizeMeasureGroup.get('length').valueChanges.subscribe((value) => {\n                const h = sizeMeasureGroup.value['height'];\n                const l = value;\n                const w = sizeMeasureGroup.value['width'];\n\n                capacity = ((h * l * w) / 1000).toFixed(0);\n                tankCapacityControl.setValue(capacity);\n            });\n            \n            subscriptions.push(lengthChange);\n            \n            // sizeMeasureGroup.get('length').updateValueAndValidity();\n            \n            const widthChange = sizeMeasureGroup.get('width').valueChanges.subscribe((value) => {\n                const h = sizeMeasureGroup.value['height'];\n                const l = sizeMeasureGroup.value['length'];\n                const w = value;\n\n                capacity = ((h * l * w) / 1000).toFixed(0);\n                tankCapacityControl.setValue(capacity);\n            });\n            \n            subscriptions.push(widthChange);\n            \n            // sizeMeasureGroup.get('width').updateValueAndValidity();\n            \n            // Merge is not working due to unknown obs type\n            // widgetContext.rxjs.merge(\n            //     sizeMeasureGroup.get('height').valueChanges,\n            //     sizeMeasureGroup.get('length').valueChanges,\n            //     sizeMeasureGroup.get('width').valueChanges\n            // ).subscribe(() => {\n            //     const h = sizeMeasureGroup.value['height'];\n            //     const l = sizeMeasureGroup.value['length'];\n            //     const w = sizeMeasureGroup.value['width'];\n\n            //     capacity = (h * l * w) / 1000;\n            //     tankCapacityControl.setValue(capacity);\n            // });\n        }, 100);\n    }\n    \n    function subscribeForLocation() {\n        const updatedDataCheckup = widgetContext.rxjs.interval(1000);\n        subscriptions.push(\n            updatedDataCheckup.subscribe(() => updateLocationData())\n        );\n    }\n    \n    function getEntityAttributes(attributes) {\n        for (var i = 0; i < attributes.length; i++) {\n            vm.attributes[attributes[i].key] = attributes[i].value;\n        }\n    }\n    \n    function updateLocationData() {\n        const location = vm.editEntityFormGroup.get('location');\n        widgetContext.data.forEach((itr) => {\n            if (vm.entityName === itr.datasource.entityName) {\n                if (itr.dataKey.name === 'latitude') {\n                    if (vm.attributes.latitude !== itr.data[0][1]) {\n                        vm.attributes.latitude = itr.data[0][1] ? itr.data[0][1].toFixed(5) : itr.data[0][1];\n                        location.get('latitude').setValue(vm.attributes.latitude);\n                    }\n                    \n                } else if (itr.dataKey.name === 'longitude') {\n                    if (vm.attributes.longitude !== itr.data[0][1]) {\n                        vm.attributes.longitude = itr.data[0][1] ? itr.data[0][1].toFixed(5) : itr.data[0][1];\n                        location.get('longitude').setValue(vm.attributes.longitude);\n                    }\n                }\n            }\n        })\n    }\n    \n    function saveEntity() {\n        \n        const formValues = vm.editEntityFormGroup.value;\n        let entity = {\n            name: formValues.general.entityName,\n            type: \"Tank\",\n            label: formValues.general.entityLabel\n        };\n        return deviceService.saveDevice(entity, groupId.id);\n    }\n\n\n    function updateEntity() {\n        const formValues = vm.editEntityFormGroup.value;\n        \n        if (vm.entity.label !== formValues.general.entityLabel ||\n            vm.entity.name !== formValues.general.entityName){\n            vm.entity.label = formValues.general.entityLabel;\n            vm.entity.name = formValues.general.entityName;\n            \n            return deviceService.saveDevice(vm.entity);\n        }\n        \n        return widgetContext.rxjs.of(null);\n    }\n\n    function saveAttributes(entityId) {\n        const details = vm.editEntityFormGroup.get('details').value;\n        \n        let attributesArray = [{key: 'alarmFilter', value: vm.attributes.alarmFilter}];\n        \n        for (let key in details) {\n            if (!Object.keys(vm.attributes).length ||\n                details[key] !== vm.attributes[key]) {\n                attributesArray.push({key: key, value: details[key]});\n            }\n        }\n        \n        if (attributesArray.length > 0) {\n            return attributeService.saveEntityAttributes(entityId, \"SERVER_SCOPE\", attributesArray);\n        }\n        return widgetContext.rxjs.of([]);\n    }\n\n}",
                "customResources": [],
                "openInSeparateDialog": false,
                "openInPopover": false,
                "id": "61c6fac9-19d1-0752-af8f-f179264c6cdf"
              }
            ]
          },
          "showTitleIcon": false,
          "titleTooltip": "",
          "enableDataExport": true,
          "widgetStyle": {},
          "widgetCss": "",
          "pageSize": 1024,
          "noDataDisplayMessage": ""
        },
        "row": 0,
        "col": 0,
        "id": "a4855683-5408-a263-eaac-67a08f7e3776"
      },
      "bd47533e-1ef8-bea5-e982-728322a17536": {
        "isSystemType": true,
        "bundleAlias": "alarm_widgets",
        "typeAlias": "alarms_table",
        "type": "alarm",
        "title": "New widget",
        "image": null,
        "description": null,
        "sizeX": 10.5,
        "sizeY": 6.5,
        "config": {
          "timewindow": {
            "hideInterval": false,
            "hideLastInterval": false,
            "hideQuickInterval": false,
            "hideAggregation": false,
            "hideAggInterval": false,
            "hideTimezone": false,
            "selectedTab": 0,
            "realtime": {
              "realtimeType": 0,
              "timewindowMs": 604800000,
              "quickInterval": "CURRENT_DAY",
              "interval": 1000
            },
            "aggregation": {
              "type": "NONE",
              "limit": 200
            }
          },
          "showTitle": true,
          "backgroundColor": "rgb(255, 255, 255)",
          "color": "rgba(0, 0, 0, 0.87)",
          "padding": "8px",
          "settings": {
            "enableSelection": false,
            "enableSearch": true,
            "enableSelectColumnDisplay": false,
            "enableFilter": true,
            "enableStickyHeader": true,
            "enableStickyAction": false,
            "reserveSpaceForHiddenAction": "true",
            "displayDetails": false,
            "allowAcknowledgment": false,
            "allowClear": false,
            "displayPagination": false,
            "defaultSortOrder": "-createdTime",
            "useRowStyleFunction": false
          },
          "title": "New Alarms table",
          "dropShadow": false,
          "enableFullscreen": true,
          "titleStyle": {
            "fontSize": "16px",
            "fontWeight": 500,
            "padding": "5px 10px 5px 10px",
            "color": "#29313C",
            "letterSpacing": "0.25px"
          },
          "useDashboardTimewindow": true,
          "showLegend": false,
          "alarmSource": {
            "type": "entity",
            "name": null,
            "entityAliasId": "e1a32425-259b-f9d4-7380-b40d12a71238",
            "filterId": "f7766c99-0996-844e-84bc-ac5923e173a2",
            "dataKeys": [
              {
                "name": "originator",
                "type": "alarm",
                "label": "Serial number",
                "color": "#4caf50",
                "settings": {
                  "useCellStyleFunction": false,
                  "cellStyleFunction": "",
                  "useCellContentFunction": false,
                  "cellContentFunction": ""
                },
                "_hash": 0.2780007688856758,
                "aggregationType": null,
                "units": null,
                "decimals": null,
                "funcBody": null,
                "usePostProcessing": null,
                "postFuncBody": null
              },
              {
                "name": "createdTime",
                "type": "alarm",
                "label": "Created time",
                "color": "#2196f3",
                "settings": {
                  "useCellStyleFunction": false,
                  "cellStyleFunction": "",
                  "useCellContentFunction": false,
                  "cellContentFunction": ""
                },
                "_hash": 0.021092237451093787
              },
              {
                "name": "type",
                "type": "alarm",
                "label": "Type",
                "color": "#f44336",
                "settings": {
                  "columnWidth": "25%",
                  "useCellStyleFunction": false,
                  "useCellContentFunction": false,
                  "defaultColumnVisibility": "visible",
                  "columnSelectionToDisplay": "enabled",
                  "columnExportOption": "onlyVisible"
                },
                "_hash": 0.7323586880398418,
                "aggregationType": null,
                "units": null,
                "decimals": null,
                "funcBody": null,
                "usePostProcessing": null,
                "postFuncBody": null
              },
              {
                "name": "severity",
                "type": "alarm",
                "label": "Details",
                "color": "#ffc107",
                "settings": {
                  "columnWidth": "0px",
                  "useCellStyleFunction": true,
                  "cellStyleFunction": "return {\n    \"color\": \"#D12730\",\n    \"font-weight\": 500\n}",
                  "useCellContentFunction": true,
                  "cellContentFunction": "\nreturn alarm.details.data ? alarm.details.data : '-';",
                  "defaultColumnVisibility": "visible",
                  "columnSelectionToDisplay": "enabled",
                  "columnExportOption": "onlyVisible"
                },
                "_hash": 0.06240450485076421,
                "aggregationType": null,
                "units": null,
                "decimals": null,
                "funcBody": null,
                "usePostProcessing": null,
                "postFuncBody": null
              }
            ],
            "alarmFilterConfig": {
              "statusList": [
                "ACTIVE"
              ]
            }
          },
          "alarmsPollingInterval": 5,
          "showTitleIcon": false,
          "titleIcon": "more_horiz",
          "iconColor": "rgba(0, 0, 0, 0.87)",
          "iconSize": "24px",
          "titleTooltip": "",
          "widgetStyle": {},
          "displayTimewindow": true,
          "actions": {
            "headerButton": [
              {
                "name": "Alarm rules",
                "icon": "settings",
                "useShowWidgetActionFunction": null,
                "showWidgetActionFunction": "return true;",
                "type": "customPretty",
                "customHtml": "<form [formGroup]=\"alarmRulesFormGroup\" (ngSubmit)=\"save()\" style=\"width:415px\">\n    <mat-toolbar style=\"background-color: transparent; border-bottom: solid 1px #0000001f;\">\n        <h2>Alarm rules</h2>\n        <span fxFlex></span>\n        <button mat-icon-button (click)=\"cancel()\" type=\"button\">\n            <mat-icon class=\"material-icons\">close</mat-icon>\n        </button>\n    </mat-toolbar>\n    <mat-progress-bar color=\"warn\" mode=\"indeterminate\" *ngIf=\"isLoading$ | async\">\n    </mat-progress-bar>\n    <div style=\"height: 4px;\" *ngIf=\"!(isLoading$ | async)\"></div>\n    <div mat-dialog-content fxLayout=\"column\">\n        <div fxLayout=\"row\" class=\"rule-row\">\n            <div class=\"rule-label\">Remaining level less than</div>\n            <div fxLayout=\"row\" style=\"align-items:baseline\">\n                <mat-form-field class=\"mat-block rule-input\" appearance=\"outline\">\n                    <input matInput type=\"number\" step=\"1\" formControlName=\"minFuelLevelThreshold\" required>\n                    <mat-error *ngIf=\"alarmRulesFormGroup.get('minFuelLevelThreshold').hasError('required')\">\n                        Required!\n                    </mat-error>\n                </mat-form-field>\n                <div class=\"rule-units\">%</div>\n            </div>\n        </div>\n        <div fxLayout=\"row\" class=\"rule-row\">\n            <div class=\"rule-label\">Temperature less than</div>\n            <div fxLayout=\"row\" style=\"align-items:baseline\">\n                <mat-form-field class=\"mat-block rule-input\" appearance=\"outline\">\n                    <input matInput type=\"number\" step=\"1\" formControlName=\"minTemperatureThreshold\" required>\n                    <mat-error *ngIf=\"alarmRulesFormGroup.get('minTemperatureThreshold').hasError('required')\">\n                        Required!\n                    </mat-error>\n                </mat-form-field>\n                <div class=\"rule-units\">Â°C</div>\n            </div>\n        </div>\n        <div fxLayout=\"row\" class=\"rule-row\">\n            <div class=\"rule-label\">Temperature higher than</div>\n            <div fxLayout=\"row\" style=\"align-items:baseline\">\n                <mat-form-field class=\"mat-block rule-input\" appearance=\"outline\">\n                    <input matInput type=\"number\" step=\"1\" formControlName=\"maxTemperatureThreshold\" required>\n                    <mat-error *ngIf=\"alarmRulesFormGroup.get('maxTemperatureThreshold').hasError('required')\">\n                        Required!\n                    </mat-error>\n                </mat-form-field>\n                <div class=\"rule-units\">Â°C</div>\n            </div>\n        </div>\n        <div fxLayout=\"row\" class=\"rule-row\">\n            <div class=\"rule-label\">Battery level less than</div>\n            <div fxLayout=\"row\" style=\"align-items:baseline\">\n                <mat-form-field class=\"mat-block rule-input\" appearance=\"outline\">\n                    <input matInput type=\"number\" step=\"1\" formControlName=\"minBatteryThreshold\" required>\n                    <mat-error *ngIf=\"alarmRulesFormGroup.get('minBatteryThreshold').hasError('required')\">\n                        Required!\n                    </mat-error>\n                </mat-form-field>\n                <div class=\"rule-units\">%</div>\n            </div>\n        </div>\n    \n        <div class=\"hint-content\">\n            Changes will be applied when the device sends new data\n        </div>\n    </div>\n    <div mat-dialog-actions fxLayoutAlign=\"end center\">\n        <button mat-button color=\"primary\"\n                type=\"button\"\n                [disabled]=\"(isLoading$ | async)\"\n                (click)=\"cancel()\" cdkFocusInitial>\n            Cancel\n        </button>\n        <button mat-button mat-raised-button color=\"primary\"\n                type=\"submit\"\n                [disabled]=\"(isLoading$ | async) || alarmRulesFormGroup.invalid || !alarmRulesFormGroup.dirty\">\n            Save\n        </button>\n    </div>\n</form>",
                "customCss": ".rule-row {\n    align-items: baseline;\n    min-width: 50px;\n}\n\n.rule-units {\n    margin-left: 3px;\n}\n\n.rule-input {\n    margin-right: 8px;\n    width: 80px;\n}\n\n.rule-label {\n    width: 190px;\n    letter-spacing: 0.2px;\n    color: rgba(0, 0, 0, 0.76);\n    margin-right: 70px;\n}\n\n.rule-input .mat-mdc-form-field-infix {\n    min-height: 40px;\n}\n\n.rule-input .mat-mdc-form-field-error-wrapper {\n    padding: 0;\n}\n\n.rule-input .mat-mdc-text-field-wrapper.mdc-text-field--outlined .mat-mdc-form-field-infix {\n    padding-top: 8px;\n    padding-bottom: 8px;\n}\n\n.hint-content {\n    padding: 8px 12px;\n    border-radius: 4px;\n    background: rgba(0, 0, 0, 0.04);\n    font-size: 13px;\n    line-height: 18px;\n    letter-spacing: 0.25px;\n    color: rgba(0, 0, 0, 0.54);\n}",
                "customFunction": "const $injector = widgetContext.$scope.$injector;\nconst customDialog = $injector.get(widgetContext.servicesMap.get('customDialog'));\nconst attributeService = $injector.get(widgetContext.servicesMap.get('attributeService'));\n\nopenAlarmRulesDialog();\n\nfunction openAlarmRulesDialog() {\n    customDialog.customDialog(htmlTemplate, AlarmRulesDialogController).subscribe();\n}\n\nfunction AlarmRulesDialogController(instance) {\n    const vm = instance;\n    const thresholdKeys = [\n        'minFuelLevelThreshold',\n        'minTemperatureThreshold',\n        'minBatteryThreshold',\n        'maxTemperatureThreshold'\n    ];\n    const tenantId = {\n        id: widgetContext.currentUser.tenantId,\n        entityType: 'TENANT'\n    };\n    \n    vm.attributes = {};\n    \n    vm.alarmRulesFormGroup = vm.fb.group({\n        minFuelLevelThreshold: [10, [vm.validators.required]],\n        minTemperatureThreshold: [0, [vm.validators.required]],\n        minBatteryThreshold: [20, [vm.validators.required]],\n        maxTemperatureThreshold: [80, [vm.validators.required]],\n    });\n    \n    getEntityInfo();\n    \n    vm.save = () => {\n        saveAttributes().subscribe(() => {\n            widgetContext.updateAliases();\n            vm.dialogRef.close(null);\n        });\n    };\n    \n    vm.cancel = function() {\n        vm.dialogRef.close(null);\n    };\n    \n    function getEntityInfo() {\n        attributeService.getEntityAttributes(tenantId, 'SERVER_SCOPE', thresholdKeys).subscribe(\n            (attrs) => {\n                getEntityAttributes(attrs);\n                vm.alarmRulesFormGroup.patchValue(vm.attributes);\n                    // binsBatteryLevelThreshold: vm.attributes.binsBatteryLevelThreshold ? vm.attributes.binsBatteryLevelThreshold : 30,\n                    // binsFullLevelThreshold: vm.attributes.binsFullLevelThreshold ? vm.attributes.binsFullLevelThreshold : 90\n        });\n    }\n    \n    function getEntityAttributes(attributes) {\n        for (let i = 0; i < attributes.length; i++) {\n            vm.attributes[attributes[i].key] = attributes[i].value;\n        }\n    }\n    \n    function saveAttributes() {\n        const attributes = vm.alarmRulesFormGroup.value;\n        const attributesArray = [];\n        for (let key in attributes) {\n            if (attributes[key] !== vm.attributes[key]) {\n                attributesArray.push({key: key, value: attributes[key]});\n            }\n        }\n        if (attributesArray.length > 0) {\n            return attributeService.saveEntityAttributes(tenantId, \"SERVER_SCOPE\", attributesArray);\n        } else {\n            return widgetContext.rxjs.of([]);\n        }\n    }\n}",
                "customResources": [],
                "openInSeparateDialog": false,
                "openInPopover": false,
                "id": "3e84d938-b2ee-9fd2-d18e-7555703ad781"
              }
            ],
            "actionCellButton": [
              {
                "name": "Clear",
                "icon": "close",
                "useShowWidgetActionFunction": null,
                "showWidgetActionFunction": "return true;",
                "type": "custom",
                "customFunction": "const $injector = widgetContext.$scope.$injector;\nconst dialogs = $injector.get(widgetContext.servicesMap.get('dialogs'));\nconst alarmService = $injector.get(widgetContext.servicesMap.get('alarmService'));\n\nopenDeleteEntityDialog();\n\nfunction openDeleteEntityDialog() {\n    const alarmType = additionalParams.alarm.type ? additionalParams.alarm.type : '';\n    const title = 'Clear ' + alarmType + ' Alarm';\n    const content = 'Are you sure you want to clear Alarm?';\n    dialogs.confirm(title, content, 'No', 'Yes').subscribe(\n        (result) => {\n            if (result) {\n                clearAlarm();\n            }\n        }\n    );\n}\n\nfunction clearAlarm() {\n    alarmService.clearAlarm(additionalParams.alarm.id.id).subscribe(\n        () => {\n            setTimeout(() => {\n                widgetContext.updateAliases();\n            }, 500);\n        },\n        () => {\n            showErrorDialog();\n        }\n    );\n}\n\nfunction showErrorDialog() {\n    const title = 'Error';\n    const content = 'An error occurred while clearing the alarm. Please try again.';\n    dialogs.alert(title, content, 'CLOSE').subscribe();\n}",
                "openInSeparateDialog": false,
                "openInPopover": false,
                "id": "2c0d3d51-a177-b473-2309-95caa4f4d7f4"
              }
            ]
          },
          "datasources": [],
          "enableDataExport": true,
          "widgetCss": "",
          "pageSize": 1024,
          "noDataDisplayMessage": "",
          "alarmFilterConfig": {
            "statusList": [
              "ACTIVE"
            ],
            "severityList": [],
            "typeList": [],
            "searchPropagatedAlarms": false
          }
        },
        "row": 0,
        "col": 0,
        "id": "bd47533e-1ef8-bea5-e982-728322a17536"
      },
      "09402650-e84b-171f-cd11-e608d8f89bfb": {
        "isSystemType": true,
        "bundleAlias": "cards",
        "typeAlias": "markdown_card",
        "type": "latest",
        "title": "New widget",
        "image": null,
        "description": null,
        "sizeX": 5,
        "sizeY": 3.5,
        "config": {
          "datasources": [
            {
              "type": "entity",
              "name": null,
              "entityAliasId": "cd74427b-6a97-ced1-262d-b0fe26af2ae8",
              "filterId": null,
              "dataKeys": [
                {
                  "name": "highTemperature",
                  "type": "attribute",
                  "label": "highTemperature",
                  "color": "#2196f3",
                  "settings": {},
                  "_hash": 0.44281921320875384,
                  "aggregationType": null,
                  "units": null,
                  "decimals": null,
                  "funcBody": null,
                  "usePostProcessing": true,
                  "postFuncBody": "return value !== 'unset';"
                },
                {
                  "name": "lowBattery",
                  "type": "attribute",
                  "label": "lowBattery",
                  "color": "#4caf50",
                  "settings": {},
                  "_hash": 0.338713616073099,
                  "aggregationType": null,
                  "units": null,
                  "decimals": null,
                  "funcBody": null,
                  "usePostProcessing": true,
                  "postFuncBody": "return value !== 'unset';"
                },
                {
                  "name": "lowRemaningLevel",
                  "type": "attribute",
                  "label": "lowRemaningLevel",
                  "color": "#f44336",
                  "settings": {},
                  "_hash": 0.44652549440453715,
                  "aggregationType": null,
                  "units": null,
                  "decimals": null,
                  "funcBody": null,
                  "usePostProcessing": true,
                  "postFuncBody": "return value !== 'unset';"
                },
                {
                  "name": "lowTemperature",
                  "type": "attribute",
                  "label": "lowTemperature",
                  "color": "#ffc107",
                  "settings": {},
                  "_hash": 0.033350726799084685,
                  "aggregationType": null,
                  "units": null,
                  "decimals": null,
                  "funcBody": null,
                  "usePostProcessing": true,
                  "postFuncBody": "return value !== 'unset';"
                },
                {
                  "name": "noAlarms",
                  "type": "attribute",
                  "label": "noAlarms",
                  "color": "#607d8b",
                  "settings": {},
                  "_hash": 0.05751102627236171,
                  "aggregationType": null,
                  "units": null,
                  "decimals": null,
                  "funcBody": null,
                  "usePostProcessing": true,
                  "postFuncBody": "return value !== 'unset';"
                },
                {
                  "name": "offline",
                  "type": "attribute",
                  "label": "offline",
                  "color": "#9c27b0",
                  "settings": {},
                  "_hash": 0.2892859337116618,
                  "aggregationType": null,
                  "units": null,
                  "decimals": null,
                  "funcBody": null,
                  "usePostProcessing": true,
                  "postFuncBody": "return value !== 'unset';"
                }
              ],
              "alarmFilterConfig": {
                "statusList": [
                  "ACTIVE"
                ]
              }
            }
          ],
          "timewindow": {
            "displayValue": "",
            "selectedTab": 0,
            "realtime": {
              "realtimeType": 1,
              "interval": 1000,
              "timewindowMs": 60000,
              "quickInterval": "CURRENT_DAY"
            },
            "history": {
              "historyType": 0,
              "interval": 1000,
              "timewindowMs": 60000,
              "fixedTimewindow": {
                "startTimeMs": 1682001930247,
                "endTimeMs": 1682088330247
              },
              "quickInterval": "CURRENT_DAY"
            },
            "aggregation": {
              "type": "AVG",
              "limit": 25000
            }
          },
          "showTitle": false,
          "backgroundColor": "#fff",
          "color": "rgba(0, 0, 0, 0.87)",
          "padding": "6px",
          "settings": {
            "useMarkdownTextFunction": true,
            "markdownTextFunction": "\nlet enabledFiltersString = '';\n\nif (data[0].noAlarms) {\n    enabledFiltersString += 'No alarms  ';\n}\n\nif (data[0].lowRemaningLevel) {\n    enabledFiltersString += 'Low remaining level  ';\n}\n\nif (data[0].highTemperature) {\n    enabledFiltersString += 'High temperature  ';\n}\n\nif (data[0].lowTemperature) {\n    enabledFiltersString += 'Low temperature  ';\n}\n\nif (data[0].lowBattery) {\n    enabledFiltersString += 'Low battery  ';\n}\n\nif (data[0].offline) {\n    enabledFiltersString += 'Offline  ';\n}\n\nif (enabledFiltersString.length > 0) {\n    enabledFiltersString = enabledFiltersString.replace(/  /g, ', ');\n    enabledFiltersString = enabledFiltersString.slice(0, -2) + '.';\n}\n\nctx.enabledFiltersString = enabledFiltersString;\n\nif (!ctx.markdownInited) {\n    ctx.markdownInited = true;\n    return '<div class=\"tank-layout\" style=\"width: 100%; height: 100%; padding: 0;\" fxLayout=\"column\">' +\n            '<tb-dashboard-state fxFlex [ctx]=\"ctx\" [syncParentStateParams]=\"true\" stateId=\"tanks-location\"></tb-dashboard-state>' +\n            '<mat-expansion-panel hideToggle=\"true\" id=\"arrow_rotate\" [expanded]=\"true\">' + \n                '<mat-expansion-panel-header>' + \n                    '<mat-panel-title style=\"min-width: 95px; max-width: 95px; align-items: center;\">' +\n                      '<label class=\"tb-panel-title\" style=\"height: min-content;\">Filter alarms</label>' +\n                    '</mat-panel-title>' +\n                    '<mat-panel-description class=\"panel-icon\">' + \n                      '<mat-icon class=\"tb-panel-description\" id=\"tb-rotation-arrow\">keyboard_arrow_down</mat-icon>' + \n                    '</mat-panel-description>' + \n                    '<mat-panel-description class=\"panel-text\" style=\"min-width: 190px;\">' + \n                        '<label style=\"display: none;\" class=\"panel-text-label\">' +\n                          enabledFiltersString + \n                        '</label>' +\n                        '<div class=\"panel-buttons\" (click)=\"$event.stopPropagation()\">' + \n                            '<tb-dashboard-state fxFlex [ctx]=\"ctx\" style=\"height: 50px;\" stateId=\"device-alarm-filter-buttons\"></tb-dashboard-state>' + \n                        '</div>' +\n                    '</mat-panel-description>' +\n                '</mat-expansion-panel-header>' +\n                '<tb-dashboard-state class=\"tank-filter-toggles\" fxFlex [ctx]=\"ctx\" stateId=\"device-alarm-filter\"></tb-dashboard-state>' +\n            '</mat-expansion-panel>' +\n        '</div>';\n}",
            "applyDefaultMarkdownStyle": true,
            "markdownCss": ".tb-markdown-view .tb-progress-cover, .tb-markdown-view .mat-drawer-container {\n    background-color: #fff;\n}\n\n.tb-markdown-view div, .tb-markdown-view p {\n    line-height: normal;\n}\n\n.tank-layout .mat-expansion-panel-body {\n    padding: 0;\n}\n\n.tank-layout .mat-expansion-panel-header {\n    padding: 0 8px;\n}\n\n.tank-layout .mat-expansion-panel-header-title, .mat-expansion-panel-header-description {\n    margin: 0;\n    /*justify-content: flex-end;*/\n}\n\n.tank-layout .mat-expansion-panel-header-title {\n    justify-content: flex-start;\n}\n\n.tank-layout .panel-text {\n    justify-content: flex-end;\n    align-items: center;\n}\n\n.tank-layout .panel-icon {\n    justify-content: flex-start;\n    align-items: center;\n    max-width: 90px;\n}\n\n.tank-layout .panel-text-label {\n    height: min-content;\n    font-weight: 400;\n    letter-spacing: 0.2px;\n}\n\n.tank-layout .mat-expansion-panel-header-description label {\n    width: 80%;\n    padding: 0;\n    text-align: right;\n    text-overflow: ellipsis;\n    white-space: nowrap;\n    overflow: hidden;\n}\n\n.tank-layout .mat-expansion-panel-header {\n  justify-content: flex-start;\n}\n\n#tb-rotation-arrow {\n  transition: transform 0.5s ease;\n}\n\n#tb-rotation-arrow::after {\n  content: '';\n  display: block;\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  z-index: -1;\n}\n\n#tb-rotation-arrow.clicked {\n  transform: rotate(-180deg);\n}\n\n#tb-rotation-arrow.clicked::after {\n  transform: rotate(180deg);\n}\n\n.mat-content .mat-content-hide-toggle {\n    height: 100%;\n    margin: 0;\n}\n\n.panel-buttons {\n    width: 100%;\n    max-width: 190px;\n}\n\n.tb-panel-title {\n    font-size: 16px;\n    line-height: 24px;\n    letter-spacing: 0.25px;\n}\n\n.tank-layout .tank-filter-toggles {\n    height: 175px;\n}"
          },
          "title": "New Markdown/HTML Card",
          "showTitleIcon": false,
          "iconColor": "rgba(0, 0, 0, 0.87)",
          "iconSize": "24px",
          "titleTooltip": "",
          "dropShadow": true,
          "enableFullscreen": false,
          "widgetStyle": {},
          "titleStyle": {
            "fontSize": "16px",
            "fontWeight": 400
          },
          "showLegend": false,
          "enableDataExport": false,
          "widgetCss": "\n.tank-layout .tb-widget-container .tb-widget .tb-multiple-input {\n    /*background-color: rgba(0, 0, 0, 0.04);*/\n    border-radius: 4px;\n}\n\n.tank-layout .tb-widget-container .tb-widget .tb-multiple-input .tb-multiple-input-container {\n    padding-right: 0;\n}\n\n.tank-layout .tb-widget-container .tb-widget .tb-multiple-input .tb-multiple-input-container .label-wrapper {\n    text-overflow: ellipsis;\n    white-space: nowrap;\n    overflow: hidden;\n}\n\n.tb-widget-container .tb-widget .tank-layout .tb-multiple-input .mat-mdc-slide-toggle {\n    margin-top: 15px;\n    margin-bottom: 15px;\n}\n\n/*.tb-widget-container .tb-widget .tb-multiple-input .mdc-form-field > label {*/\n/*    min-width: 160px;*/\n/*}*/\n\n.tb-widget-container .tb-widget .tb-multiple-input .mat-mdc-slide-toggle .mdc-form-field > label .mat-icon {\n    margin-left: 0;\n}\n\n/*.tb-widget-container .tb-widget .tb-multiple-input .mat-mdc-slide-toggle .mdc-form-field .label-wrapper {*/\n/*    font-weight: bold;*/\n/*}*/\n\n.tb-widget-container .tb-widget .tb-multiple-input .mat-mdc-slide-toggle .mdc-switch {\n    width: 42px;\n    margin-left: 8px;\n}\n\n.tb-widget-container .tb-widget .tb-multiple-input .mat-mdc-slide-toggle .mdc-switch .mdc-switch__track {\n    border-radius: 16px;\n    height: 24px;\n}\n\n.tb-widget-container .tb-widget .tb-multiple-input .mat-mdc-slide-toggle .mdc-switch .mdc-switch__handle-track {\n    width: calc(100% - 24px);\n    left: 2px;\n}\n\n.tb-widget-container .tb-widget .tb-multiple-input .mat-mdc-slide-toggle .mdc-switch .mdc-switch__handle {\n    border-radius: 10px;\n    width: 20px;\n    height: 20px;\n}\n\n.tb-widget-container .tb-widget .tb-multiple-input .mat-mdc-slide-toggle .mdc-switch .mdc-switch__ripple {\n    width: 40px;\n    height: 40px;\n}\n\n.tb-widget-container .tb-widget .tb-multiple-input .mat-mdc-slide-toggle .mdc-switch .mdc-switch__icons {\n    display: none;\n}\n\n.tb-widget-container .tb-widget .tb-multiple-input .mat-mdc-slide-toggle .mdc-switch.mdc-switch--unselected:enabled .mdc-switch__handle::after {\n    background: #fafafa;\n}\n\n.tb-widget-container .tb-widget .tb-multiple-input .mat-mdc-slide-toggle .mdc-switch.mdc-switch--selected:enabled .mdc-switch__handle::after {\n    background: #fafafa;\n}\n\n.tb-widget-container .tb-widget .tb-multiple-input .mat-mdc-slide-toggle .mdc-switch .mdc-switch__track::after {\n    background: #9699FF !important;\n}\n\n.mat-content.mat-content-hide-toggle {\n    height: 100%;\n    margin: 0;\n}\n\n.tank-layout .mat-expansion-panel-body {\n    padding: 0;\n}\n\n.tank-layout .mdc-button {\n    color: #474BD2 !important;\n}\n\n\n.tank-layout .panel-buttons {\n    width: 100%;\n    padding-right: 1px !important;\n}\n\n.tank-layout .mat-mdc-slide-toggle .mdc-switch {\n    margin-left: 0 !important;\n}\n",
          "noDataDisplayMessage": "",
          "useDashboardTimewindow": true,
          "pageSize": 1024,
          "actions": {
            "elementClick": [
              {
                "name": "arrow_rotate",
                "icon": "more_horiz",
                "useShowWidgetActionFunction": null,
                "showWidgetActionFunction": "return true;",
                "type": "custom",
                "customFunction": "\nif ($event.target && \n        ($event.target.className.includes('expansion-panel-header') ||\n        $event.target.className.includes('panel-description') ||\n        $event.target.className.includes('panel-title') || \n        $event.target.className.includes('panel-text') || \n        $event.target.className.includes('panel-buttons'))\n   ) {\n    const arrow = document.querySelector('#tb-rotation-arrow');\n    const panelTextLabel = document.getElementsByClassName('panel-text-label')[0];\n    const panelButtons = document.getElementsByClassName('panel-buttons')[0];\n    \n    widgetContext.panelOpenState = !widgetContext.panelOpenState;\n    arrow.classList.toggle('clicked');\n    panelTextLabel.textContent = widgetContext.enabledFiltersString;\n    \n    if (widgetContext.panelOpenState) {\n        panelTextLabel.style = \"display: block\";\n        panelButtons.style = \"display: none\";\n    } else {\n        panelTextLabel.style = \"display: none\";\n        panelButtons.style = \"display: block\";\n    }\n}",
                "openInSeparateDialog": false,
                "openInPopover": false,
                "id": "d3236ada-e737-f872-1fe0-a3fe5f1fe985"
              }
            ]
          }
        },
        "row": 0,
        "col": 0,
        "id": "09402650-e84b-171f-cd11-e608d8f89bfb"
      },
      "ad8020a2-53fd-8334-c94e-2a7af3774780": {
        "isSystemType": true,
        "bundleAlias": "maps_v2",
        "typeAlias": "openstreetmap",
        "type": "latest",
        "title": "New widget",
        "image": null,
        "description": null,
        "sizeX": 8.5,
        "sizeY": 6,
        "config": {
          "datasources": [
            {
              "type": "entity",
              "name": null,
              "entityAliasId": "e1a32425-259b-f9d4-7380-b40d12a71238",
              "filterId": "f7766c99-0996-844e-84bc-ac5923e173a2",
              "dataKeys": [
                {
                  "name": "latitude",
                  "type": "attribute",
                  "label": "latitude",
                  "color": "#2196f3",
                  "settings": {},
                  "_hash": 0.7494193897041803
                },
                {
                  "name": "longitude",
                  "type": "attribute",
                  "label": "longitude",
                  "color": "#4caf50",
                  "settings": {},
                  "_hash": 0.9838447132407786
                },
                {
                  "name": "active",
                  "type": "attribute",
                  "label": "active",
                  "color": "#f44336",
                  "settings": {},
                  "_hash": 0.6846057478799168
                },
                {
                  "name": "battery",
                  "type": "timeseries",
                  "label": "battery",
                  "color": "#8bc34a",
                  "settings": {},
                  "_hash": 0.7804883468187684,
                  "aggregationType": "NONE",
                  "units": null,
                  "decimals": null,
                  "funcBody": null,
                  "usePostProcessing": null,
                  "postFuncBody": null
                },
                {
                  "name": "liquidType",
                  "type": "attribute",
                  "label": "liquidType",
                  "color": "#9c27b0",
                  "settings": {},
                  "_hash": 0.5112403657601383
                },
                {
                  "name": "temperature",
                  "type": "timeseries",
                  "label": "temperature",
                  "color": "#8bc34a",
                  "settings": {},
                  "_hash": 0.6026874983363109
                },
                {
                  "name": "tankCapacity",
                  "type": "attribute",
                  "label": "tankCapacity",
                  "color": "#03a9f4",
                  "settings": {},
                  "_hash": 0.11473993178433628
                },
                {
                  "name": "fuelLevel",
                  "type": "timeseries",
                  "label": "fuelLevel",
                  "color": "#ff9800",
                  "settings": {},
                  "_hash": 0.9116024261844533
                },
                {
                  "name": "isHighTemperature",
                  "type": "attribute",
                  "label": "isHighTemperature",
                  "color": "#e91e63",
                  "settings": {},
                  "_hash": 0.9632470736529124,
                  "aggregationType": null,
                  "units": null,
                  "decimals": null,
                  "funcBody": null,
                  "usePostProcessing": true,
                  "postFuncBody": "return value === \"true\";"
                },
                {
                  "name": "isLowBattery",
                  "type": "attribute",
                  "label": "isLowBattery",
                  "color": "#ffeb3b",
                  "settings": {},
                  "_hash": 0.37472605989530705,
                  "aggregationType": null,
                  "units": null,
                  "decimals": null,
                  "funcBody": null,
                  "usePostProcessing": true,
                  "postFuncBody": "return value === \"true\";"
                },
                {
                  "name": "isLowFuel",
                  "type": "attribute",
                  "label": "isLowFuel",
                  "color": "#03a9f4",
                  "settings": {},
                  "_hash": 0.7321873987269121,
                  "aggregationType": null,
                  "units": null,
                  "decimals": null,
                  "funcBody": null,
                  "usePostProcessing": true,
                  "postFuncBody": "return value === \"true\";"
                },
                {
                  "name": "isLowTemperature",
                  "type": "attribute",
                  "label": "isLowTemperature",
                  "color": "#ff9800",
                  "settings": {},
                  "_hash": 0.33412107130818325,
                  "aggregationType": null,
                  "units": null,
                  "decimals": null,
                  "funcBody": null,
                  "usePostProcessing": true,
                  "postFuncBody": "return value === \"true\";"
                }
              ]
            }
          ],
          "timewindow": {
            "displayValue": "",
            "selectedTab": 0,
            "realtime": {
              "realtimeType": 1,
              "interval": 1000,
              "timewindowMs": 60000,
              "quickInterval": "CURRENT_DAY"
            },
            "history": {
              "historyType": 0,
              "interval": 1000,
              "timewindowMs": 60000,
              "fixedTimewindow": {
                "startTimeMs": 1682001930247,
                "endTimeMs": 1682088330247
              },
              "quickInterval": "CURRENT_DAY"
            },
            "aggregation": {
              "type": "AVG",
              "limit": 25000
            }
          },
          "showTitle": false,
          "backgroundColor": "#fff",
          "color": "rgba(0, 0, 0, 0.87)",
          "padding": "0px",
          "settings": {
            "provider": "openstreet-map",
            "mapProvider": "CartoDB.Positron",
            "useCustomProvider": true,
            "customProviderTileUrl": "https://tiles.stadiamaps.com/tiles/outdoors/{z}/{x}/{y}{r}.png",
            "latKeyName": "latitude",
            "lngKeyName": "longitude",
            "xPosKeyName": "xPos",
            "yPosKeyName": "yPos",
            "defaultZoomLevel": 0,
            "defaultCenterPosition": "0,0",
            "disableScrollZooming": false,
            "disableDoubleClickZooming": false,
            "disableZoomControl": false,
            "fitMapBounds": true,
            "useDefaultCenterPosition": false,
            "mapPageSize": 16384,
            "markerOffsetX": 0.5,
            "markerOffsetY": 1,
            "posFunction": "return {x: origXPos, y: origYPos};",
            "draggableMarker": false,
            "showLabel": false,
            "useLabelFunction": false,
            "label": "${entityName}",
            "showTooltip": true,
            "showTooltipAction": "click",
            "autocloseTooltip": true,
            "useTooltipFunction": true,
            "tooltipPattern": "<b>${entityName}</b><br/><br/><b>Latitude:</b> ${latitude:7}<br/><b>Longitude:</b> ${longitude:7}",
            "tooltipFunction": "\nconst fuelLevel = data.fuelLevel;\nconst batteryLevel = data.battery;\nconst tankCapacity = data.tankCapacity;\nconst temperature = data.temperature;\nconst fuel = processValue((fuelLevel * tankCapacity) / 100, 0);\nconst liquidType = data.liquidType ? data.liquidType : 'N/A';\nconst lowFuelLevelColor = data.isLowFuel ? '#D12730' : '#29313C';\nconst lowBatteryColor = data.isLowBattery ? '#D12730' : '#29313C';\nconst thresholdTemperatureColor = data.isHighTemperature || data.isLowTemperature ? '#D12730' : '#29313C';\n                              \nconst isActive = data.active === 'true';\nconst status = isActive ? 'Online' : 'Offline';\nconst color = isActive ? '#3AA94D' : '#C42F37';\nconst bgColor = isActive ? 'rgba(58, 169, 77, 0.08)' : 'rgba(196, 47, 55, 0.08)';\nconst lastUpdate = (data['battery|ts'] || data['fuelLevel|ts']) ? \n    moment(Math.max(data['battery|ts'], data['fuelLevel|ts'])).format('D MMM YYYY HH:mm') : 'N/A';\nconst remaining = `${fuelLevel}% (${fuel}L)`;\n\nreturn '<div style=\"display:flex;flex-direction:column;margin-bottom:8px;font-family:\\'Roboto\\';font-weight:500;font-size:16px;line-height:24px;letter-spacing:0.25px;color:#29313C\">' +\n            '<div>Tank ${entityName}</div>' +\n            '<div style=\"width: 100%;border-bottom:1px solid rgba(0, 0, 0, 0.12);margin:12px 0;\"></div>' +\n            '<div style=\"display:flex;flex-direction:row;align-items:baseline;margin-bottom:9px;\">' +\n                '<div style=\"font-size:13px;line-height:16px;font-weight:500;color:rgba(0, 0, 0, 0.38);width:100px\">Liquid type</div>' +\n                '<div style=\"font-size:14px;line-height:20px;font-weight:500;letter-spacing:0.25px\">'+ liquidType +'</div>' +\n            '</div>' +\n            '<div style=\"display:flex;flex-direction:row;align-items:baseline;margin-bottom:9px;\">' +\n                '<div style=\"font-size:13px;line-height:16px;font-weight:500;color:rgba(0, 0, 0, 0.38);width:100px\">Remaining</div>' +\n                '<div style=\"color:'+ lowFuelLevelColor +';font-size:14px;line-height:20px;font-weight:500;letter-spacing:0.25px\">'+ remaining +'</div>' +\n            '</div>' +\n            '<div style=\"display:flex;flex-direction:row;align-items:baseline;margin-bottom:9px;\">' +\n                '<div style=\"font-size:13px;line-height:16px;font-weight:500;color:rgba(0, 0, 0, 0.38);width:100px\">Temperature</div>' +\n                '<div style=\"color:'+ thresholdTemperatureColor +';font-size:14px;line-height:20px;font-weight:500;letter-spacing:0.25px\">'+ temperature +'Â°C</div>' +\n            '</div>' +\n            '<div style=\"display:flex;flex-direction:row;align-items:baseline;margin-bottom:9px;\">' +\n                '<div style=\"font-size:13px;line-height:16px;font-weight:500;color:rgba(0, 0, 0, 0.38);width:100px\">Battery level</div>' +\n                '<div style=\"color:'+ lowBatteryColor +';font-size:14px;line-height:20px;font-weight:500;letter-spacing:0.25px\">'+ batteryLevel +'%</div>' +\n            '</div>' +\n            '<div style=\"display:flex;flex-direction:row;align-items:baseline;margin-bottom:9px;\">' +\n                '<div style=\"font-size:13px;line-height:16px;font-weight:500;color:rgba(0, 0, 0, 0.38);width:100px\">Connection</div>' +\n                '<div style=\"font-size:14px;width:fit-content;padding:4px 8px;font-weight:500;line-height:20px;letter-spacing:0.25px;border-radius:8px;color:'+ color +';background-color:'+ bgColor +'\">' + status + '</div>' +\n            '</div>' +\n            '<div style=\"display:flex;flex-direction:row;align-items:baseline;margin-bottom:13px;\">' +\n                '<div style=\"font-size:13px;line-height:16px;font-weight:500;color:rgba(0, 0, 0, 0.38);width:100px\">Last update</div>' +\n                '<div style=\"font-size:14px;line-height:20px;font-weight:500;color:#29313C;letter-spacing:0.25px\">'+ lastUpdate +'</div>' +\n            '</div>' +\n       '</div>' +\n       '<div style=\"text-align: center\">' +\n            '<link-act name=\"tank-details\">Details ></link-act>' +\n       '</div>';\n\nfunction isNumber(value) {\n    return (typeof value === 'number' && isFinite(value));\n}\n\nfunction processValue(value, dec) {\n    value = parseFloat(value);\n    if (isNumber(value)) {\n        if (isNumber(dec)) {\n            value = parseFloat(value.toFixed(dec));\n        }\n        return value;\n    } else {\n        return 'N/A';\n    }\n}",
            "tooltipOffsetX": 0,
            "tooltipOffsetY": -1,
            "color": "#fe7569",
            "useColorFunction": false,
            "useMarkerImageFunction": true,
            "markerImageSize": 34,
            "markerImageFunction": "let image = images[0];\nif (data) {\n    const isActive = data.active && data.active !== 'false';\n    const fuelLevel = data.fuelLevel;\n    const batteryLevel = data.battery;\n    const tankCapacity = data.tankCapacity;\n    const temperature = data.temperature;\n    const lowFuelLevel = data.isLowFuel;\n    const lowBattery = data.isLowBattery;\n    const thresholdTemperature = data.isHighTemperature || data.isLowTemperature;\n    \n    if (!isActive) {\n        image = images[3];\n    } else if (lowFuelLevel || thresholdTemperature) {\n        image = images[1];\n    } else if (lowBattery) {\n        image = images[2];\n    }\n}\n\nreturn {\n    url: image,\n    size: 28\n};\n",
            "markerImages": [
              "data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjgiIGhlaWdodD0iMjgiIHZpZXdCb3g9IjAgMCAyOCAyOCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3QgeD0iMC41IiB5PSIwLjUiIHdpZHRoPSIyNyIgaGVpZ2h0PSIyNyIgcng9IjMuNSIgZmlsbD0id2hpdGUiLz4KPHBhdGggZD0iTTcgMjEuNDAwM1Y3LjE3MTg4SDIxTDIwLjgzOTEgMjEuNzIwMUMyMC41MTcyIDIyLjQ2NjEgMTkgMjQuMjc4IDE0LjA4MDUgMjQuMjc4QzkuNDM4OTIgMjQuMjc4IDcuNDI5MTIgMjIuNDY2MSA3IDIxLjQwMDNaIiBmaWxsPSIjMTk4MDM4IiBzdHJva2U9IndoaXRlIi8+CjxlbGxpcHNlIGN4PSIxNCIgY3k9IjYuODU0NjQiIHJ4PSI3IiByeT0iMi44NTQ2NCIgZmlsbD0iIzE5ODAzOCIgc3Ryb2tlPSJ3aGl0ZSIvPgo8cGF0aCBkPSJNNyAxNS41QzkuNjY2NjcgMTYuNSAxNi4yIDE3LjkgMjEgMTUuNSIgc3Ryb2tlPSJ3aGl0ZSIvPgo8cmVjdCB4PSIxNiIgeT0iNiIgd2lkdGg9IjIiIGhlaWdodD0iMSIgcng9IjAuNSIgZmlsbD0id2hpdGUiLz4KPHJlY3QgeD0iMC41IiB5PSIwLjUiIHdpZHRoPSIyNyIgaGVpZ2h0PSIyNyIgcng9IjMuNSIgc3Ryb2tlPSIjMTk4MDM4Ii8+Cjwvc3ZnPgo=",
              "data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjgiIGhlaWdodD0iMjgiIHZpZXdCb3g9IjAgMCAyOCAyOCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3QgeD0iMC41IiB5PSIwLjUiIHdpZHRoPSIyNyIgaGVpZ2h0PSIyNyIgcng9IjMuNSIgZmlsbD0id2hpdGUiLz4KPHBhdGggZD0iTTcgMjEuNDAwM1Y3LjE3MTg4SDIxTDIwLjgzOTEgMjEuNzIwMUMyMC41MTcyIDIyLjQ2NjEgMTkgMjQuMjc4IDE0LjA4MDUgMjQuMjc4QzkuNDM4OTIgMjQuMjc4IDcuNDI5MTIgMjIuNDY2MSA3IDIxLjQwMDNaIiBmaWxsPSIjRDEyNzMwIiBzdHJva2U9IndoaXRlIi8+CjxlbGxpcHNlIGN4PSIxNCIgY3k9IjYuODU0NjQiIHJ4PSI3IiByeT0iMi44NTQ2NCIgZmlsbD0iI0QxMjczMCIgc3Ryb2tlPSJ3aGl0ZSIvPgo8cGF0aCBkPSJNNyAxNS41QzkuNjY2NjcgMTYuNSAxNi4yIDE3LjkgMjEgMTUuNSIgc3Ryb2tlPSJ3aGl0ZSIvPgo8cmVjdCB4PSIxNiIgeT0iNiIgd2lkdGg9IjIiIGhlaWdodD0iMSIgcng9IjAuNSIgZmlsbD0id2hpdGUiLz4KPHJlY3QgeD0iMC41IiB5PSIwLjUiIHdpZHRoPSIyNyIgaGVpZ2h0PSIyNyIgcng9IjMuNSIgc3Ryb2tlPSIjRDEyNzMwIi8+Cjwvc3ZnPgo=",
              "data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjgiIGhlaWdodD0iMjgiIHZpZXdCb3g9IjAgMCAyOCAyOCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3QgeD0iMC41IiB5PSIwLjUiIHdpZHRoPSIyNyIgaGVpZ2h0PSIyNyIgcng9IjMuNSIgZmlsbD0id2hpdGUiLz4KPHBhdGggZD0iTTcgMjEuNDAwM1Y3LjE3MTg4SDIxTDIwLjgzOTEgMjEuNzIwMUMyMC41MTcyIDIyLjQ2NjEgMTkgMjQuMjc4IDE0LjA4MDUgMjQuMjc4QzkuNDM4OTIgMjQuMjc4IDcuNDI5MTIgMjIuNDY2MSA3IDIxLjQwMDNaIiBmaWxsPSIjRkFBNDA1IiBzdHJva2U9IndoaXRlIi8+CjxlbGxpcHNlIGN4PSIxNCIgY3k9IjYuODU0NjQiIHJ4PSI3IiByeT0iMi44NTQ2NCIgZmlsbD0iI0ZBQTQwNSIgc3Ryb2tlPSJ3aGl0ZSIvPgo8cGF0aCBkPSJNNyAxNS41QzkuNjY2NjcgMTYuNSAxNi4yIDE3LjkgMjEgMTUuNSIgc3Ryb2tlPSJ3aGl0ZSIvPgo8cmVjdCB4PSIxNiIgeT0iNiIgd2lkdGg9IjIiIGhlaWdodD0iMSIgcng9IjAuNSIgZmlsbD0id2hpdGUiLz4KPHJlY3QgeD0iMC41IiB5PSIwLjUiIHdpZHRoPSIyNyIgaGVpZ2h0PSIyNyIgcng9IjMuNSIgc3Ryb2tlPSIjRkFBNDA1Ii8+Cjwvc3ZnPgo=",
              "data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjgiIGhlaWdodD0iMjgiIHZpZXdCb3g9IjAgMCAyOCAyOCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjI4IiBoZWlnaHQ9IjI4IiByeD0iNCIgZmlsbD0id2hpdGUiLz4KPHBhdGggZD0iTTcgMjEuNDAwM1Y3LjE3MTg4SDIxTDIwLjgzOTEgMjEuNzIwMUMyMC41MTcyIDIyLjQ2NjEgMTkgMjQuMjc4IDE0LjA4MDUgMjQuMjc4QzkuNDM4OTIgMjQuMjc4IDcuNDI5MTIgMjIuNDY2MSA3IDIxLjQwMDNaIiBmaWxsPSIjQTdBN0E3IiBzdHJva2U9IndoaXRlIi8+CjxlbGxpcHNlIGN4PSIxNCIgY3k9IjYuODU0NjQiIHJ4PSI3IiByeT0iMi44NTQ2NCIgZmlsbD0iI0E3QTdBNyIgc3Ryb2tlPSJ3aGl0ZSIvPgo8cGF0aCBkPSJNNyAxNS41QzkuNjY2NjcgMTYuNSAxNi4yIDE3LjkgMjEgMTUuNSIgc3Ryb2tlPSJ3aGl0ZSIvPgo8cmVjdCB4PSIxNiIgeT0iNiIgd2lkdGg9IjIiIGhlaWdodD0iMSIgcng9IjAuNSIgZmlsbD0id2hpdGUiLz4KPHJlY3QgeD0iMC41IiB5PSIwLjUiIHdpZHRoPSIyNyIgaGVpZ2h0PSIyNyIgcng9IjMuNSIgc3Ryb2tlPSJibGFjayIgc3Ryb2tlLW9wYWNpdHk9IjAuMzgiLz4KPC9zdmc+Cg=="
            ],
            "showPolygon": false,
            "polygonKeyName": "perimeter",
            "editablePolygon": false,
            "showPolygonLabel": false,
            "usePolygonLabelFunction": false,
            "polygonLabel": "${entityName}",
            "showPolygonTooltip": false,
            "showPolygonTooltipAction": "click",
            "autoClosePolygonTooltip": true,
            "usePolygonTooltipFunction": false,
            "polygonTooltipPattern": "<b>${entityName}</b><br/><br/><b>TimeStamp:</b> ${ts:7}",
            "polygonColor": "#3388ff",
            "polygonOpacity": 0.2,
            "usePolygonColorFunction": false,
            "polygonStrokeColor": "#3388ff",
            "polygonStrokeOpacity": 1,
            "polygonStrokeWeight": 3,
            "usePolygonStrokeColorFunction": false,
            "showCircle": false,
            "circleKeyName": "perimeter",
            "editableCircle": false,
            "showCircleLabel": false,
            "useCircleLabelFunction": false,
            "circleLabel": "${entityName}",
            "showCircleTooltip": false,
            "showCircleTooltipAction": "click",
            "autoCloseCircleTooltip": true,
            "useCircleTooltipFunction": false,
            "circleTooltipPattern": "<b>${entityName}</b><br/><br/><b>TimeStamp:</b> ${ts:7}",
            "circleFillColor": "#3388ff",
            "circleFillColorOpacity": 0.2,
            "useCircleFillColorFunction": false,
            "circleStrokeColor": "#3388ff",
            "circleStrokeOpacity": 1,
            "circleStrokeWeight": 3,
            "useCircleStrokeColorFunction": false,
            "useClusterMarkers": true,
            "zoomOnClick": true,
            "maxClusterRadius": 80,
            "animate": true,
            "spiderfyOnMaxZoom": false,
            "showCoverageOnHover": true,
            "chunkedLoading": false,
            "removeOutsideVisibleBounds": true,
            "useIconCreateFunction": true,
            "clusterMarkerFunction": "if (data && data.length && childCount === data.length) {\n   const alarmsState = data.map((entity) => {\n        if (entity) {\n            const isActive = entity.active && entity.active !== 'false';\n            const fuelLevel = entity.fuelLevel;\n            const batteryLevel = entity.battery;\n            const tankCapacity = entity.tankCapacity;\n            const temperature = entity.temperature;\n            const lowFuelLevel = entity.isLowFuel;\n            const lowBattery = entity.isLowBattery;\n            const thresholdTemperature = entity.isHighTemperature || entity.isLowTemperature;\n            const isAlarm = lowFuelLevel || lowBattery || thresholdTemperature || !isActive;\n            \n            return isAlarm;\n        }\n        \n        return false;\n    });\n    \n    return alarmsState.includes(true) ? '#ff0000' : '#73c65e'; \n}\n\nreturn '#73c65e';"
          },
          "title": "",
          "dropShadow": false,
          "enableFullscreen": true,
          "titleStyle": {
            "fontSize": "16px",
            "fontWeight": 400
          },
          "useDashboardTimewindow": true,
          "showLegend": false,
          "widgetStyle": {},
          "actions": {
            "tooltipAction": [
              {
                "name": "tank-details",
                "icon": "more_horiz",
                "useShowWidgetActionFunction": null,
                "showWidgetActionFunction": "return true;",
                "type": "openDashboardState",
                "targetDashboardStateId": "tank-details",
                "setEntityId": true,
                "stateEntityParamName": null,
                "openRightLayout": false,
                "openInSeparateDialog": false,
                "openInPopover": false,
                "id": "e38e7a79-6238-7bbd-6bc2-5b90a3dfd660"
              }
            ]
          },
          "showTitleIcon": false,
          "titleTooltip": "",
          "enableDataExport": false,
          "widgetCss": ".leaflet-container a.leaflet-popup-close-button {\n    top: 15px;\n    right: 20px;\n}",
          "pageSize": 1024,
          "noDataDisplayMessage": ""
        },
        "row": 0,
        "col": 0,
        "id": "ad8020a2-53fd-8334-c94e-2a7af3774780"
      },
      "50496c24-028d-33f9-2a34-60b9b5b467ce": {
        "isSystemType": true,
        "bundleAlias": "input_widgets",
        "typeAlias": "update_multiple_attributes",
        "type": "latest",
        "title": "New widget",
        "image": null,
        "description": null,
        "sizeX": 7.5,
        "sizeY": 3,
        "config": {
          "datasources": [
            {
              "type": "entity",
              "name": null,
              "entityAliasId": "cd74427b-6a97-ced1-262d-b0fe26af2ae8",
              "filterId": null,
              "dataKeys": [
                {
                  "name": "noAlarms",
                  "type": "attribute",
                  "label": "No alarms",
                  "color": "#f44336",
                  "settings": {
                    "dataKeyHidden": false,
                    "dataKeyType": "server",
                    "dataKeyValueType": "booleanSwitch",
                    "required": false,
                    "isEditable": "editable",
                    "slideToggleLabelPosition": "before",
                    "useCustomIcon": true,
                    "customIcon": "data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTIxIDYuOTk5ODRMOSAxOC45OTk4TDMuNSAxMy40OTk4TDQuOTEgMTIuMDg5OEw5IDE2LjE2OThMMTkuNTkgNS41ODk4NEwyMSA2Ljk5OTg0WiIgZmlsbD0iYmxhY2siIGZpbGwtb3BhY2l0eT0iMC44NyIvPgo8cGF0aCBkPSJNOC42NDY4OCAxNi41MjM4TDkuMDAwMjcgMTYuODc2NEw5LjM1MzM5IDE2LjUyMzZMMTkuNTg5OCA2LjI5Njc4TDIwLjI5MjkgNi45OTk4NEw5IDE4LjI5MjdMNC4yMDcxMSAxMy40OTk4TDQuOTEwNDMgMTIuNzk2NUw4LjY0Njg4IDE2LjUyMzhaIiBzdHJva2U9ImJsYWNrIiBzdHJva2Utb3BhY2l0eT0iMC44NyIvPgo8L3N2Zz4K",
                    "useGetValueFunction": true,
                    "getValueFunctionBody": "return !value || value === 'noAlarms';",
                    "useSetValueFunction": true,
                    "setValueFunctionBody": "return value ? 'noAlarms' : 'unset';"
                  },
                  "_hash": 0.05083578452347459,
                  "aggregationType": null,
                  "units": null,
                  "decimals": null,
                  "funcBody": null,
                  "usePostProcessing": null,
                  "postFuncBody": null
                },
                {
                  "name": "lowRemaningLevel",
                  "type": "attribute",
                  "label": "Low remaning level",
                  "color": "#2196f3",
                  "settings": {
                    "dataKeyHidden": false,
                    "dataKeyType": "server",
                    "dataKeyValueType": "booleanSwitch",
                    "required": false,
                    "isEditable": "editable",
                    "slideToggleLabelPosition": "before",
                    "useCustomIcon": true,
                    "customIcon": "data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjQiIGhlaWdodD0iMjUiIHZpZXdCb3g9IjAgMCAyNCAyNSIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTEwIDE4LjVDOC4zNCAxOC41IDcgMTcuMTYgNyAxNS41QzcgMTMuNSAxMCAxMC4xMyAxMCAxMC4xM0MxMCAxMC4xMyAxMyAxMy41IDEzIDE1LjVDMTMgMTcuMTYgMTEuNjYgMTguNSAxMCAxOC41Wk0xNSA0LjVWMjAuNUg1VjQuNUgzVjIwLjVDMyAyMS42MSAzLjg5IDIyLjUgNSAyMi41SDE1QzE2LjExIDIyLjUgMTcgMjEuNjEgMTcgMjAuNVY0LjVIMTVaIiBmaWxsPSJibGFjayIgZmlsbC1vcGFjaXR5PSIwLjg3Ii8+CjxwYXRoIGQ9Ik0xNSAyMUgxNS41VjIwLjVWNUgxNi41VjIwLjVDMTYuNSAyMS4zMzM5IDE1LjgzMzkgMjIgMTUgMjJINUM0LjE2NjE0IDIyIDMuNSAyMS4zMzM5IDMuNSAyMC41VjVINC41VjIwLjVWMjFINUgxNVpNMTAgMThDOC42MTYxNCAxOCA3LjUgMTYuODgzOSA3LjUgMTUuNUM3LjUgMTUuMTA5OSA3LjY1MDg2IDE0LjYwNCA3LjkyMTA5IDE0LjAzMDJDOC4xODY2OSAxMy40NjYzIDguNTQ1NjUgMTIuODgxOSA4LjkxMjIxIDEyLjM0OEM5LjI3NzY4IDExLjgxNTYgOS42NDQxOCAxMS4zNDI3IDkuOTE5NzcgMTEuMDAyNUM5Ljk0NzQ4IDEwLjk2ODMgOS45NzQyNiAxMC45MzU1IDEwIDEwLjkwNDFDMTAuMDI1NyAxMC45MzU1IDEwLjA1MjUgMTAuOTY4MyAxMC4wODAyIDExLjAwMjVDMTAuMzU1OCAxMS4zNDI3IDEwLjcyMjMgMTEuODE1NiAxMS4wODc4IDEyLjM0OEMxMS40NTQ0IDEyLjg4MTkgMTEuODEzMyAxMy40NjYzIDEyLjA3ODkgMTQuMDMwMkMxMi4zNDkxIDE0LjYwNCAxMi41IDE1LjEwOTkgMTIuNSAxNS41QzEyLjUgMTYuODgzOSAxMS4zODM5IDE4IDEwIDE4WiIgc3Ryb2tlPSJibGFjayIgc3Ryb2tlLW9wYWNpdHk9IjAuODciLz4KPHJlY3QgeD0iMjAiIHk9IjguNSIgd2lkdGg9IjIiIGhlaWdodD0iNiIgZmlsbD0iYmxhY2siIGZpbGwtb3BhY2l0eT0iMC44NyIvPgo8cmVjdCB4PSIyMCIgeT0iMTYuNSIgd2lkdGg9IjIiIGhlaWdodD0iMiIgZmlsbD0iYmxhY2siIGZpbGwtb3BhY2l0eT0iMC44NyIvPgo8L3N2Zz4K",
                    "useGetValueFunction": true,
                    "getValueFunctionBody": "return !value || value === 'lowFuel';",
                    "useSetValueFunction": true,
                    "setValueFunctionBody": "return value ? 'lowFuel' : 'unset';"
                  },
                  "_hash": 0.5184545311042434,
                  "units": null,
                  "decimals": null,
                  "funcBody": null,
                  "usePostProcessing": null,
                  "postFuncBody": null,
                  "aggregationType": null
                },
                {
                  "name": "lowBattery",
                  "type": "attribute",
                  "label": "Low battery",
                  "color": "#f44336",
                  "settings": {
                    "dataKeyHidden": false,
                    "dataKeyType": "server",
                    "dataKeyValueType": "booleanSwitch",
                    "required": false,
                    "isEditable": "editable",
                    "slideToggleLabelPosition": "before",
                    "useCustomIcon": true,
                    "customIcon": "data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPG1hc2sgaWQ9InBhdGgtMS1pbnNpZGUtMV80NDVfMzAwNTQiIGZpbGw9IndoaXRlIj4KPHBhdGggZD0iTTExLjUyMzggMjBIMy45MDQ3NlY2SDExLjUyMzhNMTIuMTYxOSA0SDEwLjU3MTRWMkg0Ljg1NzE0VjRIMy4yNjY2N0MyLjU3MTQzIDQgMiA0LjYgMiA1LjMzVjIwLjY3QzIgMjEuNCAyLjU3MTQzIDIyIDMuMjY2NjcgMjJIMTIuMTYxOUMxMi44NjY3IDIyIDEzLjQyODYgMjEuNDEgMTMuNDI4NiAyMC42N1Y1LjMzQzEzLjQyODYgNC42IDEyLjg1NzEgNCAxMi4xNjE5IDRaTTEwLjU3MTQgMTZINC44NTcxNFYxOUgxMC41NzE0VjE2Wk0yMiAxMEgxOS4xNDI5VjNMMTQuMzgxIDEzSDE3LjIzODFWMjEiLz4KPC9tYXNrPgo8cGF0aCBkPSJNMTEuNTIzOCAyMEgzLjkwNDc2VjZIMTEuNTIzOE0xMi4xNjE5IDRIMTAuNTcxNFYySDQuODU3MTRWNEgzLjI2NjY3QzIuNTcxNDMgNCAyIDQuNiAyIDUuMzNWMjAuNjdDMiAyMS40IDIuNTcxNDMgMjIgMy4yNjY2NyAyMkgxMi4xNjE5QzEyLjg2NjcgMjIgMTMuNDI4NiAyMS40MSAxMy40Mjg2IDIwLjY3VjUuMzNDMTMuNDI4NiA0LjYgMTIuODU3MSA0IDEyLjE2MTkgNFpNMTAuNTcxNCAxNkg0Ljg1NzE0VjE5SDEwLjU3MTRWMTZaTTIyIDEwSDE5LjE0MjlWM0wxNC4zODEgMTNIMTcuMjM4MVYyMSIgZmlsbD0iYmxhY2siIGZpbGwtb3BhY2l0eT0iMC44NyIvPgo8cGF0aCBkPSJNMy45MDQ3NiAyMEgyLjkwNDc2VjIxSDMuOTA0NzZWMjBaTTMuOTA0NzYgNlY1SDIuOTA0NzZWNkgzLjkwNDc2Wk0xMC41NzE0IDRIOS41NzE0M1Y1SDEwLjU3MTRWNFpNMTAuNTcxNCAySDExLjU3MTRWMUgxMC41NzE0VjJaTTQuODU3MTQgMlYxSDMuODU3MTRWMkg0Ljg1NzE0Wk00Ljg1NzE0IDRWNUg1Ljg1NzE0VjRINC44NTcxNFpNMTAuNTcxNCAxNkgxMS41NzE0VjE1SDEwLjU3MTRWMTZaTTQuODU3MTQgMTZWMTVIMy44NTcxNFYxNkg0Ljg1NzE0Wk00Ljg1NzE0IDE5SDMuODU3MTRWMjBINC44NTcxNFYxOVpNMTAuNTcxNCAxOVYyMEgxMS41NzE0VjE5SDEwLjU3MTRaTTE5LjE0MjkgMTBIMTguMTQyOVYxMUgxOS4xNDI5VjEwWk0xOS4xNDI5IDNIMjAuMTQyOUwxOC4yNCAyLjU3MDA3TDE5LjE0MjkgM1pNMTQuMzgxIDEzTDEzLjQ3ODEgMTIuNTcwMUwxMi43OTcyIDE0SDE0LjM4MVYxM1pNMTcuMjM4MSAxM0gxOC4yMzgxVjEySDE3LjIzODFWMTNaTTExLjUyMzggMTlIMy45MDQ3NlYyMUgxMS41MjM4VjE5Wk00LjkwNDc2IDIwVjZIMi45MDQ3NlYyMEg0LjkwNDc2Wk0zLjkwNDc2IDdIMTEuNTIzOFY1SDMuOTA0NzZWN1pNMTIuMTYxOSAzSDEwLjU3MTRWNUgxMi4xNjE5VjNaTTExLjU3MTQgNFYySDkuNTcxNDNWNEgxMS41NzE0Wk0xMC41NzE0IDFINC44NTcxNFYzSDEwLjU3MTRWMVpNMy44NTcxNCAyVjRINS44NTcxNFYySDMuODU3MTRaTTQuODU3MTQgM0gzLjI2NjY3VjVINC44NTcxNFYzWk0zLjI2NjY3IDNDMS45NzM3MyAzIDEgNC4wOTQyNSAxIDUuMzNIM0MzIDUuMTA1NzUgMy4xNjkxMyA1IDMuMjY2NjcgNVYzWk0xIDUuMzNWMjAuNjdIM1Y1LjMzSDFaTTEgMjAuNjdDMSAyMS45MDU3IDEuOTczNzMgMjMgMy4yNjY2NyAyM1YyMUMzLjE2OTEzIDIxIDMgMjAuODk0MyAzIDIwLjY3SDFaTTMuMjY2NjcgMjNIMTIuMTYxOVYyMUgzLjI2NjY3VjIzWk0xMi4xNjE5IDIzQzEzLjQ2NDQgMjMgMTQuNDI4NiAyMS45MTU3IDE0LjQyODYgMjAuNjdIMTIuNDI4NkMxMi40Mjg2IDIwLjkwNDMgMTIuMjY5IDIxIDEyLjE2MTkgMjFWMjNaTTE0LjQyODYgMjAuNjdWNS4zM0gxMi40Mjg2VjIwLjY3SDE0LjQyODZaTTE0LjQyODYgNS4zM0MxNC40Mjg2IDQuMDk0MjUgMTMuNDU0OCAzIDEyLjE2MTkgM1Y1QzEyLjI1OTQgNSAxMi40Mjg2IDUuMTA1NzUgMTIuNDI4NiA1LjMzSDE0LjQyODZaTTEwLjU3MTQgMTVINC44NTcxNFYxN0gxMC41NzE0VjE1Wk0zLjg1NzE0IDE2VjE5SDUuODU3MTRWMTZIMy44NTcxNFpNNC44NTcxNCAyMEgxMC41NzE0VjE4SDQuODU3MTRWMjBaTTExLjU3MTQgMTlWMTZIOS41NzE0M1YxOUgxMS41NzE0Wk0yMiA5SDE5LjE0MjlWMTFIMjJWOVpNMjAuMTQyOSAxMFYzSDE4LjE0MjlWMTBIMjAuMTQyOVpNMTguMjQgMi41NzAwN0wxMy40NzgxIDEyLjU3MDFMMTUuMjgzOCAxMy40Mjk5TDIwLjA0NTcgMy40Mjk5M0wxOC4yNCAyLjU3MDA3Wk0xNC4zODEgMTRIMTcuMjM4MVYxMkgxNC4zODFWMTRaTTE2LjIzODEgMTNWMjFIMTguMjM4MVYxM0gxNi4yMzgxWiIgZmlsbD0iYmxhY2siIGZpbGwtb3BhY2l0eT0iMC44NyIgbWFzaz0idXJsKCNwYXRoLTEtaW5zaWRlLTFfNDQ1XzMwMDU0KSIvPgo8L3N2Zz4K",
                    "useGetValueFunction": true,
                    "getValueFunctionBody": "return !value || value === 'lowBattery';",
                    "useSetValueFunction": true,
                    "setValueFunctionBody": "return value ? 'lowBattery' : 'unset';"
                  },
                  "_hash": 0.39082762251115444,
                  "units": null,
                  "decimals": null,
                  "funcBody": null,
                  "usePostProcessing": null,
                  "postFuncBody": null,
                  "aggregationType": null
                }
              ]
            }
          ],
          "timewindow": {
            "displayValue": "",
            "selectedTab": 0,
            "realtime": {
              "realtimeType": 1,
              "interval": 1000,
              "timewindowMs": 60000,
              "quickInterval": "CURRENT_DAY"
            },
            "history": {
              "historyType": 0,
              "interval": 1000,
              "timewindowMs": 60000,
              "fixedTimewindow": {
                "startTimeMs": 1682001930247,
                "endTimeMs": 1682088330247
              },
              "quickInterval": "CURRENT_DAY"
            },
            "aggregation": {
              "type": "AVG",
              "limit": 25000
            }
          },
          "showTitle": false,
          "backgroundColor": "rgba(0,0,0,0.04)",
          "color": "rgba(0, 0, 0, 0.87)",
          "padding": "0px",
          "settings": {
            "showResultMessage": false,
            "showActionButtons": false,
            "showGroupTitle": false,
            "fieldsAlignment": "column",
            "groupTitle": "${entityName}",
            "fieldsInRow": 2
          },
          "title": "Filter",
          "dropShadow": false,
          "enableFullscreen": false,
          "enableDataExport": false,
          "widgetStyle": {
            "fontWeight": "bold",
            "fontSize": "14px"
          },
          "titleStyle": {
            "fontSize": "20px",
            "fontWeight": "bold",
            "paddingBottom": "30px"
          },
          "useDashboardTimewindow": true,
          "showLegend": false,
          "actions": {},
          "showTitleIcon": false,
          "titleTooltip": "",
          "noDataDisplayMessage": "",
          "widgetCss": "",
          "pageSize": 1024
        },
        "row": 0,
        "col": 0,
        "id": "50496c24-028d-33f9-2a34-60b9b5b467ce"
      },
      "374e55b3-38a3-0a7c-7a1f-701959ed0ca9": {
        "isSystemType": true,
        "bundleAlias": "input_widgets",
        "typeAlias": "update_multiple_attributes",
        "type": "latest",
        "title": "New widget",
        "image": null,
        "description": null,
        "sizeX": 7.5,
        "sizeY": 3,
        "config": {
          "datasources": [
            {
              "type": "entity",
              "name": null,
              "entityAliasId": "cd74427b-6a97-ced1-262d-b0fe26af2ae8",
              "filterId": null,
              "dataKeys": [
                {
                  "name": "lowTemperature",
                  "type": "attribute",
                  "label": "Low temperature",
                  "color": "#4caf50",
                  "settings": {
                    "dataKeyHidden": false,
                    "dataKeyType": "server",
                    "dataKeyValueType": "booleanSwitch",
                    "required": false,
                    "isEditable": "editable",
                    "slideToggleLabelPosition": "before",
                    "useCustomIcon": true,
                    "customIcon": "data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjUiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNSAyNCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTE3LjUgN1YxM0gxOS41VjdIMTcuNVoiIGZpbGw9ImJsYWNrIiBmaWxsLW9wYWNpdHk9IjAuODciLz4KPHBhdGggZD0iTTE3LjUgMTVWMTdIMTkuNVYxNUgxNy41WiIgZmlsbD0iYmxhY2siIGZpbGwtb3BhY2l0eT0iMC44NyIvPgo8cGF0aCBkPSJNMTkgMTIuNUgxOFY3LjVIMTlWMTIuNVpNMTkgMTYuNUgxOFYxNS41SDE5VjE2LjVaIiBzdHJva2U9ImJsYWNrIiBzdHJva2Utb3BhY2l0eT0iMC44NyIvPgo8cGF0aCBkPSJNMTMuNSAxM1Y1QzEzLjUgNC4yMDQzNSAxMy4xODM5IDMuNDQxMjkgMTIuNjIxMyAyLjg3ODY4QzEyLjA1ODcgMi4zMTYwNyAxMS4yOTU2IDIgMTAuNSAyQzkuNzA0MzUgMiA4Ljk0MTI5IDIuMzE2MDcgOC4zNzg2OCAyLjg3ODY4QzcuODE2MDcgMy40NDEyOSA3LjUgNC4yMDQzNSA3LjUgNVYxM0M2LjY2MDQ3IDEzLjYyOTYgNi4wNDAzMyAxNC41MDc1IDUuNzI3NDMgMTUuNTA5MkM1LjQxNDUzIDE2LjUxMDggNS40MjQ3MyAxNy41ODU2IDUuNzU2NTggMTguNTgxMUM2LjA4ODQ0IDE5LjU3NjcgNi43MjUxMiAyMC40NDI2IDcuNTc2NDUgMjEuMDU2MkM4LjQyNzc4IDIxLjY2OTggOS40NTA1OSAyMiAxMC41IDIyQzExLjU0OTQgMjIgMTIuNTcyMiAyMS42Njk4IDEzLjQyMzYgMjEuMDU2MkMxNC4yNzQ5IDIwLjQ0MjYgMTQuOTExNiAxOS41NzY3IDE1LjI0MzQgMTguNTgxMUMxNS41NzUzIDE3LjU4NTYgMTUuNTg1NSAxNi41MTA4IDE1LjI3MjYgMTUuNTA5MkMxNC45NTk3IDE0LjUwNzUgMTQuMzM5NSAxMy42Mjk2IDEzLjUgMTNaTTEwLjUgNEMxMC43NjUyIDQgMTEuMDE5NiA0LjEwNTM2IDExLjIwNzEgNC4yOTI4OUMxMS4zOTQ2IDQuNDgwNDMgMTEuNSA0LjczNDc4IDExLjUgNVYxMkg5LjVWNUM5LjUgNC43MzQ3OCA5LjYwNTM2IDQuNDgwNDMgOS43OTI4OSA0LjI5Mjg5QzkuOTgwNDMgNC4xMDUzNiAxMC4yMzQ4IDQgMTAuNSA0WiIgZmlsbD0iYmxhY2siIGZpbGwtb3BhY2l0eT0iMC44NyIvPgo8L3N2Zz4K",
                    "useGetValueFunction": true,
                    "getValueFunctionBody": "return !value || value === 'lowTemperature';",
                    "useSetValueFunction": true,
                    "setValueFunctionBody": "return value ? 'lowTemperature' : 'unset';"
                  },
                  "_hash": 0.34454051580229117,
                  "units": null,
                  "decimals": null,
                  "funcBody": null,
                  "usePostProcessing": null,
                  "postFuncBody": null,
                  "aggregationType": null
                },
                {
                  "name": "highTemperature",
                  "type": "attribute",
                  "label": "High temperature",
                  "color": "#ffc107",
                  "settings": {
                    "dataKeyHidden": false,
                    "dataKeyType": "server",
                    "dataKeyValueType": "booleanSwitch",
                    "required": false,
                    "isEditable": "editable",
                    "slideToggleLabelPosition": "before",
                    "useCustomIcon": true,
                    "customIcon": "data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjUiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNSAyNCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTE3LjUwMDUgMTNWN0gxOS41MDA1VjEzSDE3LjUwMDVaTTE3LjUwMDUgMTdWMTVIMTkuNTAwNVYxN0gxNy41MDA1Wk0xMy41MDA1IDEzVjVDMTMuNTAwNSAzLjMgMTIuMjAwNSAyIDEwLjUwMDUgMkM4LjgwMDUyIDIgNy41MDA1MiAzLjMgNy41MDA1MiA1VjEzQzUuMzAwNTIgMTQuNyA0LjgwMDUzIDE3LjggNi41MDA1MyAyMEM4LjIwMDUzIDIyLjIgMTEuMzAwNSAyMi43IDEzLjUwMDUgMjFDMTUuNzAwNSAxOS4zIDE2LjIwMDUgMTYuMiAxNC41MDA1IDE0QzE0LjIwMDUgMTMuNiAxMy45MDA1IDEzLjMgMTMuNTAwNSAxM1pNMTAuNTAwNSA0QzExLjEwMDUgNCAxMS41MDA1IDQuNCAxMS41MDA1IDVWOEg5LjUwMDUyVjVDOS41MDA1MiA0LjQgOS45MDA1MyA0IDEwLjUwMDUgNFoiIGZpbGw9ImJsYWNrIiBmaWxsLW9wYWNpdHk9IjAuODciLz4KPHBhdGggZD0iTTEzLjAwMDUgMTNWMTMuMjVMMTMuMjAwNSAxMy40QzEzLjU2MjYgMTMuNjcxNiAxMy44MjkgMTMuOTM3OSAxNC4xMDA1IDE0LjNMMTQuMTAwNSAxNC4zTDE0LjEwNDkgMTQuMzA1N0MxNS42MjQ3IDE2LjI3MjUgMTUuMTkxMyAxOS4wNjE2IDEzLjE5NDggMjAuNjA0NEMxMS4yMjggMjIuMTI0MSA4LjQzODkyIDIxLjY5MDggNi44OTYxNyAxOS42OTQzQzUuMzc2MzkgMTcuNzI3NSA1LjgwOTc0IDE0LjkzODQgNy44MDYyNSAxMy4zOTU2TDguMDAwNTIgMTMuMjQ1NVYxM1Y1QzguMDAwNTIgMy41NzYxNCA5LjA3NjY3IDIuNSAxMC41MDA1IDIuNUMxMS45MjQ0IDIuNSAxMy4wMDA1IDMuNTc2MTQgMTMuMDAwNSA1VjEzWk0xMS41MDA1IDguNUgxMi4wMDA1VjhWNUMxMi4wMDA1IDQuNTg2MzggMTEuODYwNSA0LjIwMjg0IDExLjU3OTEgMy45MjE0NUMxMS4yOTc3IDMuNjQwMDYgMTAuOTE0MSAzLjUgMTAuNTAwNSAzLjVDMTAuMDg2OSAzLjUgOS43MDMzNiAzLjY0MDA2IDkuNDIxOTcgMy45MjE0NUM5LjE0MDU4IDQuMjAyODQgOS4wMDA1MiA0LjU4NjM4IDkuMDAwNTIgNVY4VjguNUg5LjUwMDUySDExLjUwMDVaTTE4LjAwMDUgMTIuNVY3LjVIMTkuMDAwNVYxMi41SDE4LjAwMDVaTTE4LjAwMDUgMTYuNVYxNS41SDE5LjAwMDVWMTYuNUgxOC4wMDA1WiIgc3Ryb2tlPSJibGFjayIgc3Ryb2tlLW9wYWNpdHk9IjAuODciLz4KPC9zdmc+Cg==",
                    "useGetValueFunction": true,
                    "getValueFunctionBody": "return !value || value === 'highTemperature';",
                    "useSetValueFunction": true,
                    "setValueFunctionBody": "return value ? 'highTemperature' : 'unset';"
                  },
                  "_hash": 0.49298504090043105,
                  "units": null,
                  "decimals": null,
                  "funcBody": null,
                  "usePostProcessing": null,
                  "postFuncBody": null,
                  "aggregationType": null
                },
                {
                  "name": "offline",
                  "type": "attribute",
                  "label": "Offline",
                  "color": "#9c27b0",
                  "settings": {
                    "dataKeyHidden": false,
                    "dataKeyType": "server",
                    "dataKeyValueType": "booleanSwitch",
                    "required": false,
                    "isEditable": "editable",
                    "slideToggleLabelPosition": "before",
                    "useCustomIcon": true,
                    "customIcon": "data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjUiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNSAyNCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPGcgY2xpcC1wYXRoPSJ1cmwoI2NsaXAwXzQ0NV8yOTk5OCkiPgo8cGF0aCBkPSJNOC44MjE5OSA0LjcwNzExQzguNzQ2MjQgMy45OTc0OSA4Ljg0NzE5IDMuMjg4MDYgOS4xMjUwMiAyLjY1NzIzQzYuMDk0MjkgMy4zMTQyNCAzLjE4OTc1IDQuODY0NzUgMC44NDA4OTUgNy4zMDg5NEMwLjM4NjM2OCA3Ljc4MTkgMC4zODYzNjggOC40OTE1MiAwLjg0MDg5NSA4LjkzODI5QzEuMDQyOTcgOS4xNzQ3OCAxLjMyMDgxIDkuMjggMS42MjM4IDkuMjhDMS45MjY3OSA5LjI4IDIuMjA0NjUgOS4xNzQ5NSAyLjQwNjcxIDguOTM4MjlDNC4yNTAzOCA3LjAxOTg1IDYuNDk4MjEgNS43MzIwNiA4Ljg3MjM2IDUuMTAxMjNMOC44MjE5OSA0LjcwNzExWiIgZmlsbD0iYmxhY2siIGZpbGwtb3BhY2l0eT0iMC44NyIvPgo8cGF0aCBkPSJNOC4xNDQ1NCA0LjYxN0M1Ljg1OTkzIDUuMzI0NTggMy43MTA1IDYuNjE5NTEgMS45MjYwMyA4LjQ3NjM1TDEuOTEyNDMgOC40OTA1TDEuODk5NjkgOC41MDU0MkMxLjg0NDc4IDguNTY5NzMgMS43NjU2NCA4LjYxMzMzIDEuNjIzOCA4LjYxMzMzQzEuNDgyMjQgOC42MTMzMyAxLjQwMjg2IDguNTY5NzMgMS4zNDc3MyA4LjUwNTJMMS4zMjg5IDguNDgzMTdMMS4zMDgyMyA4LjQ2Mjg1QzEuMTI2NzkgOC4yODQ1MSAxLjEwNzcyIDcuOTkzNDEgMS4zMjE1NyA3Ljc3MDg5TDEuMzIxNTggNy43NzA4OEMzLjI5Mjk0IDUuNzE5NSA1LjY2OTc0IDQuMzI1NzggOC4xNzY4NiAzLjU4Njk4QzguMTI5NDcgMy45MjY0MiA4LjExODk3IDQuMjcyMDcgOC4xNDQ1NCA0LjYxN1oiIHN0cm9rZT0iYmxhY2siIHN0cm9rZS1vcGFjaXR5PSIwLjg3IiBzdHJva2Utd2lkdGg9IjEuMzMzMzMiLz4KPHBhdGggZD0iTTI0LjE3ODcgNy4zMzUzMUMyMS44Mjk5IDQuODkxMzEgMTguOTI1MyAzLjM0MDYxIDE1Ljg5NDUgMi42ODM1OUMxNi4xNzI0IDMuMzE0MzggMTYuMjczMyA0LjAyMzg2IDE2LjE5NzYgNC43MzM0OEwxNi4xNDcgNS4xMjc2MkMxOC41MjExIDUuNzg0NjMgMjAuNzY4OSA3LjA3MjQzIDIyLjYxMjYgOC45NjQ2OEMyMy4wNDIgOS40MTE0MiAyMy43NDkxIDkuNDExNDIgMjQuMTc4NSA4Ljk2NDY4QzI0LjYwOCA4LjQ5MTcyIDI0LjYwOCA3Ljc4MjEgMjQuMTc4NyA3LjMzNTMzTDI0LjE3ODcgNy4zMzUzMVoiIGZpbGw9ImJsYWNrIiBmaWxsLW9wYWNpdHk9IjAuODciLz4KPHBhdGggZD0iTTkuMjAxNTkgNy44ODY3MkM3LjM4MzEyIDguNDM4NzEgNS43MTYxNSA5LjQ2MzY1IDQuMzAxODMgMTAuOTM1M0MzLjg0NzMxIDExLjQwODMgMy44NDczMSAxMi4xMTc5IDQuMzAxODMgMTIuNTY0N0M0LjUwMzkxIDEyLjgwMTIgNC43ODE3NSAxMi45MDY0IDUuMDg0NzQgMTIuOTA2NEM1LjM2MjU3IDEyLjkwNjQgNS42NjU1OSAxMi44MDEzIDUuODY3NjQgMTIuNTY0N0M2LjkyODQyIDExLjQ4NzEgOC4xNjYwMyAxMC42NzI1IDkuNTA0NjIgMTAuMjI1N0w5LjIwMTU5IDcuODg2NzJaIiBmaWxsPSJibGFjayIgZmlsbC1vcGFjaXR5PSIwLjg3Ii8+CjxwYXRoIGQ9Ik0xNS44MTg4IDcuODg2NzJMMTUuNTQxIDEwLjIyNTlDMTYuODc5NiAxMC42OTg4IDE4LjExNzIgMTEuNDYxMSAxOS4xNTI2IDEyLjU2NDlDMTkuNjA3MSAxMy4wMTE2IDIwLjI4OTEgMTMuMDExNiAyMC43MTg1IDEyLjU2NDlDMjEuMTczIDEyLjA5MTkgMjEuMTczIDExLjM4MjMgMjAuNzE4NSAxMC45MzU1QzE5LjMwNDMgOS40NjM2NSAxNy42MzczIDguNDM4NzEgMTUuODE4NyA3Ljg4NjcySDE1LjgxODhaIiBmaWxsPSJibGFjayIgZmlsbC1vcGFjaXR5PSIwLjg3Ii8+CjxwYXRoIGQ9Ik03Ljc2MTQ2IDE0LjUzNjNDNy4zMzIxMiAxNC45ODMxIDcuMzMyMTIgMTUuNzE4OSA3Ljc2MTQ2IDE2LjE2NTdDNy45ODg3MiAxNi40MDIxIDguMjY2NTQgMTYuNTA3NCA4LjU0NDM2IDE2LjUwNzRDOC44MjIxOCAxNi41MDc0IDkuMTI1MjIgMTYuNDAyMyA5LjMyNzI3IDE2LjE2NTdDOS41Nzk5IDE1LjkwMjggOS44NTc3NCAxNS42OTI3IDEwLjEzNTYgMTUuNTA4Nkw5LjgzMjU0IDEzLjA2NDVDOS4wNDk2NCAxMy40MDYyIDguMzY3NjcgMTMuOTA1NSA3Ljc2MTQyIDE0LjUzNjNINy43NjE0NloiIGZpbGw9ImJsYWNrIiBmaWxsLW9wYWNpdHk9IjAuODciLz4KPHBhdGggZD0iTTE1LjE4NTggMTMuMDY0NUwxNC44ODI4IDE1LjUwODVDMTUuMTYwNiAxNS42OTI1IDE1LjQzODUgMTUuOTI5IDE1LjY2NTcgMTYuMTY1NUMxNi4xMjAyIDE2LjYxMjIgMTYuODAyMiAxNi42MTIyIDE3LjIzMTYgMTYuMTY1NUMxNy42ODYxIDE1LjY5MjUgMTcuNjg2MSAxNC45ODI5IDE3LjIzMTYgMTQuNTM2MUMxNi42NTA3IDEzLjkwNTUgMTUuOTY4OCAxMy40MDYxIDE1LjE4NTggMTMuMDY0NUgxNS4xODU4WiIgZmlsbD0iYmxhY2siIGZpbGwtb3BhY2l0eT0iMC44NyIvPgo8cGF0aCBkPSJNMTEuNzc3IDE2LjAwNzVDMTIuMDA0MyAxNS45Mjg3IDEyLjI1NjkgMTUuOTI4NyAxMi40ODQyIDE1LjkyODdDMTIuNzM2OCAxNS45Mjg3IDEyLjk4OTMgMTUuOTU0OSAxMy4yNDE5IDE2LjAwNzVMMTQuNjA1NyA0LjQ5NjYyQzE0LjYzMDkgNC4zOTE1OCAxNC42MzA5IDQuMzEyNTcgMTQuNjMwOSA0LjIwNzUyQzE0LjYzMDkgMy4wMjQ5NCAxMy42OTY0IDIgMTIuNTA5NCAyQzExLjI0NjYgMiAxMC4yNjE2IDMuMTgyNTggMTAuMzg3OSA0LjQ3MDQyTDExLjc3NyAxNi4wMDc1WiIgZmlsbD0iYmxhY2siIGZpbGwtb3BhY2l0eT0iMC44NyIvPgo8cGF0aCBkPSJNMTIuNTEwMiAxNy41NTg2QzExLjM0ODMgMTcuNTU4NiAxMC4zODg3IDE4LjU1NzMgMTAuMzg4NyAxOS43NjYxQzEwLjM4ODcgMjEuMDAxMyAxMS4zNDg1IDIyLjAwMDEgMTIuNTEwMiAyMi4wMDAxQzEzLjY5NzIgMjIuMDAwMSAxNC42NTcxIDIxLjAwMTQgMTQuNjU3MSAxOS43NjYxQzE0LjY1NzEgMTguNTU3MyAxMy42OTczIDE3LjU1ODYgMTIuNTEwMiAxNy41NTg2WiIgZmlsbD0iYmxhY2siIGZpbGwtb3BhY2l0eT0iMC44NyIvPgo8L2c+CjxkZWZzPgo8Y2xpcFBhdGggaWQ9ImNsaXAwXzQ0NV8yOTk5OCI+CjxyZWN0IHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgZmlsbD0id2hpdGUiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDAuNSkiLz4KPC9jbGlwUGF0aD4KPC9kZWZzPgo8L3N2Zz4K",
                    "useGetValueFunction": true,
                    "getValueFunctionBody": "return !value || value === 'offline';",
                    "useSetValueFunction": true,
                    "setValueFunctionBody": "return value ? 'offline' : 'unset';"
                  },
                  "_hash": 0.7203498706691758,
                  "units": null,
                  "decimals": null,
                  "funcBody": null,
                  "usePostProcessing": null,
                  "postFuncBody": null,
                  "aggregationType": null
                }
              ]
            }
          ],
          "timewindow": {
            "displayValue": "",
            "selectedTab": 0,
            "realtime": {
              "realtimeType": 1,
              "interval": 1000,
              "timewindowMs": 60000,
              "quickInterval": "CURRENT_DAY"
            },
            "history": {
              "historyType": 0,
              "interval": 1000,
              "timewindowMs": 60000,
              "fixedTimewindow": {
                "startTimeMs": 1682001930247,
                "endTimeMs": 1682088330247
              },
              "quickInterval": "CURRENT_DAY"
            },
            "aggregation": {
              "type": "AVG",
              "limit": 25000
            }
          },
          "showTitle": false,
          "backgroundColor": "rgba(0,0,0,0.04)",
          "color": "rgba(0, 0, 0, 0.87)",
          "padding": "0px",
          "settings": {
            "showResultMessage": false,
            "showActionButtons": false,
            "showGroupTitle": false,
            "fieldsAlignment": "column",
            "groupTitle": "${entityName}",
            "fieldsInRow": 2
          },
          "title": "Filter",
          "dropShadow": false,
          "enableFullscreen": false,
          "enableDataExport": false,
          "widgetStyle": {
            "fontWeight": "bold",
            "fontSize": "14px"
          },
          "titleStyle": {
            "fontSize": "20px",
            "fontWeight": "bold",
            "paddingBottom": "30px"
          },
          "useDashboardTimewindow": true,
          "showLegend": false,
          "actions": {},
          "showTitleIcon": false,
          "titleTooltip": "",
          "noDataDisplayMessage": "",
          "widgetCss": "",
          "pageSize": 1024
        },
        "row": 0,
        "col": 0,
        "id": "374e55b3-38a3-0a7c-7a1f-701959ed0ca9"
      },
      "b89177ac-8f67-3ae5-dfc8-945d995ced41": {
        "isSystemType": true,
        "bundleAlias": "cards",
        "typeAlias": "markdown_card",
        "type": "latest",
        "title": "New widget",
        "image": null,
        "description": null,
        "sizeX": 5,
        "sizeY": 3.5,
        "config": {
          "datasources": [
            {
              "type": "entity",
              "name": null,
              "entityAliasId": "6d74f33d-0025-fbc5-06b7-996534fa99c7",
              "filterId": null,
              "dataKeys": [
                {
                  "name": "name",
                  "type": "entityField",
                  "label": "Serial number",
                  "color": "#2196f3",
                  "settings": {},
                  "_hash": 0.15249290163595064,
                  "aggregationType": null,
                  "units": null,
                  "decimals": null,
                  "funcBody": null,
                  "usePostProcessing": null,
                  "postFuncBody": null
                },
                {
                  "name": "battery",
                  "type": "timeseries",
                  "label": "battery",
                  "color": "#8bc34a",
                  "settings": {},
                  "_hash": 0.8277424891113301,
                  "aggregationType": "NONE",
                  "units": null,
                  "decimals": null,
                  "funcBody": null,
                  "usePostProcessing": null,
                  "postFuncBody": null
                },
                {
                  "name": "active",
                  "type": "attribute",
                  "label": "active",
                  "color": "#607d8b",
                  "settings": {},
                  "_hash": 0.2831810174397753,
                  "aggregationType": null,
                  "units": null,
                  "decimals": null,
                  "funcBody": null,
                  "usePostProcessing": null,
                  "postFuncBody": null
                },
                {
                  "name": "temperature",
                  "type": "timeseries",
                  "label": "temperature",
                  "color": "#607d8b",
                  "settings": {},
                  "_hash": 0.2508360827654357
                },
                {
                  "name": "liquidType",
                  "type": "attribute",
                  "label": "liquidType",
                  "color": "#8bc34a",
                  "settings": {},
                  "_hash": 0.7675842635641374,
                  "aggregationType": null,
                  "units": null,
                  "decimals": null,
                  "funcBody": null,
                  "usePostProcessing": null,
                  "postFuncBody": null
                },
                {
                  "name": "isLowTemperature",
                  "type": "attribute",
                  "label": "isLowTemperature",
                  "color": "#9c27b0",
                  "settings": {},
                  "_hash": 0.8371618165560808,
                  "aggregationType": null,
                  "units": null,
                  "decimals": null,
                  "funcBody": null,
                  "usePostProcessing": true,
                  "postFuncBody": "return value === \"true\";"
                },
                {
                  "name": "isHighTemperature",
                  "type": "attribute",
                  "label": "isHighTemperature",
                  "color": "#8bc34a",
                  "settings": {},
                  "_hash": 0.620158189429902,
                  "aggregationType": null,
                  "units": null,
                  "decimals": null,
                  "funcBody": null,
                  "usePostProcessing": true,
                  "postFuncBody": "return value === \"true\";"
                },
                {
                  "name": "isLowBattery",
                  "type": "attribute",
                  "label": "isLowBattery",
                  "color": "#3f51b5",
                  "settings": {},
                  "_hash": 0.917408065073618,
                  "aggregationType": null,
                  "units": null,
                  "decimals": null,
                  "funcBody": null,
                  "usePostProcessing": true,
                  "postFuncBody": "return value === \"true\";"
                }
              ]
            }
          ],
          "timewindow": {
            "displayValue": "",
            "selectedTab": 0,
            "realtime": {
              "realtimeType": 1,
              "interval": 1000,
              "timewindowMs": 60000,
              "quickInterval": "CURRENT_DAY"
            },
            "history": {
              "historyType": 0,
              "interval": 1000,
              "timewindowMs": 60000,
              "fixedTimewindow": {
                "startTimeMs": 1682001930247,
                "endTimeMs": 1682088330247
              },
              "quickInterval": "CURRENT_DAY"
            },
            "aggregation": {
              "type": "AVG",
              "limit": 25000
            }
          },
          "showTitle": false,
          "backgroundColor": "#fff",
          "color": "rgba(0, 0, 0, 0.87)",
          "padding": "8px",
          "settings": {
            "useMarkdownTextFunction": true,
            "markdownTextFunction": "let entity, entityName, liquidType, lastUpdate,\n    batteryLevel, temperature, temperatureColor, isTemperatureThreshold, lowBatteryColor,\n    isLowBattery, isActive, sensorStatus, statusColor, statusBgColor, entityLabel;\n    \nif (data.length) {\n    entity = data[0];\n    entityName = entity.entityName;\n    entityLabel = entity.entityLabel;\n    temperature = processValue(entity.temperature, 0) + \"Â°C\";\n    isTemperatureThreshold = entity.isHighTemperature || entity.isLowTemperature;\n    temperatureColor = isTemperatureThreshold ? '#D12730' : '#29313C';                   \n    liquidType = entity.liquidType;\n    batteryLevel = processValue(entity.battery, 0) + '%';\n    isLowBattery = entity.isLowBattery;\n    lowBatteryColor = isLowBattery ? '#D12730' : '#29313C';\n    isActive = entity.active === 'true';\n    sensorStatus = isActive ? 'Online' : 'Offline';\n    statusColor = isActive ? '#3AA94D' : '#C42F37';\n    statusBgColor = isActive ? 'rgba(58, 169, 77, 0.08)' : 'rgba(196, 47, 55, 0.08)';\n    lastUpdate = (entity['battery|ts'] || entity['temperature|ts']) ?\n        moment(Math.max(entity['battery|ts'], entity['temperature|ts'])).format('D MMM YYYY HH:mm') : '-';\n        \n} else {\n    entityName = '-';\n    lastUpdate = '-';\n    batteryLevel = '-';\n    isLowBattery = false;\n    isTemperatureThreshold = false;\n    temperature = '-';\n    liquidType = '-';\n    temperatureColor = '#29313C';\n    lowBatteryColor = '#29313C';\n    isActive = false;\n    sensorStatus = 'Offline';\n    statusColor = '#C42F37';\n    statusBgColor = 'rgba(196, 47, 55, 0.08)';\n}\n\nreturn  '<div class=\"tank-details\" fxLayout=\"column\">' +     \n            '<div class=\"tank-details-header\">' + `Tank ${entityName}` + '</div>' +\n            '<div class=\"tank-details-container\" fxLayout=\"column\">' +\n                // '<div class=\"tank-details-row\" fxFlex  fxLayoutAlign=\"space-between strech\">' +\n                //     '<div class=\"label\">Serial number</div>' +\n                //     '<div class=\"value\">'+ entityName +'</div>' +\n                // '</div>' +\n                '<div class=\"tank-details-row\" fxFlex  fxLayoutAlign=\"space-between strech\">' +\n                    '<div class=\"label\">Liquid type</div>' +\n                    '<div class=\"value\">'+ liquidType +'</div>' +\n                '</div>' +\n                '<div fxFlex class=\"tank-details-row\" fxLayoutAlign=\"space-between strech\">' +\n                    '<div class=\"label\">Tank temperature</div>' +\n                    '<div class=\"value\" style=\"color:'+ temperatureColor +'\">'+ temperature +'</div>' +\n                '</div>' +\n                '<div fxFlex class=\"tank-details-row\" fxLayoutAlign=\"space-between strech\">' +\n                    '<div class=\"label\">Battery level</div>' +\n                    '<div class=\"value\" style=\"color:'+ lowBatteryColor +'\">'+ batteryLevel +'</div>' +\n                '</div>' +\n                '<div fxFlex class=\"tank-details-row\" fxLayoutAlign=\"space-between strech\">' +\n                    '<div class=\"label\">Connection</div>' +\n                    '<div class=\"tank-details-status\" style=\"color:'+ statusColor +';background-color:'+ statusBgColor +'\">' + sensorStatus + \n                    '</div>' +\n                '</div>' +\n                '<div fxFlex class=\"tank-details-row\" fxLayoutAlign=\"space-between strech\">' +\n                    '<div class=\"label\">Last update</div>' +\n                    '<div class=\"value\" style=\"border-bottom:none;\">'+ lastUpdate +'</div>' +\n                '</div>' +\n            '</div>' + \n        '</div>';\n\n\nfunction isNumber(value) {\n    return (typeof value === 'number' && isFinite(value));\n}\n\nfunction processValue(value, dec) {\n    value = parseFloat(value);\n    if (isNumber(value)) {\n        if (isNumber(dec)) {\n            value = parseFloat(value.toFixed(dec));\n        }\n        return value;\n    } else {\n        return '-';\n    }\n}",
            "applyDefaultMarkdownStyle": true,
            "markdownCss": "\n.tank-details {\n    height: 90%;\n    width: 100%;\n    padding: 0;\n    overflow: auto;\n}\n\n.tank-details-container {\n    height: 90%;\n    padding: 0 15px;\n    width: 100%;\n}\n\n.tank-details-header {\n    color: #29313C;\n    padding: 12px 16px;\n    font-weight: 500;\n    line-height: 24px;\n    letter-spacing: 0.25px;\n    border-bottom: 1px solid #454B7414;\n}\n\n.tank-details-container .tank-details-row .label {\n    font-size: 14px;\n    line-height: 16px;\n    letter-spacing: 0.25px;\n    color: #9FA6B4;\n    align-items: center;\n    display: flex;\n}\n\n.tank-details-container .tank-details-row .value {\n    display: flex;\n    align-items: center;\n    font-size: 16px;\n    line-height: 24px;\n    letter-spacing: 0.15px;\n    color: #29313C;\n}\n\n.tank-details-status {\n    display: flex;\n    align-items: center;\n    margin: 15px 0px;\n    width: fit-content;\n    padding: 4px 8px;\n    font-size: 14px;\n    font-weight: 500;\n    line-height: 20px;\n    letter-spacing: 0.25px;\n    border-radius: 8px;\n}"
          },
          "title": "",
          "showTitleIcon": false,
          "iconColor": "rgba(0, 0, 0, 0.87)",
          "iconSize": "24px",
          "titleTooltip": "",
          "dropShadow": false,
          "enableFullscreen": false,
          "widgetStyle": {},
          "titleStyle": {
            "fontSize": "16px",
            "fontWeight": 500,
            "padding": "5px 10px 5px 10px",
            "color": "#29313C",
            "letterSpacing": "0.25px"
          },
          "showLegend": false,
          "useDashboardTimewindow": true,
          "enableDataExport": false,
          "widgetCss": ".tb-markdown-view {\n    padding: 0 !important;\n}",
          "pageSize": 1024,
          "noDataDisplayMessage": "",
          "actions": {
            "headerButton": [
              {
                "name": "Edit tank sensor info",
                "icon": "edit",
                "useShowWidgetActionFunction": null,
                "showWidgetActionFunction": "return true;",
                "type": "customPretty",
                "customHtml": "\n<form #editEntityForm=\"ngForm\" [formGroup]=\"editEntityFormGroup\"\n      (ngSubmit)=\"save()\"  class=\"edit-sensor-form\" style=\"width: 550px;\">\n    <mat-toolbar fxLayout=\"row\" style=\"background-color: transparent; border-bottom: solid 1px #0000001f;\">\n        <h2>Edit sensor {{entityName}}</h2>\n        <span fxFlex></span>\n        <button mat-icon-button (click)=\"cancel()\" type=\"button\">\n            <mat-icon class=\"material-icons\">close</mat-icon>\n        </button>\n    </mat-toolbar>\n    <mat-progress-bar color=\"warn\" mode=\"indeterminate\" *ngIf=\"isLoading$ | async\">\n    </mat-progress-bar>\n    <div style=\"height: 4px;\" *ngIf=\"!(isLoading$ | async)\"></div>\n    <div mat-dialog-content>\n        <mat-stepper [(selectedIndex)]=\"currentStep\" #stepper animationDuration=\"1000\">\n            <mat-step [stepControl]=\"editEntityFormGroup.get('general')\">\n                <ng-template matStepLabel>General Info</ng-template>\n                <div fxFlex fxLayout=\"row\" fxLayoutGap=\"8px\" fxLayout.xs=\"column\"  fxLayoutGap.xs=\"0\" fxLayoutAlign=\"space-between\" style=\"margin: 30px 0 93px;\">\n                    <label class=\"section-label\">General Info</label>\n                    <div style=\"width: 100%; max-width: 345px;\" formGroupName=\"general\" fxLayout=\"column\">\n                        <mat-form-field fxFlex class=\"mat-block\">\n                            <mat-label>Serial number</mat-label>\n                            <input matInput formControlName=\"entityName\" required>\n                            <mat-error *ngIf=\"editEntityFormGroup.get('general').get('entityName').hasError('required')\">\n                                    Serial number is required.\n                            </mat-error>\n                        </mat-form-field>\n                        <mat-form-field fxFlex class=\"mat-block\">\n                            <mat-label>Sensor label</mat-label>\n                            <input matInput formControlName=\"entityLabel\" required>\n                            <mat-error *ngIf=\"editEntityFormGroup.get('general').get('entityLabel').hasError('required')\">\n                                    Sensor label is required.\n                            </mat-error>\n                        </mat-form-field>\n                    </div>\n                </div>\n                <div fxLayout=\"row\" fxLayoutGap=\"8px\" fxLayoutAlign=\"end center\">\n                    <button mat-button color=\"primary\"\n                            type=\"button\"\n                            [disabled]=\"(isLoading$ | async)\"\n                            (click)=\"cancel()\" cdkFocusInitial>\n                        Cancel\n                    </button>\n                    <button mat-button mat-raised-button color=\"primary\" matStepperNext type=\"button\">Next</button>\n                </div>\n            </mat-step>\n            <mat-step [stepControl]=\"editEntityFormGroup.get('details')\">\n                <ng-template matStepLabel>Tank info</ng-template>\n                <div fxFlex fxLayout=\"column\" fxLayoutGap=\"8px\" formGroupName=\"details\" style=\"margin-top: 30px;\">\n                    <div fxFlex fxLayout=\"row\" fxLayoutGap=\"8px\" fxLayout.xs=\"column\"  fxLayoutGap.xs=\"0\" fxLayoutAlign=\"space-between\">\n                        <label class=\"section-label\">Tank Info</label>\n                        <div style=\"width: 100%; max-width: 345px;\" fxLayout=\"column\">\n                            <mat-form-field fxFlex class=\"mat-block\">\n                                <mat-label>Liquid Type</mat-label>\n                                <input matInput formControlName=\"liquidType\" required>\n                                <mat-error *ngIf=\"editEntityFormGroup.get('details').get('liquidType').hasError('required')\">\n                                    Liquid type is required.\n                                </mat-error>\n                            </mat-form-field>\n                            <mat-form-field class=\"mat-block\" style=\"min-width: 100px;\">\n                                <mat-label>Tank shape</mat-label>\n                                <mat-select formControlName=\"tankShape\" name=\"tankShape\">\n                                    <mat-option *ngFor=\"let tankShape of tankShapes | keyvalue\" [value]=\"tankShape.value\">\n                                        {{ tankShape.value }}\n                                    </mat-option>\n                                </mat-select>\n                                <mat-error *ngIf=\"editEntityFormGroup.get('details').get('tankShape').hasError('required')\">\n                                    Tank shape is required.\n                                </mat-error>\n                            </mat-form-field>\n                        </div>\n                    </div>\n                    <mat-divider></mat-divider>\n                    <div fxFlex fxLayout=\"row\" class=\"details-section\" fxLayoutGap=\"8px\" fxLayout.xs=\"column\"  fxLayoutGap.xs=\"0\" fxLayoutAlign=\"space-between\">\n                        <label class=\"section-label\">Details</label>\n                        <div style=\"width: 100%; max-width: 345px;\" fxLayout=\"column\">\n                            <div formGroupName=\"sizeMeasure\">\n                                <div *ngIf=\"editEntityFormGroup.get('details').get('tankShape').value === tankShapes.hCylinder\" fxFlex fxLayout=\"row\" fxLayoutGap=\"8px\" fxLayout.xs=\"column\"  fxLayoutGap.xs=\"0\" fxLayoutAlign=\"space-between\">\n                                    <mat-form-field fxFlex class=\"mat-block\">\n                                        <mat-label>Length (cm)</mat-label>\n                                        <input matInput type=\"number\" formControlName=\"length\" required>\n                                        <mat-error *ngIf=\"editEntityFormGroup.get('details').get('sizeMeasure').get('length') && editEntityFormGroup.get('details').get('sizeMeasure').get('length').hasError('required')\">\n                                                Length is required.\n                                        </mat-error>\n                                    </mat-form-field>\n                                    <mat-form-field fxFlex class=\"mat-block\">\n                                        <mat-label>Diameter (cm)</mat-label>\n                                        <input matInput type=\"number\" formControlName=\"diameter\" required>\n                                        <mat-error *ngIf=\"editEntityFormGroup.get('details').get('sizeMeasure').get('diameter') && editEntityFormGroup.get('details').get('sizeMeasure').get('diameter').hasError('required')\">\n                                                Diameter is required.\n                                        </mat-error>\n                                    </mat-form-field>\n                                </div>\n                                <div *ngIf=\"editEntityFormGroup.get('details').get('tankShape').value === tankShapes.vCylinder\" fxFlex fxLayout=\"row\" fxLayoutGap=\"8px\" fxLayout.xs=\"column\"  fxLayoutGap.xs=\"0\" fxLayoutAlign=\"space-between\">\n                                    <mat-form-field fxFlex class=\"mat-block\">\n                                        <mat-label>Height (cm)</mat-label>\n                                        <input matInput type=\"number\" formControlName=\"height\" required>\n                                        <mat-error *ngIf=\"editEntityFormGroup.get('details').get('sizeMeasure').get('height') && editEntityFormGroup.get('details').get('sizeMeasure').get('height').hasError('required')\">\n                                                Height is required.\n                                        </mat-error>\n                                    </mat-form-field>\n                                    <mat-form-field fxFlex class=\"mat-block\">\n                                        <mat-label>Diameter (cm)</mat-label>\n                                        <input matInput type=\"number\" formControlName=\"diameter\" required>\n                                        <mat-error *ngIf=\"editEntityFormGroup.get('details').get('sizeMeasure').get('diameter') && editEntityFormGroup.get('details').get('sizeMeasure').get('diameter').hasError('required')\">\n                                                Diameter is required.\n                                        </mat-error>\n                                    </mat-form-field>\n                                </div>\n                                <div *ngIf=\"editEntityFormGroup.get('details').get('tankShape').value === tankShapes.rectangle\" fxFlex fxLayout=\"row\" fxLayoutGap=\"8px\" fxLayout.xs=\"column\"  fxLayoutGap.xs=\"0\" fxLayoutAlign=\"space-between\">\n                                    <mat-form-field fxFlex class=\"mat-block\">\n                                        <mat-label>Width (cm)</mat-label>\n                                        <input matInput type=\"number\" formControlName=\"width\" required>\n                                        <mat-error *ngIf=\"editEntityFormGroup.get('details').get('sizeMeasure').get('width') && editEntityFormGroup.get('details').get('sizeMeasure').get('width').hasError('required')\">\n                                                Width is required.\n                                        </mat-error>\n                                    </mat-form-field>\n                                    <mat-form-field fxFlex class=\"mat-block\">\n                                        <mat-label>Length (cm)</mat-label>\n                                        <input matInput type=\"number\" formControlName=\"length\" required>\n                                        <mat-error *ngIf=\"editEntityFormGroup.get('details').get('sizeMeasure').get('length') && editEntityFormGroup.get('details').get('sizeMeasure').get('length').hasError('required')\">\n                                                Length is required.\n                                        </mat-error>\n                                    </mat-form-field>\n                                    <mat-form-field fxFlex class=\"mat-block\">\n                                        <mat-label>Height (cm)</mat-label>\n                                        <input matInput type=\"number\" formControlName=\"height\" required>\n                                        <mat-error *ngIf=\"editEntityFormGroup.get('details').get('sizeMeasure').get('height') && editEntityFormGroup.get('details').get('sizeMeasure').get('height').hasError('required')\">\n                                                Height is required.\n                                        </mat-error>\n                                    </mat-form-field>\n                                </div>\n                            </div>\n                            <mat-form-field fxFlex class=\"mat-block\">\n                                <mat-label>Capacity (Liters)</mat-label>\n                                <input matInput type=\"number\" formControlName=\"tankCapacity\" [readonly]=\"editEntityFormGroup.get('details').get('tankShape').value !== tankShapes.unspecified\" required>\n                                <mat-error *ngIf=\"editEntityFormGroup.get('details').get('tankCapacity').hasError('required')\">\n                                    Tank capacity is required.\n                                </mat-error>\n                            </mat-form-field>\n                        </div>\n                    </div>\n                    <div fxLayout=\"row\" fxLayoutAlign=\"space-between center\" style=\"width: 100%;\">\n                        <button mat-button color=\"primary\" matStepperPrevious type=\"button\">Back</button>\n                        <div fxLayout=\"row\" fxLayoutGap=\"8px\" fxLayoutAlign=\"end center\">\n                            <button mat-button color=\"primary\"\n                                    type=\"button\"\n                                    [disabled]=\"(isLoading$ | async)\"\n                                    (click)=\"cancel()\" cdkFocusInitial>\n                                Cancel\n                            </button>\n                            <button mat-button mat-raised-button color=\"primary\" \n                                    type=\"submit\"\n                                    [disabled]=\"(isLoading$ | async) || editEntityForm.invalid || !editEntityForm.dirty\">\n                                Save\n                            </button>\n                        </div>\n                    </div>\n                </div>\n            </mat-step>\n        </mat-stepper> \n    </div>\n</form>",
                "customCss": ".edit-sensor-form .mat-mdc-dialog-content {\n    max-height: none !important;\n    padding: 0 !important;\n}\n\n.edit-entity-form .mat-mdc-dialog-content .details-section {\n    margin-top: 22px;\n}\n\n.edit-entity-form .mat-mdc-dialog-content .section-label {\n    font-size: 14px;\n    font-weight: 500;\n    color: rgba(0, 0, 0, 0.76);\n    /*min-width: 30%; */\n    margin-top: 18px;\n}",
                "customFunction": "let $injector = widgetContext.$scope.$injector;\nlet customDialog = $injector.get(widgetContext.servicesMap.get('customDialog'));\nlet entityService = $injector.get(widgetContext.servicesMap.get('entityService'));\nlet assetService = $injector.get(widgetContext.servicesMap.get('assetService'));\nlet deviceService = $injector.get(widgetContext.servicesMap.get('deviceService'));\nlet attributeService = $injector.get(widgetContext.servicesMap.get('attributeService'));\n\nopenEditEntityDialog();\n\nfunction openEditEntityDialog() {\n    customDialog.customDialog(htmlTemplate, EditEntityDialogController).subscribe();\n}\n\nfunction EditEntityDialogController(instance) {\n    let vm = instance;\n    let subscriptions = [];\n\n    vm.widgetContext = widgetContext;\n    vm.currentStep = 0;\n    vm.entityId = entityId;\n    vm.entityName = entityName;\n    vm.entityLabel = entityLabel;\n    vm.entityType = entityId.entityType;\n    vm.tankShapes = {\n        unspecified: \"Unspecified\",\n        hCylinder: \"Horizontal Cylinder\",\n        vCylinder: \"Vertical Cylinder\",\n        rectangle: \"Rectangle\"\n    };\n    \n    vm.attributes = {};\n    vm.entity = {};\n\n    vm.editEntityFormGroup = vm.fb.group({\n        general: vm.fb.group({\n            entityName: ['', [vm.validators.required]],\n            entityLabel: ['', [vm.validators.required]],\n        }),\n        details: vm.fb.group({\n            liquidType: ['', [vm.validators.required]],\n            tankShape: ['', [vm.validators.required]],\n            tankCapacity: ['', [vm.validators.required]],\n            sizeMeasure: vm.fb.group({\n            })\n        })\n    });\n\n    getEntityInfo();\n    \n    subscribeForControlsChanges();\n    \n    vm.cancel = function() {\n        subscriptions.forEach(sub => sub.unsubscribe());\n        vm.dialogRef.close(null);\n    };\n    \n    vm.save = function() {\n        vm.editEntityFormGroup.markAsPristine();\n        widgetContext.rxjs.forkJoin([\n            saveAttributes(entityId),\n            saveEntity()\n        ]).subscribe(\n            function () {\n                subscriptions.forEach(sub => sub.unsubscribe());\n                widgetContext.updateAliases();\n                vm.dialogRef.close(null);\n            }\n        );\n    };\n\n    function getEntityAttributes(attributes) {\n        for (var i = 0; i < attributes.length; i++) {\n            vm.attributes[attributes[i].key] = attributes[i].value;\n        }\n    }\n\n    function getEntityInfo() {\n        widgetContext.rxjs.forkJoin([\n            attributeService.getEntityAttributes(entityId, 'SERVER_SCOPE'),\n            entityService.getEntity(entityId.entityType, entityId.id)\n        ]).subscribe(\n            function (data) {\n                getEntityAttributes(data[0]);\n                vm.entity = data[1];\n                vm.editEntityFormGroup.patchValue({\n                    general: {\n                        entityName: vm.entity.name,\n                        entityLabel: vm.entity.label,\n                    },\n                    details: vm.attributes\n                }, {emitEvent: false});\n                \n                setSizeMeasureFields(vm.attributes.tankShape);\n                subscribeForControlsChanges();\n            }\n        );\n    }\n    \n    function subscribeForControlsChanges() {\n        const tankShapeChange = vm.editEntityFormGroup.get('details').get('tankShape').valueChanges.subscribe((value) => {\n            vm.editEntityFormGroup.get('details').get('tankCapacity').setValue(0);\n            setSizeMeasureFields(value);\n        });\n        \n        subscriptions.push(tankShapeChange);\n    }\n    \n    function setSizeMeasureFields(tankShape) {\n        let length = null;\n        let diameter = null;\n        let height = null;\n        let width = null;\n        const sizeMeasureGroup = vm.editEntityFormGroup.get('details').get('sizeMeasure');\n        \n        Object.keys(sizeMeasureGroup.controls).forEach(key => {\n          sizeMeasureGroup.removeControl(key);\n        });\n        \n        switch (tankShape) {\n            // case tankShapes.unspecified:\n            //     break;\n            case vm.tankShapes.hCylinder:\n                if (vm.attributes.sizeMeasure) {\n                    length = vm.attributes.sizeMeasure['length'] ? vm.attributes.sizeMeasure['length'] : null;\n                    diameter = vm.attributes.sizeMeasure['diameter'] ? vm.attributes.sizeMeasure['diameter'] : null;\n                }\n                \n                \n                sizeMeasureGroup.addControl('length', vm.fb.control(length, [vm.validators.required]));\n                sizeMeasureGroup.addControl('diameter', vm.fb.control(diameter, [vm.validators.required]));\n                vm.editEntityFormGroup.get('details').get('tankCapacity').disable();\n                subscribeForHCylinder(sizeMeasureGroup);\n                break;\n                \n            case vm.tankShapes.vCylinder:\n                if (vm.attributes.sizeMeasure) {\n                    height = vm.attributes.sizeMeasure['height'] ? vm.attributes.sizeMeasure['height'] : null;\n                    diameter = vm.attributes.sizeMeasure['diameter'] ? vm.attributes.sizeMeasure['diameter'] : null;\n                }\n                \n                sizeMeasureGroup.addControl('height', vm.fb.control(height, [vm.validators.required]));\n                sizeMeasureGroup.addControl('diameter', vm.fb.control(diameter, [vm.validators.required]));\n                vm.editEntityFormGroup.get('details').get('tankCapacity').disable();\n                subscribeForVCylinder(sizeMeasureGroup);\n                break;\n                \n            case vm.tankShapes.rectangle:\n                if (vm.attributes.sizeMeasure) {\n                    height = vm.attributes.sizeMeasure['height'] ? vm.attributes.sizeMeasure['height'] : null;\n                    length = vm.attributes.sizeMeasure['length'] ? vm.attributes.sizeMeasure['length'] : null;\n                    width = vm.attributes.sizeMeasure['width'] ? vm.attributes.sizeMeasure['width'] : null;\n                }\n                \n                sizeMeasureGroup.addControl('height', vm.fb.control(height, [vm.validators.required]));\n                sizeMeasureGroup.addControl('length', vm.fb.control(length, [vm.validators.required]));\n                sizeMeasureGroup.addControl('width', vm.fb.control(width, [vm.validators.required]));\n                vm.editEntityFormGroup.get('details').get('tankCapacity').disable();\n                subscribeForRectangle(sizeMeasureGroup);\n                break;\n            default: \n                vm.editEntityFormGroup.get('details').get('tankCapacity').enable();\n        }\n    }\n    \n    function subscribeForHCylinder(sizeMeasureGroup) {\n        const tankCapacityControl = vm.editEntityFormGroup.get('details').get('tankCapacity');\n        setTimeout(() => {\n            const lengthChange = sizeMeasureGroup.get('length').valueChanges.subscribe((value) => {\n                const l = value;\n                const d = sizeMeasureGroup.value['diameter'];\n                \n                capacity = (((Math.PI / 4) * Math.pow((d / 2), 2) * l) / 1000).toFixed(0);\n                tankCapacityControl.setValue(capacity);\n            });\n            \n            subscriptions.push(lengthChange);\n            \n            const diameterChange = sizeMeasureGroup.get('diameter').valueChanges.subscribe((value) => {\n                const l = sizeMeasureGroup.value['length'];\n                const d = value;\n                \n                capacity = (((Math.PI / 4) * Math.pow((d / 2), 2) * l) / 1000).toFixed(0);\n                tankCapacityControl.setValue(capacity);\n            });\n            \n            subscriptions.push(diameterChange);\n        }, 100);\n    }\n    \n    function subscribeForVCylinder(sizeMeasureGroup) {\n        const tankCapacityControl = vm.editEntityFormGroup.get('details').get('tankCapacity');\n        setTimeout(() => {\n            const heightChange = sizeMeasureGroup.get('height').valueChanges.subscribe((value) => {\n                const h = value;\n                const d = sizeMeasureGroup.value['diameter'];\n\n                capacity = ((Math.PI * Math.pow((d / 2), 2) * h) / 1000).toFixed(2);\n                tankCapacityControl.setValue(capacity);\n            });\n            \n            subscriptions.push(heightChange);\n            \n            const diameterChange = sizeMeasureGroup.get('diameter').valueChanges.subscribe((value) => {\n                const h = sizeMeasureGroup.value['height'];\n                const d = value;\n\n                capacity = ((Math.PI * Math.pow((d / 2), 2) * h) / 1000).toFixed(2);\n                tankCapacityControl.setValue(capacity);\n            });\n            \n            subscriptions.push(diameterChange);\n        }, 100)\n    }\n    \n    function subscribeForRectangle(sizeMeasureGroup) {\n        const tankCapacityControl = vm.editEntityFormGroup.get('details').get('tankCapacity');\n        setTimeout(() => {\n            const heightChange = sizeMeasureGroup.get('height').valueChanges.subscribe((value) => {\n                const h = value;\n                const l = sizeMeasureGroup.value['length'];\n                const w = sizeMeasureGroup.value['width'];\n\n                capacity = ((h * l * w) / 1000).toFixed(0);\n                tankCapacityControl.setValue(capacity);\n            });\n            \n            subscriptions.push(heightChange);\n            \n            sizeMeasureGroup.get('height').updateValueAndValidity();\n            \n            const lengthChange = sizeMeasureGroup.get('length').valueChanges.subscribe((value) => {\n                const h = sizeMeasureGroup.value['height'];\n                const l = value;\n                const w = sizeMeasureGroup.value['width'];\n\n                capacity = ((h * l * w) / 1000).toFixed(0);\n                tankCapacityControl.setValue(capacity);\n            });\n            \n            subscriptions.push(lengthChange);\n            \n            sizeMeasureGroup.get('length').updateValueAndValidity();\n            \n            const widthChange = sizeMeasureGroup.get('width').valueChanges.subscribe((value) => {\n                const h = sizeMeasureGroup.value['height'];\n                const l = sizeMeasureGroup.value['length'];\n                const w = value;\n\n                capacity = ((h * l * w) / 1000).toFixed(0);\n                tankCapacityControl.setValue(capacity);\n            });\n            \n            subscriptions.push(widthChange);\n            \n            sizeMeasureGroup.get('width').updateValueAndValidity();\n            \n            // Merge is not working due to unknown obs type\n            // widgetContext.rxjs.merge(\n            //     sizeMeasureGroup.get('height').valueChanges,\n            //     sizeMeasureGroup.get('length').valueChanges,\n            //     sizeMeasureGroup.get('width').valueChanges\n            // ).subscribe(() => {\n            //     const h = sizeMeasureGroup.value['height'];\n            //     const l = sizeMeasureGroup.value['length'];\n            //     const w = sizeMeasureGroup.value['width'];\n\n            //     capacity = (h * l * w) / 1000;\n            //     tankCapacityControl.setValue(capacity);\n            // });\n        }, 100);\n    }\n\n    function saveEntity() {\n        const formValues = vm.editEntityFormGroup.value;\n        \n        if (vm.entity.label !== formValues.general.entityLabel ||\n            vm.entity.name !== formValues.general.entityName){\n            vm.entity.label = formValues.general.entityLabel;\n            vm.entity.name = formValues.general.entityName;\n            return deviceService.saveDevice(vm.entity);\n        }\n        \n        return widgetContext.rxjs.of([]);\n    }\n\n    function saveAttributes(entityId) {\n        const details = vm.editEntityFormGroup.get('details').value;\n        \n        let attributesArray = [];\n        \n        for (let key in details) {\n            if (details[key] !== vm.attributes[key]) {\n                attributesArray.push({key: key, value: details[key]});\n            }\n        }\n        \n        if (attributesArray.length > 0) {\n            return attributeService.saveEntityAttributes(entityId, \"SERVER_SCOPE\", attributesArray);\n        }\n        return widgetContext.rxjs.of([]);\n    }\n\n}",
                "customResources": [],
                "openInSeparateDialog": false,
                "openInPopover": false,
                "id": "a10c91e9-4ea7-9d0f-5828-e79becf5436b"
              },
              {
                "name": "Edit tank sensor location",
                "icon": "map",
                "useShowWidgetActionFunction": null,
                "showWidgetActionFunction": "return true;",
                "type": "customPretty",
                "customHtml": "<form #editEntityForm=\"ngForm\" [formGroup]=\"editEntityFormGroup\"\n      (ngSubmit)=\"save()\"  class=\"edit-location-form\">\n    <mat-toolbar fxLayout=\"row\" style=\"background-color: transparent; border-bottom: solid 1px #0000001f;\">\n        <h2>Edit sensor {{entityName}}</h2>\n        <span fxFlex></span>\n        <button mat-icon-button (click)=\"cancel()\" type=\"button\">\n            <mat-icon class=\"material-icons\">close</mat-icon>\n        </button>\n    </mat-toolbar>\n    <mat-progress-bar color=\"warn\" mode=\"indeterminate\" *ngIf=\"isLoading$ | async\">\n    </mat-progress-bar>\n    <div style=\"height: 4px;\" *ngIf=\"!(isLoading$ | async)\"></div>\n    <div mat-dialog-content xFlex fxLayout=\"column\">\n        <div fxFlex fxLayout=\"column\" fxLayoutGap=\"16px\">\n            <section fxLayout=\"column\">\n                <tb-dashboard-state \n                    style=\"height: 550px; width: 100%;\"\n                    [ctx]=\"widgetContext\"\n                    stateId=\"edit-tank-location\"\n                    [entityId]=\"entityId\">\n                </tb-dashboard-state>\n            </section>\n            <div fxFlex formGroupName=\"location\" fxLayout=\"row\" fxLayoutGap=\"8px\" fxLayout.xs=\"column\"  fxLayoutGap.xs=\"0\" fxLayoutAlign=\"space-between\">\n                <mat-form-field fxFlex class=\"mat-block\">\n                    <mat-label>Latitude</mat-label>\n                    <input readonly=\"true\" matInput type=\"number\" formControlName=\"latitude\">\n                </mat-form-field>\n                <mat-form-field fxFlex class=\"mat-block\">\n                    <mat-label>Longitude</mat-label>\n                    <input readonly=\"true\" matInput type=\"number\" formControlName=\"longitude\">\n                </mat-form-field>\n            </div>\n        </div>\n        <!--<div fxLayout=\"row\" fxLayoutAlign=\"space-between center\" fxLayoutGap=\"8px\">-->\n        <!--    <button mat-button color=\"primary\"-->\n        <!--            type=\"button\"-->\n        <!--            [disabled]=\"(isLoading$ | async)\"-->\n        <!--            (click)=\"cancel()\" cdkFocusInitial>-->\n        <!--        Cancel-->\n        <!--    </button>-->\n        <!--    <button mat-button mat-raised-button color=\"primary\" -->\n        <!--            type=\"submit\"-->\n        <!--            [disabled]=\"(isLoading$ | async) || editEntityForm.invalid || !editEntityForm.dirty\">-->\n        <!--        Save-->\n        <!--    </button>-->\n        <!--</div>-->\n    </div>\n</form>        ",
                "customCss": ".edit-location-form .mat-mdc-dialog-content {\n    max-height: none !important;\n    width: 750px;\n}",
                "customFunction": "let $injector = widgetContext.$scope.$injector;\nlet customDialog = $injector.get(widgetContext.servicesMap.get('customDialog'));\nlet entityService = $injector.get(widgetContext.servicesMap.get('entityService'));\nlet assetService = $injector.get(widgetContext.servicesMap.get('assetService'));\nlet deviceService = $injector.get(widgetContext.servicesMap.get('deviceService'));\nlet attributeService = $injector.get(widgetContext.servicesMap.get('attributeService'));\n\nopenEditEntityDialog();\n\nfunction openEditEntityDialog() {\n    customDialog.customDialog(htmlTemplate, EditEntityDialogController).subscribe();\n}\n\nfunction EditEntityDialogController(instance) {\n    let vm = instance;\n    let latitude;\n    let longitude;\n    let subscriptions = [];\n\n    vm.widgetContext = widgetContext;\n    vm.entityId = entityId;\n    vm.entityName = entityName;\n    vm.entityLabel = entityLabel;\n    vm.entityType = entityId.entityType;\n    \n    vm.attributes = {};\n\n    vm.editEntityFormGroup = vm.fb.group({\n        location: vm.fb.group({\n            latitude: [null, []],\n            longitude: [null, []]\n        })\n    });\n    \n    vm.editEntityFormGroup.get('location').get('latitude').disable();\n    vm.editEntityFormGroup.get('location').get('longitude').disable();\n\n    getEntityInfo();\n    \n    vm.cancel = function() {\n        vm.dialogRef.close(null);\n        subscriptions.forEach(sub => sub.unsubscribe());\n    };\n    \n    vm.save = function() {\n        vm.editEntityFormGroup.markAsPristine();\n        widgetContext.rxjs.forkJoin([\n            saveAttributes(entityId)\n        ]).subscribe(\n            function () {\n                widgetContext.updateAliases();\n                vm.dialogRef.close(null);\n            }\n        );\n    };\n\n    function getEntityAttributes(attributes) {\n        for (var i = 0; i < attributes.length; i++) {\n            let value = attributes[i].value;\n            if (value) {\n                if (attributes[i].key === 'latitude' || attributes[i].key === 'longitude') {\n                    value = value.toFixed(5);\n                }\n            }\n            vm.attributes[attributes[i].key] = value;\n        }\n    }\n\n    function getEntityInfo() {\n        widgetContext.rxjs.forkJoin([\n            attributeService.getEntityAttributes(entityId, 'SERVER_SCOPE')\n        ]).subscribe(\n            function (data) {\n                getEntityAttributes(data[0]);\n                vm.entity = data[1];\n                vm.editEntityFormGroup.patchValue({\n                    location: vm.attributes\n                }, {emitEvent: false});\n                \n                subscribeForLocation();\n            }\n        );\n    }\n    \n    function subscribeForLocation() {\n        const updatedDataCheckup = widgetContext.rxjs.interval(1000);\n        subscriptions.push(\n            updatedDataCheckup.subscribe(() => updateLocationData())\n        );\n    }\n    \n    function updateLocationData() {\n        const location = vm.editEntityFormGroup.get('location');\n        widgetContext.data.forEach((itr) => { \n            if (entityName === itr.datasource.entityName) {\n                if (itr.dataKey.name === 'latitude') {\n                    \n                    if (latitude !== itr.data[0][1]) {\n                        latitude = itr.data[0][1] ? itr.data[0][1].toFixed(5) : itr.data[0][1];\n                        \n                        // if (location.value.latitude) {\n                        //     location.get('latitude').markAsDirty();\n                        // }\n                        \n                        location.get('latitude').setValue(latitude);\n                    }\n                    \n                } else if (itr.dataKey.name === 'longitude') {\n                    if (longitude !== itr.data[0][1]) {\n                        longitude = itr.data[0][1] ? itr.data[0][1].toFixed(5) : itr.data[0][1];\n                        \n                        //  if (location.value.longitude) {\n                        //     location.get('longitude').markAsDirty();\n                        // }\n                        \n                        location.get('longitude').setValue(longitude);\n                    }\n                }\n            }\n        })\n    }\n\n    function saveAttributes(entityId) {\n        const location = vm.editEntityFormGroup.get('location').value;\n        \n        let attributesArray = [];\n        \n        for (let key in location) {\n            if (location[key] !== vm.attributes[key]) {\n                attributesArray.push({key: key, value: location[key]});\n            }\n        }\n        \n        if (attributesArray.length > 0) {\n            return attributeService.saveEntityAttributes(entityId, \"SERVER_SCOPE\", attributesArray);\n        }\n        return widgetContext.rxjs.of([]);\n    }\n\n}",
                "customResources": [],
                "openInSeparateDialog": false,
                "openInPopover": false,
                "id": "ad53cb0e-af41-7ad3-596b-715c3f0f2f60"
              }
            ]
          }
        },
        "row": 0,
        "col": 0,
        "id": "b89177ac-8f67-3ae5-dfc8-945d995ced41"
      },
      "03d839be-999a-b952-07f5-d157d6da78aa": {
        "isSystemType": true,
        "bundleAlias": "alarm_widgets",
        "typeAlias": "alarms_table",
        "type": "alarm",
        "title": "New widget",
        "image": null,
        "description": null,
        "sizeX": 10.5,
        "sizeY": 6.5,
        "config": {
          "timewindow": {
            "hideInterval": false,
            "hideLastInterval": false,
            "hideQuickInterval": false,
            "hideAggregation": false,
            "hideAggInterval": false,
            "hideTimezone": false,
            "selectedTab": 0,
            "realtime": {
              "realtimeType": 0,
              "timewindowMs": 604800000,
              "quickInterval": "CURRENT_DAY",
              "interval": 1000
            },
            "aggregation": {
              "type": "NONE",
              "limit": 200
            }
          },
          "showTitle": true,
          "backgroundColor": "rgb(255, 255, 255)",
          "color": "rgba(0, 0, 0, 0.87)",
          "padding": "8px",
          "settings": {
            "enableSelection": false,
            "enableSearch": true,
            "enableSelectColumnDisplay": false,
            "enableFilter": true,
            "enableStickyHeader": true,
            "enableStickyAction": false,
            "reserveSpaceForHiddenAction": "true",
            "displayDetails": false,
            "allowAcknowledgment": false,
            "allowClear": false,
            "displayPagination": false,
            "defaultSortOrder": "-createdTime",
            "useRowStyleFunction": false
          },
          "title": "New Alarms table",
          "dropShadow": false,
          "enableFullscreen": true,
          "titleStyle": {
            "fontSize": "16px",
            "fontWeight": 500,
            "padding": "5px 10px 5px 10px",
            "color": "#29313C",
            "letterSpacing": "0.25px"
          },
          "useDashboardTimewindow": true,
          "showLegend": false,
          "alarmSource": {
            "type": "entity",
            "name": null,
            "entityAliasId": "6d74f33d-0025-fbc5-06b7-996534fa99c7",
            "filterId": null,
            "dataKeys": [
              {
                "name": "originator",
                "type": "alarm",
                "label": "Serial number",
                "color": "#4caf50",
                "settings": {
                  "useCellStyleFunction": false,
                  "cellStyleFunction": "",
                  "useCellContentFunction": false,
                  "cellContentFunction": ""
                },
                "_hash": 0.2780007688856758,
                "aggregationType": null,
                "units": null,
                "decimals": null,
                "funcBody": null,
                "usePostProcessing": null,
                "postFuncBody": null
              },
              {
                "name": "createdTime",
                "type": "alarm",
                "label": "Created time",
                "color": "#2196f3",
                "settings": {
                  "useCellStyleFunction": false,
                  "cellStyleFunction": "",
                  "useCellContentFunction": false,
                  "cellContentFunction": ""
                },
                "_hash": 0.021092237451093787
              },
              {
                "name": "type",
                "type": "alarm",
                "label": "Type",
                "color": "#f44336",
                "settings": {
                  "columnWidth": "25%",
                  "useCellStyleFunction": false,
                  "useCellContentFunction": false,
                  "defaultColumnVisibility": "visible",
                  "columnSelectionToDisplay": "enabled",
                  "columnExportOption": "onlyVisible"
                },
                "_hash": 0.7323586880398418,
                "aggregationType": null,
                "units": null,
                "decimals": null,
                "funcBody": null,
                "usePostProcessing": null,
                "postFuncBody": null
              },
              {
                "name": "severity",
                "type": "alarm",
                "label": "Details",
                "color": "#ffc107",
                "settings": {
                  "columnWidth": "0px",
                  "useCellStyleFunction": true,
                  "cellStyleFunction": "return {\n    \"color\": \"#D12730\",\n    \"font-weight\": 500\n}",
                  "useCellContentFunction": true,
                  "cellContentFunction": "return alarm.details.data ? alarm.details.data : '-';",
                  "defaultColumnVisibility": "visible",
                  "columnSelectionToDisplay": "enabled",
                  "columnExportOption": "onlyVisible"
                },
                "_hash": 0.06240450485076421,
                "aggregationType": null,
                "units": null,
                "decimals": null,
                "funcBody": null,
                "usePostProcessing": null,
                "postFuncBody": null
              }
            ],
            "alarmFilterConfig": {
              "statusList": [
                "ACTIVE"
              ]
            }
          },
          "alarmsPollingInterval": 5,
          "showTitleIcon": false,
          "titleIcon": "more_horiz",
          "iconColor": "rgba(0, 0, 0, 0.87)",
          "iconSize": "24px",
          "titleTooltip": "",
          "widgetStyle": {},
          "displayTimewindow": true,
          "actions": {
            "headerButton": [],
            "actionCellButton": [
              {
                "name": "Clear",
                "icon": "close",
                "useShowWidgetActionFunction": null,
                "showWidgetActionFunction": "return true;",
                "type": "custom",
                "customFunction": "const $injector = widgetContext.$scope.$injector;\nconst dialogs = $injector.get(widgetContext.servicesMap.get('dialogs'));\nconst alarmService = $injector.get(widgetContext.servicesMap.get('alarmService'));\n\nopenDeleteEntityDialog();\n\nfunction openDeleteEntityDialog() {\n    const alarmType = additionalParams.alarm.type ? additionalParams.alarm.type : '';\n    const title = 'Clear ' + alarmType + ' Alarm';\n    const content = 'Are you sure you want to clear Alarm?';\n    dialogs.confirm(title, content, 'No', 'Yes').subscribe(\n        (result) => {\n            if (result) {\n                clearAlarm();\n            }\n        }\n    );\n}\n\nfunction clearAlarm() {\n    alarmService.clearAlarm(additionalParams.alarm.id.id).subscribe(\n        () => {\n            setTimeout(() => {\n                widgetContext.updateAliases();\n            }, 500);\n        },\n        () => {\n            showErrorDialog();\n        }\n    );\n}\n\nfunction showErrorDialog() {\n    const title = 'Error';\n    const content = 'An error occurred while clearing the alarm. Please try again.';\n    dialogs.alert(title, content, 'CLOSE').subscribe();\n}",
                "openInSeparateDialog": false,
                "openInPopover": false,
                "id": "2c0d3d51-a177-b473-2309-95caa4f4d7f4"
              }
            ]
          },
          "datasources": [],
          "enableDataExport": true,
          "widgetCss": "",
          "pageSize": 1024,
          "noDataDisplayMessage": "",
          "alarmFilterConfig": {
            "statusList": [
              "ACTIVE"
            ],
            "severityList": [],
            "typeList": [],
            "searchPropagatedAlarms": false
          }
        },
        "row": 0,
        "col": 0,
        "id": "03d839be-999a-b952-07f5-d157d6da78aa"
      },
      "758b7a23-7296-5310-ee42-923302022cf9": {
        "isSystemType": true,
        "bundleAlias": "cards",
        "typeAlias": "timeseries_table",
        "type": "timeseries",
        "title": "New widget",
        "image": null,
        "description": null,
        "sizeX": 8,
        "sizeY": 6.5,
        "config": {
          "datasources": [
            {
              "type": "entity",
              "name": null,
              "entityAliasId": "6d74f33d-0025-fbc5-06b7-996534fa99c7",
              "filterId": null,
              "dataKeys": [
                {
                  "name": "fuelLevel",
                  "type": "timeseries",
                  "label": "Remaining",
                  "color": "#2196f3",
                  "settings": {
                    "useCellStyleFunction": false,
                    "useCellContentFunction": true,
                    "cellContentFunction": "if (value || value === 0) {\n    const tankCapacity = rowData.tankCapacity;\n    let fontWeight = '400';\n    let background = '234, 235, 255';\n    let progress = '183, 185, 248';\n    let textColor = '';\n    \n    const calculatedValue = (value * tankCapacity) / 100;\n    const percent = value + '%';\n    const valueText = `${parseFloat(value).toFixed(0)}% (${parseFloat(calculatedValue).toFixed(0)}L)`;\n    \nreturn '<div style=\"display: flex; justify-content: space-between; align-items: center; margin-right: 15%; min-width: 90px;\">' + \n           '<span style=\"padding: 4px; font-weight: ' + fontWeight +';color: ' + textColor + ';\">' + valueText + '</span>' + \n           '<div style=\"width: 100%; max-width: 100px; height: 16px; background: linear-gradient(to right, rgba(' + progress + ', 1) ' + percent + ', rgba(' + background + ', 1) '+ percent + '); border-radius: 5.21053px;\">' + \n           '</div>' + \n        '</div>';\n} else {\n    return 'No data';\n}"
                  },
                  "_hash": 0.10911712512198046,
                  "aggregationType": null,
                  "units": null,
                  "decimals": null,
                  "funcBody": null,
                  "usePostProcessing": null,
                  "postFuncBody": null
                },
                {
                  "name": "fuelLevel",
                  "type": "timeseries",
                  "label": "Refilling",
                  "color": "#4caf50",
                  "settings": {
                    "useCellStyleFunction": false,
                    "useCellContentFunction": true,
                    "cellContentFunction": "if (value) {\n    let liters = 0;\n    if (value || value === 0) {\n        liters = ((value * rowData.tankCapacity) / 100).toFixed(0);\n    }\n    \n    return `${liters}L`;\n}\nreturn '';"
                  },
                  "_hash": 0.6387169073668497,
                  "aggregationType": null,
                  "units": null,
                  "decimals": null,
                  "funcBody": null,
                  "usePostProcessing": true,
                  "postFuncBody": "if (value || value === 0 && prevOrigValue || prevOrigValue === 0) {\n    let refilling = value - prevOrigValue;\n    if (refilling > 0) {\n        return refilling;\n    }\n}\nreturn null;"
                },
                {
                  "name": "fuelLevel",
                  "type": "timeseries",
                  "label": "Consumption",
                  "color": "#ffc107",
                  "settings": {
                    "useCellStyleFunction": false,
                    "useCellContentFunction": true,
                    "cellContentFunction": "if (value) {\n    let liters = 0;\n    if (value || value === 0) {\n        liters = ((value * rowData.tankCapacity) / 100).toFixed(0);\n    }\n    \n    return `${liters}L`;\n}\nreturn '';"
                  },
                  "_hash": 0.49397741077759383,
                  "aggregationType": null,
                  "units": null,
                  "decimals": null,
                  "funcBody": null,
                  "usePostProcessing": true,
                  "postFuncBody": "if (value || value === 0 && prevOrigValue || prevOrigValue === 0) {\n    let consumption = value - prevOrigValue;\n    if (consumption < 0) {\n        return Math.abs(consumption);\n    }\n}\nreturn null;"
                }
              ],
              "alarmFilterConfig": {
                "statusList": [
                  "ACTIVE"
                ]
              },
              "latestDataKeys": [
                {
                  "name": "tankCapacity",
                  "type": "attribute",
                  "label": "tankCapacity",
                  "color": "#ffc107",
                  "settings": {
                    "show": false
                  },
                  "_hash": 0.5209407594004254,
                  "aggregationType": null,
                  "units": null,
                  "decimals": null,
                  "funcBody": null,
                  "usePostProcessing": null,
                  "postFuncBody": null
                }
              ]
            }
          ],
          "timewindow": {
            "hideInterval": false,
            "hideLastInterval": false,
            "hideQuickInterval": false,
            "hideAggregation": false,
            "hideAggInterval": false,
            "hideTimezone": false,
            "selectedTab": 0,
            "realtime": {
              "realtimeType": 0,
              "timewindowMs": 43200000,
              "quickInterval": "CURRENT_DAY",
              "interval": 1000
            },
            "aggregation": {
              "type": "NONE",
              "limit": 200
            }
          },
          "showTitle": true,
          "backgroundColor": "rgb(255, 255, 255)",
          "color": "rgba(0, 0, 0, 0.87)",
          "padding": "8px",
          "settings": {
            "enableSearch": true,
            "enableStickyHeader": true,
            "enableStickyAction": true,
            "reserveSpaceForHiddenAction": "true",
            "showTimestamp": true,
            "showMilliseconds": false,
            "displayPagination": false,
            "useEntityLabel": false,
            "hideEmptyLines": false,
            "disableStickyHeader": false,
            "useRowStyleFunction": false
          },
          "title": "Consumption and remaining fuel",
          "dropShadow": true,
          "enableFullscreen": true,
          "titleStyle": {
            "fontSize": "16px",
            "fontWeight": 500,
            "padding": "5px 10px 5px 10px",
            "color": "#29313C",
            "letterSpacing": "0.25px"
          },
          "useDashboardTimewindow": true,
          "showLegend": false,
          "widgetStyle": {},
          "actions": {},
          "showTitleIcon": false,
          "iconColor": "rgba(0, 0, 0, 0.87)",
          "iconSize": "24px",
          "displayTimewindow": false,
          "titleTooltip": "",
          "enableDataExport": true,
          "widgetCss": ".mat-mdc-table .mat-mdc-header-row, .mat-mdc-table .mat-mdc-row, .mat-mdc-table .mat-mdc-footer-cell {\n    height: 52px !important;\n}",
          "pageSize": 1024,
          "noDataDisplayMessage": ""
        },
        "row": 0,
        "col": 0,
        "id": "758b7a23-7296-5310-ee42-923302022cf9"
      },
      "79b3975f-b3ed-f839-8209-b17d2e7a2601": {
        "isSystemType": true,
        "bundleAlias": "cards",
        "typeAlias": "markdown_card",
        "type": "latest",
        "title": "New widget",
        "image": null,
        "description": null,
        "sizeX": 5,
        "sizeY": 3.5,
        "config": {
          "datasources": [
            {
              "type": "entity",
              "name": null,
              "entityAliasId": "cd74427b-6a97-ced1-262d-b0fe26af2ae8",
              "filterId": null,
              "dataKeys": []
            }
          ],
          "timewindow": {
            "displayValue": "",
            "selectedTab": 0,
            "realtime": {
              "realtimeType": 1,
              "interval": 1000,
              "timewindowMs": 60000,
              "quickInterval": "CURRENT_DAY"
            },
            "history": {
              "historyType": 0,
              "interval": 1000,
              "timewindowMs": 60000,
              "fixedTimewindow": {
                "startTimeMs": 1682774690137,
                "endTimeMs": 1682861090137
              },
              "quickInterval": "CURRENT_DAY"
            },
            "aggregation": {
              "type": "AVG",
              "limit": 25000
            }
          },
          "showTitle": false,
          "backgroundColor": "#fff",
          "color": "rgba(0, 0, 0, 0.87)",
          "padding": "0px",
          "settings": {
            "useMarkdownTextFunction": true,
            "markdownTextFunction": "return '<div class=\"panel-buttons\" fxFlex fxLayout=\"row\" fxLayoutAlign=\"end center\" fxLayoutGap=\"4px\">' +\n            '<button mat-button color=\"primary\" id=\"enable_all\">' +\n              'Enable all' +\n            '</button>' +\n            '<button mat-stroked-button color=\"primary\" id=\"disable_all\">' +\n              'Disable all' +\n            '</button>' +\n        '</div>';",
            "applyDefaultMarkdownStyle": true,
            "markdownCss": ".panel-buttons {\n    padding-left: 0 !important;\n}"
          },
          "title": "",
          "showTitleIcon": false,
          "iconColor": "rgba(0, 0, 0, 0.87)",
          "iconSize": "24px",
          "titleTooltip": "",
          "dropShadow": false,
          "enableFullscreen": false,
          "widgetStyle": {},
          "titleStyle": {
            "fontSize": "16px",
            "fontWeight": 400
          },
          "showLegend": false,
          "actions": {
            "elementClick": [
              {
                "name": "enable_all",
                "icon": "more_horiz",
                "useShowWidgetActionFunction": null,
                "showWidgetActionFunction": "return true;",
                "type": "custom",
                "customFunction": "const $injector = widgetContext.$injector;\nconst attributeService = $injector.get(widgetContext.servicesMap.get('attributeService'));\n\nlet attributesArray = [\n    {key: \"noAlarms\", value: \"noAlarms\"},\n    {key: \"lowRemaningLevel\", value: \"lowFuel\"},\n    {key: \"lowBattery\", value: \"lowBattery\"},\n    {key: \"lowTemperature\", value: \"lowTemperature\"},\n    {key: \"highTemperature\", value: \"highTemperature\"},\n    {key: \"offline\", value: \"offline\"}\n];\n\nattributeService.saveEntityAttributes(entityId, \"SERVER_SCOPE\", attributesArray).subscribe(() => {\n    // widgetContext.updateAliases();\n});",
                "openInSeparateDialog": false,
                "openInPopover": false,
                "id": "a4fdd169-2a9f-2995-c361-8675e78ad5d7"
              },
              {
                "name": "disable_all",
                "icon": "more_horiz",
                "useShowWidgetActionFunction": null,
                "showWidgetActionFunction": "return true;",
                "type": "custom",
                "customFunction": "const $injector = widgetContext.$injector;\nconst attributeService = $injector.get(widgetContext.servicesMap.get('attributeService'));\n\nlet attributesArray = [\n    {key: \"noAlarms\", value: \"unset\"},\n    {key: \"lowRemaningLevel\", value: \"unset\"},\n    {key: \"lowBattery\", value: \"unset\"},\n    {key: \"lowTemperature\", value: \"unset\"},\n    {key: \"highTemperature\", value: \"unset\"},\n    {key: \"offline\", value: \"unset\"}\n];\n\nattributeService.saveEntityAttributes(entityId, \"SERVER_SCOPE\", attributesArray).subscribe(() => {\n    // widgetContext.updateAliases();\n});",
                "openInSeparateDialog": false,
                "openInPopover": false,
                "id": "99c8349f-05c6-0008-537b-d0842e28dca3"
              }
            ]
          },
          "enableDataExport": false,
          "widgetCss": ".widget-type-sys-cards-markdown_card #container tb-markdown-widget .tb-markdown-view {\n    display: flex;\n}",
          "pageSize": 1024,
          "noDataDisplayMessage": "",
          "useDashboardTimewindow": true
        },
        "row": 0,
        "col": 0,
        "id": "79b3975f-b3ed-f839-8209-b17d2e7a2601"
      },
      "b52a62ff-7409-332f-6e41-3ed879a77892": {
        "isSystemType": true,
        "bundleAlias": "maps_v2",
        "typeAlias": "openstreetmap",
        "type": "latest",
        "title": "New widget",
        "image": null,
        "description": null,
        "sizeX": 8.5,
        "sizeY": 6,
        "config": {
          "datasources": [
            {
              "type": "entity",
              "name": null,
              "entityAliasId": "6d74f33d-0025-fbc5-06b7-996534fa99c7",
              "filterId": null,
              "dataKeys": [
                {
                  "name": "latitude",
                  "type": "attribute",
                  "label": "latitude",
                  "color": "#2196f3",
                  "settings": {},
                  "_hash": 0.7494193897041803
                },
                {
                  "name": "longitude",
                  "type": "attribute",
                  "label": "longitude",
                  "color": "#4caf50",
                  "settings": {},
                  "_hash": 0.9838447132407786
                },
                {
                  "name": "active",
                  "type": "attribute",
                  "label": "active",
                  "color": "#f44336",
                  "settings": {},
                  "_hash": 0.6846057478799168
                },
                {
                  "name": "battery",
                  "type": "timeseries",
                  "label": "battery",
                  "color": "#8bc34a",
                  "settings": {},
                  "_hash": 0.7804883468187684,
                  "aggregationType": "NONE",
                  "units": null,
                  "decimals": null,
                  "funcBody": null,
                  "usePostProcessing": null,
                  "postFuncBody": null
                },
                {
                  "name": "liquidType",
                  "type": "attribute",
                  "label": "liquidType",
                  "color": "#9c27b0",
                  "settings": {},
                  "_hash": 0.5112403657601383
                },
                {
                  "name": "temperature",
                  "type": "timeseries",
                  "label": "temperature",
                  "color": "#8bc34a",
                  "settings": {},
                  "_hash": 0.6026874983363109
                },
                {
                  "name": "tankCapacity",
                  "type": "attribute",
                  "label": "tankCapacity",
                  "color": "#03a9f4",
                  "settings": {},
                  "_hash": 0.11473993178433628
                },
                {
                  "name": "fuelLevel",
                  "type": "timeseries",
                  "label": "fuelLevel",
                  "color": "#ff9800",
                  "settings": {},
                  "_hash": 0.9116024261844533
                },
                {
                  "name": "isHighTemperature",
                  "type": "attribute",
                  "label": "isHighTemperature",
                  "color": "#e91e63",
                  "settings": {},
                  "_hash": 0.9632470736529124,
                  "aggregationType": null,
                  "units": null,
                  "decimals": null,
                  "funcBody": null,
                  "usePostProcessing": true,
                  "postFuncBody": "return value === \"true\";"
                },
                {
                  "name": "isLowBattery",
                  "type": "attribute",
                  "label": "isLowBattery",
                  "color": "#ffeb3b",
                  "settings": {},
                  "_hash": 0.37472605989530705,
                  "aggregationType": null,
                  "units": null,
                  "decimals": null,
                  "funcBody": null,
                  "usePostProcessing": true,
                  "postFuncBody": "return value === \"true\";"
                },
                {
                  "name": "isLowFuel",
                  "type": "attribute",
                  "label": "isLowFuel",
                  "color": "#03a9f4",
                  "settings": {},
                  "_hash": 0.7321873987269121,
                  "aggregationType": null,
                  "units": null,
                  "decimals": null,
                  "funcBody": null,
                  "usePostProcessing": true,
                  "postFuncBody": "return value === \"true\";"
                },
                {
                  "name": "isLowTemperature",
                  "type": "attribute",
                  "label": "isLowTemperature",
                  "color": "#ff9800",
                  "settings": {},
                  "_hash": 0.33412107130818325,
                  "aggregationType": null,
                  "units": null,
                  "decimals": null,
                  "funcBody": null,
                  "usePostProcessing": true,
                  "postFuncBody": "return value === \"true\";"
                }
              ]
            }
          ],
          "timewindow": {
            "displayValue": "",
            "selectedTab": 0,
            "realtime": {
              "realtimeType": 1,
              "interval": 1000,
              "timewindowMs": 60000,
              "quickInterval": "CURRENT_DAY"
            },
            "history": {
              "historyType": 0,
              "interval": 1000,
              "timewindowMs": 60000,
              "fixedTimewindow": {
                "startTimeMs": 1682001930247,
                "endTimeMs": 1682088330247
              },
              "quickInterval": "CURRENT_DAY"
            },
            "aggregation": {
              "type": "AVG",
              "limit": 25000
            }
          },
          "showTitle": false,
          "backgroundColor": "#fff",
          "color": "rgba(0, 0, 0, 0.87)",
          "padding": "0px",
          "settings": {
            "provider": "openstreet-map",
            "gmApiKey": "AIzaSyDoEx2kaGz3PxwbI9T7ccTSg5xjdw8Nw8Q",
            "gmDefaultMapType": "roadmap",
            "mapProvider": "CartoDB.Positron",
            "useCustomProvider": true,
            "customProviderTileUrl": "https://tiles.stadiamaps.com/tiles/outdoors/{z}/{x}/{y}{r}.png",
            "mapProviderHere": "HERE.normalDay",
            "credentials": {
              "app_id": "AhM6TzD9ThyK78CT3ptx",
              "app_code": "p6NPiITB3Vv0GMUFnkLOOg",
              "useV3": false
            },
            "mapImageUrl": "data:image/svg+xml;base64,PHN2ZyBpZD0ic3ZnMiIgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMTAwIiB3aWR0aD0iMTAwIiB2ZXJzaW9uPSIxLjEiIHhtbG5zOmNjPSJodHRwOi8vY3JlYXRpdmVjb21tb25zLm9yZy9ucyMiIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIgdmlld0JveD0iMCAwIDEwMCAxMDAiPgogPGcgaWQ9ImxheWVyMSIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMCAtOTUyLjM2KSI+CiAgPHJlY3QgaWQ9InJlY3Q0Njg0IiBzdHJva2UtbGluZWpvaW49InJvdW5kIiBoZWlnaHQ9Ijk5LjAxIiB3aWR0aD0iOTkuMDEiIHN0cm9rZT0iIzAwMCIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiB5PSI5NTIuODYiIHg9Ii40OTUwNSIgc3Ryb2tlLXdpZHRoPSIuOTkwMTAiIGZpbGw9IiNlZWUiLz4KICA8dGV4dCBpZD0idGV4dDQ2ODYiIHN0eWxlPSJ3b3JkLXNwYWNpbmc6MHB4O2xldHRlci1zcGFjaW5nOjBweDt0ZXh0LWFuY2hvcjptaWRkbGU7dGV4dC1hbGlnbjpjZW50ZXIiIGZvbnQtd2VpZ2h0PSJib2xkIiB4bWw6c3BhY2U9InByZXNlcnZlIiBmb250LXNpemU9IjEwcHgiIGxpbmUtaGVpZ2h0PSIxMjUlIiB5PSI5NzAuNzI4MDkiIHg9IjQ5LjM5NjQ3NyIgZm9udC1mYW1pbHk9IlJvYm90byIgZmlsbD0iIzY2NjY2NiI+PHRzcGFuIGlkPSJ0c3BhbjQ2OTAiIHg9IjUwLjY0NjQ3NyIgeT0iOTcwLjcyODA5Ij5JbWFnZSBiYWNrZ3JvdW5kIDwvdHNwYW4+PHRzcGFuIGlkPSJ0c3BhbjQ2OTIiIHg9IjQ5LjM5NjQ3NyIgeT0iOTgzLjIyODA5Ij5pcyBub3QgY29uZmlndXJlZDwvdHNwYW4+PC90ZXh0PgogIDxyZWN0IGlkPSJyZWN0NDY5NCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIgaGVpZ2h0PSIxOS4zNiIgd2lkdGg9IjY5LjM2IiBzdHJva2U9IiMwMDAiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgeT0iOTkyLjY4IiB4PSIxNS4zMiIgc3Ryb2tlLXdpZHRoPSIuNjM5ODYiIGZpbGw9Im5vbmUiLz4KIDwvZz4KPC9zdmc+Cg==",
            "tmApiKey": "84d6d83e0e51e481e50454ccbe8986b",
            "tmDefaultMapType": "roadmap",
            "latKeyName": "latitude",
            "lngKeyName": "longitude",
            "xPosKeyName": "xPos",
            "yPosKeyName": "yPos",
            "defaultZoomLevel": 0,
            "defaultCenterPosition": "34.023894, -118.238698",
            "disableScrollZooming": false,
            "disableDoubleClickZooming": false,
            "disableZoomControl": false,
            "fitMapBounds": true,
            "useDefaultCenterPosition": false,
            "mapPageSize": 16384,
            "markerOffsetX": 0.5,
            "markerOffsetY": 1,
            "posFunction": "return {x: origXPos, y: origYPos};",
            "draggableMarker": true,
            "showLabel": false,
            "useLabelFunction": false,
            "label": "${entityName}",
            "showTooltip": true,
            "showTooltipAction": "click",
            "autocloseTooltip": true,
            "useTooltipFunction": true,
            "tooltipPattern": "<b>${entityName}</b><br/><br/><b>Latitude:</b> ${latitude:7}<br/><b>Longitude:</b> ${longitude:7}",
            "tooltipFunction": "\nconst fuelLevel = data.fuelLevel;\nconst batteryLevel = data.battery;\nconst tankCapacity = data.tankCapacity;\nconst temperature = data.temperature;\nconst fuel = processValue((fuelLevel * tankCapacity) / 100, 0);\nconst liquidType = data.liquidType ? data.liquidType : 'N/A';\nconst lowFuelLevelColor = data.isLowFuel ? '#D12730' : '#29313C';\nconst lowBatteryColor = data.isLowBattery ? '#D12730' : '#29313C';\nconst thresholdTemperatureColor = data.isHighTemperature || data.isLowTemperature ? '#D12730' : '#29313C';\n                              \nconst isActive = data.active === 'true';\nconst status = isActive ? 'Online' : 'Offline';\nconst color = isActive ? '#3AA94D' : '#C42F37';\nconst bgColor = isActive ? 'rgba(58, 169, 77, 0.08)' : 'rgba(196, 47, 55, 0.08)';\nconst lastUpdate = (data['battery|ts'] || data['fuelLevel|ts']) ? \n    moment(Math.max(data['battery|ts'], data['fuelLevel|ts'])).format('D MMM YYYY HH:mm') : 'N/A';\nconst remaining = `${fuelLevel}% (${fuel}L)`;\n\nreturn '<div style=\"display:flex;flex-direction:column;margin-bottom:8px;font-family:\\'Roboto\\';font-weight:500;font-size:16px;line-height:24px;letter-spacing:0.25px;color:#29313C\">' +\n            '<div>${entityName}</div>' +\n            '<div style=\"width: 100%;border-bottom:1px solid rgba(0, 0, 0, 0.12);margin:12px 0;\"></div>' +\n            '<div style=\"display:flex;flex-direction:row;align-items:baseline;margin-bottom:9px;\">' +\n                '<div style=\"font-size:13px;line-height:16px;font-weight:500;color:rgba(0, 0, 0, 0.38);width:100px\">Liquid type</div>' +\n                '<div style=\"font-size:14px;line-height:20px;font-weight:500;letter-spacing:0.25px\">'+ liquidType +'</div>' +\n            '</div>' +\n            '<div style=\"display:flex;flex-direction:row;align-items:baseline;margin-bottom:9px;\">' +\n                '<div style=\"font-size:13px;line-height:16px;font-weight:500;color:rgba(0, 0, 0, 0.38);width:100px\">Remaining</div>' +\n                '<div style=\"color:'+ lowFuelLevelColor +';font-size:14px;line-height:20px;font-weight:500;letter-spacing:0.25px\">'+ remaining +'</div>' +\n            '</div>' +\n            '<div style=\"display:flex;flex-direction:row;align-items:baseline;margin-bottom:9px;\">' +\n                '<div style=\"font-size:13px;line-height:16px;font-weight:500;color:rgba(0, 0, 0, 0.38);width:100px\">Temperature</div>' +\n                '<div style=\"color:'+ thresholdTemperatureColor +';font-size:14px;line-height:20px;font-weight:500;letter-spacing:0.25px\">'+ temperature +'Â°C</div>' +\n            '</div>' +\n            '<div style=\"display:flex;flex-direction:row;align-items:baseline;margin-bottom:9px;\">' +\n                '<div style=\"font-size:13px;line-height:16px;font-weight:500;color:rgba(0, 0, 0, 0.38);width:100px\">Battery level</div>' +\n                '<div style=\"color:'+ lowBatteryColor +';font-size:14px;line-height:20px;font-weight:500;letter-spacing:0.25px\">'+ batteryLevel +'%</div>' +\n            '</div>' +\n            '<div style=\"display:flex;flex-direction:row;align-items:baseline;margin-bottom:9px;\">' +\n                '<div style=\"font-size:13px;line-height:16px;font-weight:500;color:rgba(0, 0, 0, 0.38);width:100px\">Connection</div>' +\n                '<div style=\"font-size:14px;width:fit-content;padding:4px 8px;font-weight:500;line-height:20px;letter-spacing:0.25px;border-radius:8px;color:'+ color +';background-color:'+ bgColor +'\">' + status + '</div>' +\n            '</div>' +\n            '<div style=\"display:flex;flex-direction:row;align-items:baseline;margin-bottom:13px;\">' +\n                '<div style=\"font-size:13px;line-height:16px;font-weight:500;color:rgba(0, 0, 0, 0.38);width:100px\">Last update</div>' +\n                '<div style=\"font-size:14px;line-height:20px;font-weight:500;color:#29313C;letter-spacing:0.25px\">'+ lastUpdate +'</div>' +\n            '</div>' +\n       '</div>';\n    //   '<div style=\"text-align: center\">' +\n    //         '<link-act name=\"tank-details\">Details ></link-act>' +\n    //   '</div>';\n\nfunction isNumber(value) {\n    return (typeof value === 'number' && isFinite(value));\n}\n\nfunction processValue(value, dec) {\n    value = parseFloat(value);\n    if (isNumber(value)) {\n        if (isNumber(dec)) {\n            value = parseFloat(value.toFixed(dec));\n        }\n        return value;\n    } else {\n        return 'N/A';\n    }\n}",
            "tooltipOffsetX": 0,
            "tooltipOffsetY": -1,
            "color": "#fe7569",
            "useColorFunction": false,
            "useMarkerImageFunction": true,
            "markerImageSize": 34,
            "markerImageFunction": "let image = images[0];\nconst isActive = data.active && data.active !== 'false';\n\nconst fuelLevel = data.fuelLevel;\nconst batteryLevel = data.battery;\nconst tankCapacity = data.tankCapacity;\nconst temperature = data.temperature;\nconst lowFuelLevel = data.isLowFuel;\nconst lowBattery = data.isLowBattery;\nconst thresholdTemperature = data.isHighTemperature || data.isLowTemperature;\n\nif (!isActive) {\n    image = images[3];\n} else if (lowFuelLevel || thresholdTemperature) {\n    image = images[1];\n} else if (lowBattery) {\n    image = images[2];\n}\n\nreturn {\n    url: image,\n    size: 28\n};\n",
            "markerImages": [
              "data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjgiIGhlaWdodD0iMjgiIHZpZXdCb3g9IjAgMCAyOCAyOCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3QgeD0iMC41IiB5PSIwLjUiIHdpZHRoPSIyNyIgaGVpZ2h0PSIyNyIgcng9IjMuNSIgZmlsbD0id2hpdGUiLz4KPHBhdGggZD0iTTcgMjEuNDAwM1Y3LjE3MTg4SDIxTDIwLjgzOTEgMjEuNzIwMUMyMC41MTcyIDIyLjQ2NjEgMTkgMjQuMjc4IDE0LjA4MDUgMjQuMjc4QzkuNDM4OTIgMjQuMjc4IDcuNDI5MTIgMjIuNDY2MSA3IDIxLjQwMDNaIiBmaWxsPSIjMTk4MDM4IiBzdHJva2U9IndoaXRlIi8+CjxlbGxpcHNlIGN4PSIxNCIgY3k9IjYuODU0NjQiIHJ4PSI3IiByeT0iMi44NTQ2NCIgZmlsbD0iIzE5ODAzOCIgc3Ryb2tlPSJ3aGl0ZSIvPgo8cGF0aCBkPSJNNyAxNS41QzkuNjY2NjcgMTYuNSAxNi4yIDE3LjkgMjEgMTUuNSIgc3Ryb2tlPSJ3aGl0ZSIvPgo8cmVjdCB4PSIxNiIgeT0iNiIgd2lkdGg9IjIiIGhlaWdodD0iMSIgcng9IjAuNSIgZmlsbD0id2hpdGUiLz4KPHJlY3QgeD0iMC41IiB5PSIwLjUiIHdpZHRoPSIyNyIgaGVpZ2h0PSIyNyIgcng9IjMuNSIgc3Ryb2tlPSIjMTk4MDM4Ii8+Cjwvc3ZnPgo=",
              "data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjgiIGhlaWdodD0iMjgiIHZpZXdCb3g9IjAgMCAyOCAyOCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3QgeD0iMC41IiB5PSIwLjUiIHdpZHRoPSIyNyIgaGVpZ2h0PSIyNyIgcng9IjMuNSIgZmlsbD0id2hpdGUiLz4KPHBhdGggZD0iTTcgMjEuNDAwM1Y3LjE3MTg4SDIxTDIwLjgzOTEgMjEuNzIwMUMyMC41MTcyIDIyLjQ2NjEgMTkgMjQuMjc4IDE0LjA4MDUgMjQuMjc4QzkuNDM4OTIgMjQuMjc4IDcuNDI5MTIgMjIuNDY2MSA3IDIxLjQwMDNaIiBmaWxsPSIjRDEyNzMwIiBzdHJva2U9IndoaXRlIi8+CjxlbGxpcHNlIGN4PSIxNCIgY3k9IjYuODU0NjQiIHJ4PSI3IiByeT0iMi44NTQ2NCIgZmlsbD0iI0QxMjczMCIgc3Ryb2tlPSJ3aGl0ZSIvPgo8cGF0aCBkPSJNNyAxNS41QzkuNjY2NjcgMTYuNSAxNi4yIDE3LjkgMjEgMTUuNSIgc3Ryb2tlPSJ3aGl0ZSIvPgo8cmVjdCB4PSIxNiIgeT0iNiIgd2lkdGg9IjIiIGhlaWdodD0iMSIgcng9IjAuNSIgZmlsbD0id2hpdGUiLz4KPHJlY3QgeD0iMC41IiB5PSIwLjUiIHdpZHRoPSIyNyIgaGVpZ2h0PSIyNyIgcng9IjMuNSIgc3Ryb2tlPSIjRDEyNzMwIi8+Cjwvc3ZnPgo=",
              "data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjgiIGhlaWdodD0iMjgiIHZpZXdCb3g9IjAgMCAyOCAyOCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3QgeD0iMC41IiB5PSIwLjUiIHdpZHRoPSIyNyIgaGVpZ2h0PSIyNyIgcng9IjMuNSIgZmlsbD0id2hpdGUiLz4KPHBhdGggZD0iTTcgMjEuNDAwM1Y3LjE3MTg4SDIxTDIwLjgzOTEgMjEuNzIwMUMyMC41MTcyIDIyLjQ2NjEgMTkgMjQuMjc4IDE0LjA4MDUgMjQuMjc4QzkuNDM4OTIgMjQuMjc4IDcuNDI5MTIgMjIuNDY2MSA3IDIxLjQwMDNaIiBmaWxsPSIjRkFBNDA1IiBzdHJva2U9IndoaXRlIi8+CjxlbGxpcHNlIGN4PSIxNCIgY3k9IjYuODU0NjQiIHJ4PSI3IiByeT0iMi44NTQ2NCIgZmlsbD0iI0ZBQTQwNSIgc3Ryb2tlPSJ3aGl0ZSIvPgo8cGF0aCBkPSJNNyAxNS41QzkuNjY2NjcgMTYuNSAxNi4yIDE3LjkgMjEgMTUuNSIgc3Ryb2tlPSJ3aGl0ZSIvPgo8cmVjdCB4PSIxNiIgeT0iNiIgd2lkdGg9IjIiIGhlaWdodD0iMSIgcng9IjAuNSIgZmlsbD0id2hpdGUiLz4KPHJlY3QgeD0iMC41IiB5PSIwLjUiIHdpZHRoPSIyNyIgaGVpZ2h0PSIyNyIgcng9IjMuNSIgc3Ryb2tlPSIjRkFBNDA1Ii8+Cjwvc3ZnPgo=",
              "data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjgiIGhlaWdodD0iMjgiIHZpZXdCb3g9IjAgMCAyOCAyOCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjI4IiBoZWlnaHQ9IjI4IiByeD0iNCIgZmlsbD0id2hpdGUiLz4KPHBhdGggZD0iTTcgMjEuNDAwM1Y3LjE3MTg4SDIxTDIwLjgzOTEgMjEuNzIwMUMyMC41MTcyIDIyLjQ2NjEgMTkgMjQuMjc4IDE0LjA4MDUgMjQuMjc4QzkuNDM4OTIgMjQuMjc4IDcuNDI5MTIgMjIuNDY2MSA3IDIxLjQwMDNaIiBmaWxsPSIjQTdBN0E3IiBzdHJva2U9IndoaXRlIi8+CjxlbGxpcHNlIGN4PSIxNCIgY3k9IjYuODU0NjQiIHJ4PSI3IiByeT0iMi44NTQ2NCIgZmlsbD0iI0E3QTdBNyIgc3Ryb2tlPSJ3aGl0ZSIvPgo8cGF0aCBkPSJNNyAxNS41QzkuNjY2NjcgMTYuNSAxNi4yIDE3LjkgMjEgMTUuNSIgc3Ryb2tlPSJ3aGl0ZSIvPgo8cmVjdCB4PSIxNiIgeT0iNiIgd2lkdGg9IjIiIGhlaWdodD0iMSIgcng9IjAuNSIgZmlsbD0id2hpdGUiLz4KPHJlY3QgeD0iMC41IiB5PSIwLjUiIHdpZHRoPSIyNyIgaGVpZ2h0PSIyNyIgcng9IjMuNSIgc3Ryb2tlPSJibGFjayIgc3Ryb2tlLW9wYWNpdHk9IjAuMzgiLz4KPC9zdmc+Cg=="
            ],
            "showPolygon": false,
            "polygonKeyName": "perimeter",
            "editablePolygon": false,
            "showPolygonLabel": false,
            "usePolygonLabelFunction": false,
            "polygonLabel": "${entityName}",
            "showPolygonTooltip": false,
            "showPolygonTooltipAction": "click",
            "autoClosePolygonTooltip": true,
            "usePolygonTooltipFunction": false,
            "polygonTooltipPattern": "<b>${entityName}</b><br/><br/><b>TimeStamp:</b> ${ts:7}",
            "polygonColor": "#3388ff",
            "polygonOpacity": 0.2,
            "usePolygonColorFunction": false,
            "polygonStrokeColor": "#3388ff",
            "polygonStrokeOpacity": 1,
            "polygonStrokeWeight": 3,
            "usePolygonStrokeColorFunction": false,
            "showCircle": false,
            "circleKeyName": "perimeter",
            "editableCircle": false,
            "showCircleLabel": false,
            "useCircleLabelFunction": false,
            "circleLabel": "${entityName}",
            "showCircleTooltip": false,
            "showCircleTooltipAction": "click",
            "autoCloseCircleTooltip": true,
            "useCircleTooltipFunction": false,
            "circleTooltipPattern": "<b>${entityName}</b><br/><br/><b>TimeStamp:</b> ${ts:7}",
            "circleFillColor": "#3388ff",
            "circleFillColorOpacity": 0.2,
            "useCircleFillColorFunction": false,
            "circleStrokeColor": "#3388ff",
            "circleStrokeOpacity": 1,
            "circleStrokeWeight": 3,
            "useCircleStrokeColorFunction": false,
            "snappable": false,
            "initDragMode": false,
            "hideAllControlButton": false,
            "hideDrawControlButton": false,
            "hideEditControlButton": false,
            "hideRemoveControlButton": true,
            "useClusterMarkers": false,
            "zoomOnClick": true,
            "maxClusterRadius": 80,
            "animate": true,
            "spiderfyOnMaxZoom": false,
            "showCoverageOnHover": true,
            "chunkedLoading": false,
            "removeOutsideVisibleBounds": true,
            "useIconCreateFunction": false
          },
          "title": "",
          "dropShadow": false,
          "enableFullscreen": false,
          "titleStyle": {
            "fontSize": "16px",
            "fontWeight": 400
          },
          "useDashboardTimewindow": true,
          "showLegend": false,
          "widgetStyle": {},
          "actions": {
            "tooltipAction": [
              {
                "name": "tank-details",
                "icon": "more_horiz",
                "useShowWidgetActionFunction": null,
                "showWidgetActionFunction": "return true;",
                "type": "openDashboardState",
                "targetDashboardStateId": "tank-details",
                "setEntityId": true,
                "stateEntityParamName": null,
                "openRightLayout": false,
                "openInSeparateDialog": false,
                "openInPopover": false,
                "id": "e38e7a79-6238-7bbd-6bc2-5b90a3dfd660"
              }
            ]
          },
          "showTitleIcon": false,
          "titleTooltip": "",
          "enableDataExport": false,
          "widgetCss": ".leaflet-container a.leaflet-popup-close-button {\n    top: 15px;\n    right: 20px;\n}",
          "pageSize": 1024,
          "noDataDisplayMessage": ""
        },
        "row": 0,
        "col": 0,
        "id": "b52a62ff-7409-332f-6e41-3ed879a77892"
      },
      "02cc3bba-799b-1372-295f-8d2148a3c91a": {
        "isSystemType": true,
        "bundleAlias": "charts",
        "typeAlias": "state_chart",
        "type": "timeseries",
        "title": "New widget",
        "image": null,
        "description": null,
        "sizeX": 8,
        "sizeY": 5,
        "config": {
          "datasources": [
            {
              "type": "entity",
              "name": null,
              "entityAliasId": "6d74f33d-0025-fbc5-06b7-996534fa99c7",
              "filterId": null,
              "dataKeys": [
                {
                  "name": "fuelLevel",
                  "type": "timeseries",
                  "label": "fuelLevel",
                  "color": "#474BD2",
                  "settings": {
                    "hideDataByDefault": false,
                    "disableDataHiding": false,
                    "removeFromLegend": false,
                    "excludeFromStacking": false,
                    "showLines": true,
                    "lineWidth": 2,
                    "fillLines": false,
                    "showPoints": false,
                    "showSeparateAxis": false,
                    "axisMin": 0,
                    "axisMax": 100,
                    "axisPosition": "left",
                    "comparisonSettings": {
                      "showValuesForComparison": true,
                      "comparisonValuesLabel": "",
                      "color": ""
                    },
                    "thresholds": []
                  },
                  "_hash": 0.6162472801989103,
                  "aggregationType": null,
                  "units": "%",
                  "decimals": null,
                  "funcBody": null,
                  "usePostProcessing": true,
                  "postFuncBody": "return Math.round(value / 5) * 5;"
                }
              ],
              "alarmFilterConfig": {
                "statusList": [
                  "ACTIVE"
                ]
              },
              "latestDataKeys": [
                {
                  "name": "tankCapacity",
                  "type": "attribute",
                  "label": "tankCapacity",
                  "color": "#4caf50",
                  "settings": {},
                  "_hash": 0.5474089326639666
                }
              ]
            }
          ],
          "timewindow": {
            "realtime": {
              "timewindowMs": 60000
            }
          },
          "showTitle": true,
          "backgroundColor": "#fff",
          "color": "rgba(0, 0, 0, 0.87)",
          "padding": "8px",
          "settings": {
            "stack": false,
            "fontSize": 11,
            "fontColor": "#545454",
            "showTooltip": true,
            "tooltipIndividual": false,
            "tooltipCumulative": false,
            "hideZeros": false,
            "tooltipValueFormatter": "const stepValue = Math.round(value / 5) * 5;\nconst calculatedValue = (stepValue * latestData.tankCapacity) / 100;\nconst percent = stepValue + '%';\nconst valueText = `${parseFloat(stepValue).toFixed(0)}% (${parseFloat(calculatedValue).toFixed(0)}L)`;\nreturn valueText;",
            "grid": {
              "verticalLines": false,
              "horizontalLines": true,
              "outlineWidth": 0,
              "color": "#545454",
              "backgroundColor": null,
              "tickColor": "rgba(69,75,116,0.08)"
            },
            "xaxis": {
              "title": null,
              "showLabels": true,
              "color": "#9fa6b4"
            },
            "yaxis": {
              "min": null,
              "max": null,
              "title": null,
              "showLabels": true,
              "color": "#9fa6b4",
              "tickSize": 20,
              "tickDecimals": 0,
              "ticksFormatter": ""
            },
            "shadowSize": 0,
            "smoothLines": false,
            "comparisonEnabled": false,
            "timeForComparison": "previousInterval",
            "comparisonCustomIntervalValue": 7200000,
            "xaxisSecond": {
              "axisPosition": "top",
              "title": null,
              "showLabels": true
            },
            "customLegendEnabled": false,
            "dataKeysListForLabels": []
          },
          "title": "Remaining Chart",
          "dropShadow": false,
          "enableFullscreen": true,
          "titleStyle": {
            "fontSize": "16px",
            "fontWeight": 500,
            "padding": "5px 10px 5px 10px",
            "color": "#29313C",
            "letterSpacing": "0.25px"
          },
          "widgetStyle": {},
          "useDashboardTimewindow": true,
          "showLegend": false,
          "actions": {},
          "legendConfig": {
            "direction": "column",
            ",position": "bottom",
            "showMin": false,
            "showMax": false,
            "showAvg": false,
            "showTotal": false
          },
          "showTitleIcon": false,
          "titleTooltip": "",
          "enableDataExport": true,
          "widgetCss": "",
          "pageSize": 1024,
          "noDataDisplayMessage": ""
        },
        "row": 0,
        "col": 0,
        "id": "02cc3bba-799b-1372-295f-8d2148a3c91a"
      },
      "290ae79a-ff7a-9c39-6c78-21fbc85335cb": {
        "isSystemType": true,
        "bundleAlias": "cards",
        "typeAlias": "markdown_card",
        "type": "latest",
        "title": "New widget",
        "image": null,
        "description": null,
        "sizeX": 5,
        "sizeY": 3.5,
        "config": {
          "datasources": [
            {
              "type": "entity",
              "name": null,
              "entityAliasId": "6d74f33d-0025-fbc5-06b7-996534fa99c7",
              "filterId": null,
              "dataKeys": [
                {
                  "name": "fuelLevel",
                  "type": "timeseries",
                  "label": "fuelLevel",
                  "color": "#2196f3",
                  "settings": {},
                  "_hash": 0.9548581305669188
                },
                {
                  "name": "tankCapacity",
                  "type": "attribute",
                  "label": "tankCapacity",
                  "color": "#4caf50",
                  "settings": {},
                  "_hash": 0.7814336482257853
                },
                {
                  "name": "tankShape",
                  "type": "attribute",
                  "label": "tankShape",
                  "color": "#f44336",
                  "settings": {},
                  "_hash": 0.7943679053099961
                }
              ],
              "alarmFilterConfig": {
                "statusList": [
                  "ACTIVE"
                ]
              }
            }
          ],
          "timewindow": {
            "displayValue": "",
            "selectedTab": 0,
            "realtime": {
              "realtimeType": 1,
              "interval": 1000,
              "timewindowMs": 60000,
              "quickInterval": "CURRENT_DAY"
            },
            "history": {
              "historyType": 0,
              "interval": 1000,
              "timewindowMs": 60000,
              "fixedTimewindow": {
                "startTimeMs": 1683732581395,
                "endTimeMs": 1683818981395
              },
              "quickInterval": "CURRENT_DAY"
            },
            "aggregation": {
              "type": "AVG",
              "limit": 25000
            }
          },
          "showTitle": false,
          "backgroundColor": "#fff",
          "color": "rgba(0, 0, 0, 0.87)",
          "padding": "8px",
          "settings": {
            "useMarkdownTextFunction": true,
            "markdownTextFunction": "if (data[0].fuelLevel || data[0].fuelLevel) {\n    const tankCapacity = data[0].tankCapacity;\n    const tankShape = data[0].tankShape;\n    let fontWeight = '400';\n    let background = '234, 235, 255';\n    let progress = '183, 185, 248';\n    let textColor = '';\n    let width = '50%';\n    let height = '70%';\n    let gradientDirection = 'top';\n    let maxWidth = '112px';\n    \n    if (tankShape === 'Horizontal Cylinder') {\n        width = '65%';\n        height = '37%';\n        // gradientDirection = 'right';\n        maxWidth = '65%';\n    }\n    \n    const calculatedValue = (data[0].fuelLevel * tankCapacity) / 100;\n    const percent = data[0].fuelLevel + '%';\n    // const percent = data[0].fuelLevel;\n    const opositePercent = (100 - data[0].fuelLevel) + '%';\n    const valueText = `<b style=\"font-size: 20px\">${parseFloat(calculatedValue).toFixed(0)}</b>  <b>L</b><br>\n                        &nbsp;&nbsp;\n                        <label style=\"font-weight: 500; color: rgba(159, 166, 180, 1);\">/${tankCapacity ? tankCapacity.toFixed(0) : \"N/A\"}</label>`;\n                        \n    // `radial-gradient(circle, rgba(${progress}, 1) ${percent}%, rgba(${background}, 0.4) calc(${percent} + 10)%, rgba(${progress}, 1) calc(${percent} + 20)%)`;\n    // const gradientWave =  '<span style=\"width: 100%; height: 100%; background: linear-gradient(to top, rgba(' + progress + ', 1) ' + percent + ', rgba(' + background + ', 0.4) '+ percent + '); border-radius: 5.21053px; animation: wave 1s infinite;\"></span>'\n\nreturn  '<div class=\"tank-details\" fxLayout=\"column\" style=\"height: 100%; padding: 0; overflow: auto;\">' +     \n            '<div fxLayout=\"column\" style=\"color: #29313C; padding: 12px 16px; font-weight: 500; line-height: 24px; letter-spacing: 0.25px; font-size: 16px;\">' + \n                'Tank level' +\n                '<label style=\"font-weight: 400; font-size: 14px; line-height: 20px; color: rgba(159, 166, 180, 1);\">' + tankShape + '</label>' +\n            '</div>' +\n            '<div style=\"display: flex; justify-content: center; align-items: center; height: 100%;\">' +\n                    '<div style=\"display: flex; justify-content: center; align-items: center; min-height: 60px; height: ' + height + '; width: '+ width + '; max-width: '+ maxWidth + '; padding: 7px; border: solid 3px #B7B9F8; overflow: hidden; border-radius: 10px;\">' + \n                      '<div style=\"display: flex; justify-content: center; align-items: center; width: 100%; height: 100%; background: linear-gradient(to ' + gradientDirection + ', rgba(' + progress + ', 1) ' + percent + ', rgba(' + background + ', 0.4) '+ percent + '); border-radius: 5.21053px;\">' + \n                    //   '<div  class=\"wave\" style=\"display: flex; justify-content: center; align-items: center; width: 100%; height: 100%; background: radial-gradient(circle, rgba(' + progress + ', 1) '+ percent + '%), rgba(' + background + ', 0.4) calc(' + percent + '+ 10)%, rgba(' + progress + ', 1) calc(' + percent + ' + 20)%);\">' + \n                          '<span style=\"padding: 4px; font-weight: ' + fontWeight +';color: ' + textColor + '; font-size: 10px; line-height: 1.5em;\"> ' + valueText + '</span>' +\n                        \n                       '</div>' + \n                    '</div>' + \n            '</div>' + \n        '</div>';\n} else {\n    return 'No data';\n}",
            "applyDefaultMarkdownStyle": true,
            "markdownCss": "/*@keyframes wave {*/\n/*    0% { transform: translateY(0); }*/\n/*    50% { transform: translateY(-5px); }*/\n/*    100% { transform: translateY(0); }*/\n/*}*/"
          },
          "title": "New Markdown/HTML Card",
          "showTitleIcon": false,
          "iconColor": "rgba(0, 0, 0, 0.87)",
          "iconSize": "24px",
          "titleTooltip": "",
          "dropShadow": true,
          "enableFullscreen": false,
          "widgetStyle": {},
          "titleStyle": {
            "fontSize": "16px",
            "fontWeight": 400
          },
          "showLegend": false,
          "useDashboardTimewindow": true,
          "enableDataExport": false,
          "widgetCss": "",
          "pageSize": 1024,
          "noDataDisplayMessage": ""
        },
        "row": 0,
        "col": 0,
        "id": "290ae79a-ff7a-9c39-6c78-21fbc85335cb"
      }
    },
    "states": {
      "default": {
        "name": "Fuel Level Monitoring",
        "root": true,
        "layouts": {
          "main": {
            "widgets": {
              "a4855683-5408-a263-eaac-67a08f7e3776": {
                "sizeX": 28,
                "sizeY": 18,
                "row": 0,
                "col": 36
              },
              "bd47533e-1ef8-bea5-e982-728322a17536": {
                "sizeX": 28,
                "sizeY": 17,
                "row": 18,
                "col": 36
              },
              "09402650-e84b-171f-cd11-e608d8f89bfb": {
                "sizeX": 36,
                "sizeY": 35,
                "row": 0,
                "col": 0,
                "mobileHeight": 10
              }
            },
            "gridSettings": {
              "backgroundColor": "#f9f9f9",
              "columns": 64,
              "margin": 16,
              "backgroundSizeMode": "100%",
              "autoFillHeight": true,
              "backgroundImageUrl": null,
              "mobileAutoFillHeight": false,
              "mobileRowHeight": 55,
              "outerMargin": true
            }
          }
        }
      },
      "tanks-location": {
        "name": "tanks-location",
        "root": false,
        "layouts": {
          "main": {
            "widgets": {
              "ad8020a2-53fd-8334-c94e-2a7af3774780": {
                "sizeX": 24,
                "sizeY": 15,
                "row": 0,
                "col": 0
              }
            },
            "gridSettings": {
              "backgroundColor": "#ffffff",
              "columns": 24,
              "margin": 0,
              "backgroundSizeMode": "100%",
              "autoFillHeight": true,
              "backgroundImageUrl": null,
              "mobileAutoFillHeight": true,
              "mobileRowHeight": 70,
              "outerMargin": true
            }
          }
        }
      },
      "device-alarm-filter": {
        "name": "device-alarm-filter",
        "root": false,
        "layouts": {
          "main": {
            "widgets": {
              "50496c24-028d-33f9-2a34-60b9b5b467ce": {
                "sizeX": 73,
                "sizeY": 17,
                "row": 0,
                "col": 0
              },
              "374e55b3-38a3-0a7c-7a1f-701959ed0ca9": {
                "sizeX": 74,
                "sizeY": 17,
                "row": 0,
                "col": 74
              }
            },
            "gridSettings": {
              "backgroundColor": "#ffffff",
              "columns": 148,
              "margin": 6,
              "backgroundSizeMode": "100%",
              "autoFillHeight": true,
              "backgroundImageUrl": null,
              "mobileAutoFillHeight": false,
              "mobileRowHeight": 70,
              "outerMargin": true
            }
          }
        }
      },
      "tank-details": {
        "name": "Tank ${entityName}",
        "root": false,
        "layouts": {
          "main": {
            "widgets": {
              "b89177ac-8f67-3ae5-dfc8-945d995ced41": {
                "sizeX": 16,
                "sizeY": 17,
                "row": 0,
                "col": 16
              },
              "03d839be-999a-b952-07f5-d157d6da78aa": {
                "sizeX": 32,
                "sizeY": 20,
                "row": 17,
                "col": 32
              },
              "758b7a23-7296-5310-ee42-923302022cf9": {
                "sizeX": 32,
                "sizeY": 17,
                "row": 0,
                "col": 32
              },
              "02cc3bba-799b-1372-295f-8d2148a3c91a": {
                "sizeX": 32,
                "sizeY": 20,
                "row": 17,
                "col": 0
              },
              "290ae79a-ff7a-9c39-6c78-21fbc85335cb": {
                "sizeX": 16,
                "sizeY": 17,
                "row": 0,
                "col": 0
              }
            },
            "gridSettings": {
              "backgroundColor": "#f9f9f9",
              "columns": 64,
              "margin": 16,
              "backgroundSizeMode": "100%",
              "autoFillHeight": true,
              "backgroundImageUrl": null,
              "mobileAutoFillHeight": false,
              "mobileRowHeight": 70,
              "outerMargin": true
            }
          }
        }
      },
      "edit-tank-location": {
        "name": "Edit tank location",
        "root": false,
        "layouts": {
          "main": {
            "widgets": {
              "b52a62ff-7409-332f-6e41-3ed879a77892": {
                "sizeX": 24,
                "sizeY": 15,
                "row": 0,
                "col": 0
              }
            },
            "gridSettings": {
              "backgroundColor": "#ffffff",
              "columns": 24,
              "margin": 0,
              "backgroundSizeMode": "100%",
              "autoFillHeight": true,
              "backgroundImageUrl": null,
              "mobileAutoFillHeight": true,
              "mobileRowHeight": 70,
              "outerMargin": true
            }
          }
        }
      },
      "device-alarm-filter-buttons": {
        "name": "device-alarm-filter-buttons",
        "root": false,
        "layouts": {
          "main": {
            "widgets": {
              "79b3975f-b3ed-f839-8209-b17d2e7a2601": {
                "sizeX": 64,
                "sizeY": 2,
                "row": 0,
                "col": 0
              }
            },
            "gridSettings": {
              "backgroundColor": "#ffffff",
              "columns": 64,
              "margin": 0,
              "backgroundSizeMode": "100%",
              "autoFillHeight": true,
              "backgroundImageUrl": null,
              "mobileAutoFillHeight": false,
              "mobileRowHeight": 70,
              "outerMargin": true
            }
          }
        }
      }
    },
    "entityAliases": {
      "e1a32425-259b-f9d4-7380-b40d12a71238": {
        "id": "e1a32425-259b-f9d4-7380-b40d12a71238",
        "alias": "Tanks",
        "filter": {
          "type": "deviceType",
          "resolveMultiple": true,
          "deviceTypes": [
            "Tank"
          ],
          "deviceNameFilter": ""
        }
      },
      "cd74427b-6a97-ced1-262d-b0fe26af2ae8": {
        "id": "cd74427b-6a97-ced1-262d-b0fe26af2ae8",
        "alias": "Current user",
        "filter": {
          "type": "singleEntity",
          "resolveMultiple": false,
          "singleEntity": {
            "entityType": "CURRENT_USER",
            "id": "13814000-1dd2-11b2-8080-808080808080"
          }
        }
      },
      "6d74f33d-0025-fbc5-06b7-996534fa99c7": {
        "id": "6d74f33d-0025-fbc5-06b7-996534fa99c7",
        "alias": "Current tank",
        "filter": {
          "type": "stateEntity",
          "resolveMultiple": false,
          "stateEntityParamName": null,
          "defaultStateEntity": null
        }
      }
    },
    "filters": {
      "f7766c99-0996-844e-84bc-ac5923e173a2": {
        "id": "f7766c99-0996-844e-84bc-ac5923e173a2",
        "filter": "Tanks filter",
        "keyFilters": [
          {
            "key": {
              "type": "ATTRIBUTE",
              "key": "alarmFilter"
            },
            "valueType": "STRING",
            "predicates": [
              {
                "keyFilterPredicate": {
                  "operation": "OR",
                  "predicates": [
                    {
                      "keyFilterPredicate": {
                        "operation": "CONTAINS",
                        "value": {
                          "defaultValue": "lowRemaningLevel",
                          "dynamicValue": {
                            "sourceType": "CURRENT_USER",
                            "sourceAttribute": "lowRemaningLevel",
                            "inherit": false
                          }
                        },
                        "ignoreCase": false,
                        "type": "STRING"
                      },
                      "userInfo": {
                        "editable": true,
                        "label": "",
                        "autogeneratedLabel": true,
                        "order": 0
                      }
                    },
                    {
                      "keyFilterPredicate": {
                        "operation": "CONTAINS",
                        "value": {
                          "defaultValue": "lowBattery",
                          "dynamicValue": {
                            "sourceType": "CURRENT_USER",
                            "sourceAttribute": "lowBattery",
                            "inherit": false
                          }
                        },
                        "ignoreCase": false,
                        "type": "STRING"
                      },
                      "userInfo": {
                        "editable": true,
                        "label": "",
                        "autogeneratedLabel": true,
                        "order": 0
                      }
                    },
                    {
                      "keyFilterPredicate": {
                        "operation": "CONTAINS",
                        "value": {
                          "defaultValue": "lowTemperature",
                          "dynamicValue": {
                            "sourceType": "CURRENT_USER",
                            "sourceAttribute": "lowTemperature",
                            "inherit": false
                          }
                        },
                        "ignoreCase": false,
                        "type": "STRING"
                      },
                      "userInfo": {
                        "editable": true,
                        "label": "",
                        "autogeneratedLabel": true,
                        "order": 0
                      }
                    },
                    {
                      "keyFilterPredicate": {
                        "operation": "CONTAINS",
                        "value": {
                          "defaultValue": "highTemperature",
                          "dynamicValue": {
                            "sourceType": "CURRENT_USER",
                            "sourceAttribute": "highTemperature",
                            "inherit": false
                          }
                        },
                        "ignoreCase": false,
                        "type": "STRING"
                      },
                      "userInfo": {
                        "editable": true,
                        "label": "",
                        "autogeneratedLabel": true,
                        "order": 0
                      }
                    },
                    {
                      "keyFilterPredicate": {
                        "operation": "CONTAINS",
                        "value": {
                          "defaultValue": "noAlarms",
                          "dynamicValue": {
                            "sourceType": "CURRENT_USER",
                            "sourceAttribute": "noAlarms",
                            "inherit": false
                          }
                        },
                        "ignoreCase": false,
                        "type": "STRING"
                      },
                      "userInfo": {
                        "editable": true,
                        "label": "",
                        "autogeneratedLabel": true,
                        "order": 0
                      }
                    },
                    {
                      "keyFilterPredicate": {
                        "operation": "CONTAINS",
                        "value": {
                          "defaultValue": "offline",
                          "dynamicValue": {
                            "sourceType": "CURRENT_USER",
                            "sourceAttribute": "offline",
                            "inherit": false
                          }
                        },
                        "ignoreCase": false,
                        "type": "STRING"
                      },
                      "userInfo": {
                        "editable": true,
                        "label": "",
                        "autogeneratedLabel": true,
                        "order": 0
                      }
                    }
                  ],
                  "type": "COMPLEX"
                },
                "userInfo": {
                  "editable": true,
                  "label": "",
                  "autogeneratedLabel": true,
                  "order": 0
                }
              }
            ]
          }
        ],
        "editable": true
      }
    },
    "timewindow": {
      "hideInterval": false,
      "hideLastInterval": false,
      "hideQuickInterval": false,
      "hideAggregation": false,
      "hideAggInterval": false,
      "hideTimezone": false,
      "selectedTab": 0,
      "realtime": {
        "realtimeType": 0,
        "timewindowMs": 604800000,
        "quickInterval": "CURRENT_DAY",
        "interval": 1000
      },
      "aggregation": {
        "type": "NONE",
        "limit": 25000
      },
      "timezone": null
    },
    "settings": {
      "stateControllerId": "entity",
      "showTitle": false,
      "showDashboardsSelect": false,
      "showEntitiesSelect": false,
      "showDashboardTimewindow": true,
      "showDashboardExport": true,
      "toolbarAlwaysOpen": true,
      "titleColor": "rgba(0,0,0,0.870588)",
      "showDashboardLogo": false,
      "dashboardLogoUrl": null,
      "hideToolbar": false,
      "showFilters": false,
      "showUpdateDashboardImage": false,
      "dashboardCss": ".tb-widget-container > .tb-widget {\n    border-radius: 8px;\n    box-shadow: 0px 2px 8px rgba(222, 223, 224, 0.25);\n}\n\n.tb-dashboard-page .tb-widget-container > .tb-widget {\n    color: #4B535B !important;\n}\n\n.tb-dashboard-page .tb-widget-container > .tb-widget .tb-markdown-view {\n    overflow: hidden !important;\n}\n\n.tb-dashboard-page .tb-widget-container > .tb-widget .tb-table-widget .mat-mdc-table .mat-mdc-header-cell {\n    color: rgba(0, 0, 0, 0.38) !important;\n    font-weight: 500;\n    font-size: 12px;\n    line-height: 16px;\n    letter-spacing: 0.25px;\n}\n\n.tb-dashboard-page .tb-widget-container > .tb-widget .tb-table-widget .mat-mdc-table .mat-mdc-cell {\n    color: #4B535B;\n    border-bottom-color: transparent;\n    font-size: 14px;\n    line-height: 20px;\n}\n\n.tb-dashboard-page .tb-widget-container > .tb-widget .tb-table-widget .no-data-found {\n    font-weight: 500;\n    font-size: 14px;\n    letter-spacing: 0.25px;\n}\n\n.tb-dashboard-page .tb-widget-container > .tb-widget .tb-table-widget .mat-table .mat-row:hover:not(.tb-current-entity),\n.tb-dashboard-page .tb-widget-container > .tb-widget .tb-table-widget .mat-table .mat-row:hover:not(.tb-current-entity) .mat-cell.mat-table-sticky {\n    background-color: #F9F9FB !important;\n}\n\n.tb-dashboard-page .tb-widget-container > .tb-widget .tb-table-widget .mat-table .mat-header-cell .mat-sort-header-arrow {\n    color: rgba(0, 0, 0, 0.38) !important;\n}\n\n.tb-dashboard-page .tb-widget-container > .tb-widget .tb-table-widget .mat-input-element::placeholder,\n.tb-dashboard-page .tb-widget-container > .tb-widget .tb-table-widget .mat-input-element::-moz-placeholder,\n.tb-dashboard-page .tb-widget-container > .tb-widget .tb-table-widget .mat-input-element::-webkit-input-placeholder,\n.tb-dashboard-page .tb-widget-container > .tb-widget .tb-table-widget .mat-input-element:-ms-input-placeholder {\n    color: #9FA6B4 !important;\n}\n\n.tb-dashboard-page .tb-widget-container > .tb-widget .tb-table-widget .mat-table .mat-cell .mat-checkbox-frame,.tb-dashboard-page .tb-widget-container > .tb-widget .tb-table-widget .mat-table .mat-header-cell .mat-checkbox-frame {\n    border-color : #9FA6B4 !important;\n}\n\n.tb-dashboard-page .tb-widget-container > .tb-widget .tb-table-widget .mat-mdc-table .mat-mdc-cell button.mat-mdc-icon-button mat-icon,\n.tb-dashboard-page .tb-widget-container > .tb-widget .tb-widget-actions mat-icon {\n    color: #00000061 !important;\n}\n\n.tb-dashboard-page .tb-widget-container > .tb-widget .tb-table-widget .mat-paginator,\n.tb-dashboard-page .tb-widget-container > .tb-widget .tb-table-widget .mat-paginator button.mat-icon-button,\n.tb-dashboard-page .tb-widget-container > .tb-widget .tb-table-widget .mat-paginator .mat-select-value {\n    color: #9FA6B4 !important;\n}\n\n.tb-dashboard-page .tb-widget-container > .tb-widget .leaflet-control-zoom-in,\n.tb-dashboard-page .tb-widget-container > .tb-widget .leaflet-control-zoom-out {\n    color: #4B535B;\n}\n\n.tb-dashboard-page .tb-widget-container > .tb-widget .leaflet-control-zoom-in {\n    border-radius: 6px 6px 0 0;\n    border-bottom: 1px solid transparent; \n}\n.tb-dashboard-page .tb-widget-container > .tb-widget .leaflet-control-zoom-out {\n    border-radius: 0 0 6px 6px;\n}\n\n.tb-dashboard-page .tb-widget-container > .tb-widget .leaflet-control,\n.tb-dashboard-page .tb-widget-container > .tb-widget .leaflet-buttons-control-button{\n    border: none;\n}\n\n.tb-dashboard-page .tb-widget-container > .tb-widget .leaflet-popup a.tb-custom-action {\n    font-family: 'Roboto';\n    font-weight: 500;\n    font-size: 14px;\n    line-height: 20px;\n    letter-spacing: 0.25px;\n    border-bottom: none;\n    color: #9699FF;\n}\n\nmat-cell {\n    border: none !important;\n}\n\n@media (max-width: 1130px) {\n    .tb-widget-container .tb-widget .tank-layout .tb-multiple-input .mat-mdc-slide-toggle .mdc-switch {\n       width: 32px;\n    }\n    \n    .tb-widget .tank-layout .tb-multiple-input .mat-mdc-slide-toggle .mdc-switch .mdc-switch__track {\n        height: 20px;\n    }\n    \n    .tb-widget-container .tb-widget .tank-layout .tb-multiple-input .mat-mdc-slide-toggle .mdc-switch .mdc-switch__handle {\n        width: 16px;\n        height: 16px;\n    }\n    \n    .tb-widget-container .tb-widget .tank-layout .tb-multiple-input .mat-mdc-slide-toggle .mdc-switch .mdc-switch__handle-track {\n        width: calc(100% - 24px);\n        left: 6px;\n    }\n    \n    .tank-layout .mat-mdc-slide-toggle .label-wrapper {\n       font-size: 12px !important;\n       width: 100px;\n    }\n    \n    .tank-layout .tb-multiple-input-container {\n        padding: 0 3px !important;\n    }\n    \n    .tb-widget-container .tb-widget .tank-layout .tb-multiple-input .mat-mdc-slide-toggle {\n        margin: 8px 0;\n    }\n    \n    .tb-widget-container .tb-widget .tank-layout .mat-expansion-panel-body .tank-filter-toggles {\n       height: 133px;\n    }\n}\n\n@media (max-width: 959px) {\n    .tb-widget-container .tb-widget .tank-layout .tb-multiple-input .mat-mdc-slide-toggle .mdc-switch {\n       width: 42px;\n    }\n    \n    .tb-widget-container .tb-widget .tank-layout .tb-multiple-input .mat-mdc-slide-toggle .mdc-switch .mdc-switch__track {\n        height: 24px;\n    }\n    \n    .tb-widget-container .tb-widget .tank-layout .tb-multiple-input .mat-mdc-slide-toggle .mdc-switch .mdc-switch__handle {\n        width: 20px;\n        height: 20px;\n    }\n    \n    .tb-widget-container .tb-widget .tank-layout .tb-multiple-input .mat-mdc-slide-toggle .mdc-switch .mdc-switch__handle-track {\n        width: calc(100% - 24px);\n        left: 2px;\n    }\n    \n    .tank-layout .mat-mdc-slide-toggle .label-wrapper {\n       font-size: 14px !important;\n       width: 100%;\n    }\n    \n    .tank-layout .tb-multiple-input-container {\n        padding: 0 8px !important;\n    }\n    \n    .tb-widget-container .tb-widget .tank-layout .mat-expansion-panel-body .tank-filter-toggles {\n       height: 265px;\n    }\n}"
    }
  },
  "externalId": null,
  "name": "Fuel Level Monitoring"
}